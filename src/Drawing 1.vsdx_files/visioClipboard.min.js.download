var visioClipboard;!function(){var e={7182:function(e,t){"use strict";function r(e){for(var t="";t.length<e;){var r=16*Math.random();t+=(r|=0).toString(16)}return t}var o=function(){function e(){}return e.generate=function(){var e=[];e.push(r(8)),e.push(r(4));var t="4"+r(3);e.push(t);var o=r(4),a=parseInt(o[0],10);return a&=3,o=(a|=8).toString(16)+o.substr(1),e.push(o),e.push(r(12)),e.join("-")},e.normalizeLower=function(t,r){return t?e._normalizeBrackets(t.toLowerCase(),r):""},e.normalizeUpper=function(t,r){return t?e._normalizeBrackets(t.toUpperCase(),r):""},e._normalizeBrackets=function(e,t){var r=e.match(/^\{(.*)\}$/);return r?t?r[0]:r[1]:t?"{"+e+"}":e},e}();o.Empty="00000000-0000-0000-0000-000000000000",t.A=o},3498:function(e){e.exports=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,r){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,r)}function r(e,o,a){return r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,r,o){var a=[null];a.push.apply(a,r);var i=new(Function.bind.apply(e,a));return o&&t(i,o.prototype),i},r.apply(null,arguments)}function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}var i=Object.hasOwnProperty,n=Object.setPrototypeOf,s=Object.isFrozen,c=Object.getPrototypeOf,l=Object.getOwnPropertyDescriptor,d=Object.freeze,p=Object.seal,u=Object.create,m="undefined"!=typeof Reflect&&Reflect,f=m.apply,h=m.construct;f||(f=function(e,t,r){return e.apply(t,r)}),d||(d=function(e){return e}),p||(p=function(e){return e}),h||(h=function(e,t){return r(e,o(t))});var g,y=A(Array.prototype.forEach),S=A(Array.prototype.pop),b=A(Array.prototype.push),C=A(String.prototype.toLowerCase),E=A(String.prototype.toString),w=A(String.prototype.match),_=A(String.prototype.replace),v=A(String.prototype.indexOf),P=A(String.prototype.trim),T=A(RegExp.prototype.test),I=(g=TypeError,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return h(g,t)});function A(e){return function(t){for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];return f(e,t,o)}}function M(e,t,r){var o;r=null!==(o=r)&&void 0!==o?o:C,n&&n(e,null);for(var a=t.length;a--;){var i=t[a];if("string"==typeof i){var c=r(i);c!==i&&(s(t)||(t[a]=c),i=c)}e[i]=!0}return e}function x(e){var t,r=u(null);for(t in e)!0===f(i,e,[t])&&(r[t]=e[t]);return r}function k(e,t){for(;null!==e;){var r=l(e,t);if(r){if(r.get)return A(r.get);if("function"==typeof r.value)return A(r.value)}e=c(e)}return function(e){return console.warn("fallback value for",e),null}}var L=d(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),D=d(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),W=d(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),O=d(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),$=d(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),R=d(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),F=d(["#text"]),U=d(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),j=d(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),N=d(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),z=d(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),H=p(/\{\{[\w\W]*|[\w\W]*\}\}/gm),J=p(/<%[\w\W]*|[\w\W]*%>/gm),B=p(/\${[\w\W]*}/gm),V=p(/^data-[\-\w.\u00B7-\uFFFF]/),G=p(/^aria-[\-\w]+$/),K=p(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Z=p(/^(?:\w+script|data):/i),q=p(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),X=p(/^html$/i),Y=p(/^[a-z][.\w]*(-[.\w]+)+$/i);return function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,a=function(e){return t(e)};if(a.version="2.5.7",a.removed=[],!r||!r.document||9!==r.document.nodeType)return a.isSupported=!1,a;var i=r.document,n=r.document,s=r.DocumentFragment,c=r.HTMLTemplateElement,l=r.Node,p=r.Element,u=r.NodeFilter,m=r.NamedNodeMap,f=void 0===m?r.NamedNodeMap||r.MozNamedAttrMap:m,h=r.HTMLFormElement,g=r.DOMParser,A=r.trustedTypes,Q=p.prototype,ee=k(Q,"cloneNode"),te=k(Q,"nextSibling"),re=k(Q,"childNodes"),oe=k(Q,"parentNode");if("function"==typeof c){var ae=n.createElement("template");ae.content&&ae.content.ownerDocument&&(n=ae.content.ownerDocument)}var ie=function(t,r){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var o=null,a="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(a)&&(o=r.currentScript.getAttribute(a));var i="dompurify"+(o?"#"+o:"");try{return t.createPolicy(i,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}}(A,i),ne=ie?ie.createHTML(""):"",se=n,ce=se.implementation,le=se.createNodeIterator,de=se.createDocumentFragment,pe=se.getElementsByTagName,ue=i.importNode,me={};try{me=x(n).documentMode?n.documentMode:{}}catch(e){}var fe={};a.isSupported="function"==typeof oe&&ce&&void 0!==ce.createHTMLDocument&&9!==me;var he,ge,ye=H,Se=J,be=B,Ce=V,Ee=G,we=Z,_e=q,ve=Y,Pe=K,Te=null,Ie=M({},[].concat(o(L),o(D),o(W),o($),o(F))),Ae=null,Me=M({},[].concat(o(U),o(j),o(N),o(z))),xe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ke=null,Le=null,De=!0,We=!0,Oe=!1,$e=!0,Re=!1,Fe=!0,Ue=!1,je=!1,Ne=!1,ze=!1,He=!1,Je=!1,Be=!0,Ve=!1,Ge=!0,Ke=!1,Ze={},qe=null,Xe=M({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ye=null,Qe=M({},["audio","video","img","source","image","track"]),et=null,tt=M({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),rt="http://www.w3.org/1998/Math/MathML",ot="http://www.w3.org/2000/svg",at="http://www.w3.org/1999/xhtml",it=at,nt=!1,st=null,ct=M({},[rt,ot,at],E),lt=["application/xhtml+xml","text/html"],dt=null,pt=n.createElement("form"),ut=function(e){return e instanceof RegExp||e instanceof Function},mt=function(t){dt&&dt===t||(t&&"object"===e(t)||(t={}),t=x(t),he=he=-1===lt.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE,ge="application/xhtml+xml"===he?E:C,Te="ALLOWED_TAGS"in t?M({},t.ALLOWED_TAGS,ge):Ie,Ae="ALLOWED_ATTR"in t?M({},t.ALLOWED_ATTR,ge):Me,st="ALLOWED_NAMESPACES"in t?M({},t.ALLOWED_NAMESPACES,E):ct,et="ADD_URI_SAFE_ATTR"in t?M(x(tt),t.ADD_URI_SAFE_ATTR,ge):tt,Ye="ADD_DATA_URI_TAGS"in t?M(x(Qe),t.ADD_DATA_URI_TAGS,ge):Qe,qe="FORBID_CONTENTS"in t?M({},t.FORBID_CONTENTS,ge):Xe,ke="FORBID_TAGS"in t?M({},t.FORBID_TAGS,ge):{},Le="FORBID_ATTR"in t?M({},t.FORBID_ATTR,ge):{},Ze="USE_PROFILES"in t&&t.USE_PROFILES,De=!1!==t.ALLOW_ARIA_ATTR,We=!1!==t.ALLOW_DATA_ATTR,Oe=t.ALLOW_UNKNOWN_PROTOCOLS||!1,$e=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Re=t.SAFE_FOR_TEMPLATES||!1,Fe=!1!==t.SAFE_FOR_XML,Ue=t.WHOLE_DOCUMENT||!1,ze=t.RETURN_DOM||!1,He=t.RETURN_DOM_FRAGMENT||!1,Je=t.RETURN_TRUSTED_TYPE||!1,Ne=t.FORCE_BODY||!1,Be=!1!==t.SANITIZE_DOM,Ve=t.SANITIZE_NAMED_PROPS||!1,Ge=!1!==t.KEEP_CONTENT,Ke=t.IN_PLACE||!1,Pe=t.ALLOWED_URI_REGEXP||Pe,it=t.NAMESPACE||at,xe=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&ut(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(xe.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&ut(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(xe.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(xe.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Re&&(We=!1),He&&(ze=!0),Ze&&(Te=M({},o(F)),Ae=[],!0===Ze.html&&(M(Te,L),M(Ae,U)),!0===Ze.svg&&(M(Te,D),M(Ae,j),M(Ae,z)),!0===Ze.svgFilters&&(M(Te,W),M(Ae,j),M(Ae,z)),!0===Ze.mathMl&&(M(Te,$),M(Ae,N),M(Ae,z))),t.ADD_TAGS&&(Te===Ie&&(Te=x(Te)),M(Te,t.ADD_TAGS,ge)),t.ADD_ATTR&&(Ae===Me&&(Ae=x(Ae)),M(Ae,t.ADD_ATTR,ge)),t.ADD_URI_SAFE_ATTR&&M(et,t.ADD_URI_SAFE_ATTR,ge),t.FORBID_CONTENTS&&(qe===Xe&&(qe=x(qe)),M(qe,t.FORBID_CONTENTS,ge)),Ge&&(Te["#text"]=!0),Ue&&M(Te,["html","head","body"]),Te.table&&(M(Te,["tbody"]),delete ke.tbody),d&&d(t),dt=t)},ft=M({},["mi","mo","mn","ms","mtext"]),ht=M({},["annotation-xml"]),gt=M({},["title","style","font","a","script"]),yt=M({},D);M(yt,W),M(yt,O);var St=M({},$);M(St,R);var bt=function(e){b(a.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ne}catch(t){e.remove()}}},Ct=function(e,t){try{b(a.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){b(a.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Ae[e])if(ze||He)try{bt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Et=function(e){var t,r;if(Ne)e="<remove></remove>"+e;else{var o=w(e,/^[\r\n\t ]+/);r=o&&o[0]}"application/xhtml+xml"===he&&it===at&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var a=ie?ie.createHTML(e):e;if(it===at)try{t=(new g).parseFromString(a,he)}catch(e){}if(!t||!t.documentElement){t=ce.createDocument(it,"template",null);try{t.documentElement.innerHTML=nt?ne:a}catch(e){}}var i=t.body||t.documentElement;return e&&r&&i.insertBefore(n.createTextNode(r),i.childNodes[0]||null),it===at?pe.call(t,Ue?"html":"body")[0]:Ue?t.documentElement:i},wt=function(e){return le.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null,!1)},_t=function(e){return e instanceof h&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof f)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},vt=function(t){return"object"===e(l)?t instanceof l:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},Pt=function(e,t,r){fe[e]&&y(fe[e],(function(e){e.call(a,t,r,dt)}))},Tt=function(e){var t;if(Pt("beforeSanitizeElements",e,null),_t(e))return bt(e),!0;if(T(/[\u0080-\uFFFF]/,e.nodeName))return bt(e),!0;var r=ge(e.nodeName);if(Pt("uponSanitizeElement",e,{tagName:r,allowedTags:Te}),e.hasChildNodes()&&!vt(e.firstElementChild)&&(!vt(e.content)||!vt(e.content.firstElementChild))&&T(/<[/\w]/g,e.innerHTML)&&T(/<[/\w]/g,e.textContent))return bt(e),!0;if("select"===r&&T(/<template/i,e.innerHTML))return bt(e),!0;if(7===e.nodeType)return bt(e),!0;if(Fe&&8===e.nodeType&&T(/<[/\w]/g,e.data))return bt(e),!0;if(!Te[r]||ke[r]){if(!ke[r]&&At(r)){if(xe.tagNameCheck instanceof RegExp&&T(xe.tagNameCheck,r))return!1;if(xe.tagNameCheck instanceof Function&&xe.tagNameCheck(r))return!1}if(Ge&&!qe[r]){var o=oe(e)||e.parentNode,i=re(e)||e.childNodes;if(i&&o)for(var n=i.length-1;n>=0;--n){var s=ee(i[n],!0);s.__removalCount=(e.__removalCount||0)+1,o.insertBefore(s,te(e))}}return bt(e),!0}return e instanceof p&&!function(e){var t=oe(e);t&&t.tagName||(t={namespaceURI:it,tagName:"template"});var r=C(e.tagName),o=C(t.tagName);return!!st[e.namespaceURI]&&(e.namespaceURI===ot?t.namespaceURI===at?"svg"===r:t.namespaceURI===rt?"svg"===r&&("annotation-xml"===o||ft[o]):Boolean(yt[r]):e.namespaceURI===rt?t.namespaceURI===at?"math"===r:t.namespaceURI===ot?"math"===r&&ht[o]:Boolean(St[r]):e.namespaceURI===at?!(t.namespaceURI===ot&&!ht[o])&&!(t.namespaceURI===rt&&!ft[o])&&!St[r]&&(gt[r]||!yt[r]):!("application/xhtml+xml"!==he||!st[e.namespaceURI]))}(e)?(bt(e),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!T(/<\/no(script|embed|frames)/i,e.innerHTML)?(Re&&3===e.nodeType&&(t=e.textContent,t=_(t,ye," "),t=_(t,Se," "),t=_(t,be," "),e.textContent!==t&&(b(a.removed,{element:e.cloneNode()}),e.textContent=t)),Pt("afterSanitizeElements",e,null),!1):(bt(e),!0)},It=function(e,t,r){if(Be&&("id"===t||"name"===t)&&(r in n||r in pt))return!1;if(We&&!Le[t]&&T(Ce,t));else if(De&&T(Ee,t));else if(!Ae[t]||Le[t]){if(!(At(e)&&(xe.tagNameCheck instanceof RegExp&&T(xe.tagNameCheck,e)||xe.tagNameCheck instanceof Function&&xe.tagNameCheck(e))&&(xe.attributeNameCheck instanceof RegExp&&T(xe.attributeNameCheck,t)||xe.attributeNameCheck instanceof Function&&xe.attributeNameCheck(t))||"is"===t&&xe.allowCustomizedBuiltInElements&&(xe.tagNameCheck instanceof RegExp&&T(xe.tagNameCheck,r)||xe.tagNameCheck instanceof Function&&xe.tagNameCheck(r))))return!1}else if(et[t]);else if(T(Pe,_(r,_e,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==v(r,"data:")||!Ye[e])if(Oe&&!T(we,_(r,_e,"")));else if(r)return!1;return!0},At=function(e){return"annotation-xml"!==e&&w(e,ve)},Mt=function(t){var r,o,i,n;Pt("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var c={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ae};for(n=s.length;n--;){var l=r=s[n],d=l.name,p=l.namespaceURI;if(o="value"===d?r.value:P(r.value),i=ge(d),c.attrName=i,c.attrValue=o,c.keepAttr=!0,c.forceKeepAttr=void 0,Pt("uponSanitizeAttribute",t,c),o=c.attrValue,!c.forceKeepAttr&&(Ct(d,t),c.keepAttr))if($e||!T(/\/>/i,o)){Re&&(o=_(o,ye," "),o=_(o,Se," "),o=_(o,be," "));var u=ge(t.nodeName);if(It(u,i,o))if(!Ve||"id"!==i&&"name"!==i||(Ct(d,t),o="user-content-"+o),Fe&&T(/((--!?|])>)|<\/(style|title)/i,o))Ct(d,t);else{if(ie&&"object"===e(A)&&"function"==typeof A.getAttributeType)if(p);else switch(A.getAttributeType(u,i)){case"TrustedHTML":o=ie.createHTML(o);break;case"TrustedScriptURL":o=ie.createScriptURL(o)}try{p?t.setAttributeNS(p,d,o):t.setAttribute(d,o),_t(t)?bt(t):S(a.removed)}catch(e){}}}else Ct(d,t)}Pt("afterSanitizeAttributes",t,null)}},xt=function e(t){var r,o=wt(t);for(Pt("beforeSanitizeShadowDOM",t,null);r=o.nextNode();)Pt("uponSanitizeShadowNode",r,null),Tt(r)||(r.content instanceof s&&e(r.content),Mt(r));Pt("afterSanitizeShadowDOM",t,null)};return a.sanitize=function(t){var o,n,c,d,p,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((nt=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!vt(t)){if("function"!=typeof t.toString)throw I("toString is not a function");if("string"!=typeof(t=t.toString()))throw I("dirty is not a string, aborting")}if(!a.isSupported){if("object"===e(r.toStaticHTML)||"function"==typeof r.toStaticHTML){if("string"==typeof t)return r.toStaticHTML(t);if(vt(t))return r.toStaticHTML(t.outerHTML)}return t}if(je||mt(u),a.removed=[],"string"==typeof t&&(Ke=!1),Ke){if(t.nodeName){var m=ge(t.nodeName);if(!Te[m]||ke[m])throw I("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof l)1===(n=(o=Et("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===n.nodeName||"HTML"===n.nodeName?o=n:o.appendChild(n);else{if(!ze&&!Re&&!Ue&&-1===t.indexOf("<"))return ie&&Je?ie.createHTML(t):t;if(!(o=Et(t)))return ze?null:Je?ne:""}o&&Ne&&bt(o.firstChild);for(var f=wt(Ke?t:o);c=f.nextNode();)3===c.nodeType&&c===d||Tt(c)||(c.content instanceof s&&xt(c.content),Mt(c),d=c);if(d=null,Ke)return t;if(ze){if(He)for(p=de.call(o.ownerDocument);o.firstChild;)p.appendChild(o.firstChild);else p=o;return(Ae.shadowroot||Ae.shadowrootmod)&&(p=ue.call(i,p,!0)),p}var h=Ue?o.outerHTML:o.innerHTML;return Ue&&Te["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&T(X,o.ownerDocument.doctype.name)&&(h="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+h),Re&&(h=_(h,ye," "),h=_(h,Se," "),h=_(h,be," ")),ie&&Je?ie.createHTML(h):h},a.setConfig=function(e){mt(e),je=!0},a.clearConfig=function(){dt=null,je=!1},a.isValidAttribute=function(e,t,r){dt||mt({});var o=ge(e),a=ge(t);return It(o,a,r)},a.addHook=function(e,t){"function"==typeof t&&(fe[e]=fe[e]||[],b(fe[e],t))},a.removeHook=function(e){if(fe[e])return S(fe[e])},a.removeHooks=function(e){fe[e]&&(fe[e]=[])},a.removeAllHooks=function(){fe={}},a}()}()},782:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=function(){return void 0===r[o]&&(r[o]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),r[o]};const r={},o="promises"},9864:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){const e=new Uint8Array(31),t=function(e){const t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof crypto?crypto:"undefined"!=typeof msCrypto?msCrypto:void 0;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push(`crypto: ${JSON.stringify(e)}`)}}let o=!1;const a="undefined"!=typeof performance?performance:void 0;try{a&&a.now&&a.now()!==1/0&&(o=!0)}catch(e){t.exceptions.push(`perfNow: ${JSON.stringify(e)}`)}for(let r=0;r<e.length;r+=1){try{if(o){t.perfNow=!0;let e=Math.floor(100*a.now())%10;(e<0||e>9)&&(e=0);for(let t=0;t<e;t+=1)Math.random()}}catch(e){t.exceptions.push(`Math.random: ${JSON.stringify(e)}`)}e[r]=Math.floor(16*Math.random())}return t}(e);let r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const o=15&e[r];return r+=1,("x"===t?o:3&o|8).toString(16)})),t]}},8180:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=e=>{if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=e=>!!e.replaceChildren},6521:function(e,t,r){"use strict";t.TZ=t.nh=t.kp=t.Hv=t.Wp=t.kA=void 0;const o=r(2788);t.Wp=o;const a=r(7625);Object.defineProperty(t,"Hv",{enumerable:!0,get:function(){return a.ULS}}),Object.defineProperty(t,"kp",{enumerable:!0,get:function(){return a.TraceLevel}}),Object.defineProperty(t,"nh",{enumerable:!0,get:function(){return a.LogCategory}}),r(782);const i=r(3143);t.TZ=i;r(7434),r(6123);var n=r(9864);Object.defineProperty(t,"kA",{enumerable:!0,get:function(){return n.getNewGuid}});r(8619),r(8180)},7625:function(e,t){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(t.TraceLevel=r={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(o||(t.LogCategory=o={})),t.ULS={getFromExternalLogger:function(e){const t=e;return{ULS:{trace:(e,r,o)=>t.traceTag(0,e,r,o),traceTag:(e,r,o,a)=>t.traceTag(e,r,o,a),debugTrace:(e,r,o)=>t.debugTraceTag(0,e,r,o),debugTraceTag:(e,r,o,a)=>t.debugTraceTag(e,r,o,a),assert:(e,r,o)=>t.assertTag(0,e,r,o),assertTag:(e,r,o,a)=>t.assertTag(e,r,o,a),shipAssert:(e,r,o)=>t.shipAssertTag(0,e,r,o),shipAssertTag:(e,r,o,a)=>t.shipAssertTag(e,r,o,a),dnmTrace:(e,r,o)=>t.dnmTraceTag(0,e,r,o),dnmTraceTag:(e,r,o,a)=>t.dnmTraceTag(e,r,o,a)}}}},t.ConsoleLogger=class{shipAssertTag(e,t,r,o){console.assert(r,"shipAssertTag:",e,t,o)}assertTag(e,t,r,o){console.assert(r,"assertTag",e,t,o)}traceTag(e,t,r,o){console.log("traceTag",e,o,t,r)}dnmTraceTag(e,t,r,o){console.log("dnmTraceTag",e,o,t,r)}debugTraceTag(e,t,r,o){console.log("debugTraceTag",e,o,t,r)}},t.NulLogger=class{shipAssertTag(){}assertTag(){}traceTag(){}debugTraceTag(){}dnmTraceTag(){}}},3143:function(e,t){"use strict";function r(){const e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function o(e,t,o){e[t]=r()-o}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){const t=r(),a=e,i=t,n={},s=(e,t,r)=>function(e,t,r,a,i,n){o(e,"end",r);const s={sessionName:t,result:a?"success":"failure",message:n,marks:e};i(JSON.stringify(s))}(n,a,i,e,t,r);return n.start=0,{mark:e=>(e=>o(n,e,i))(e),end:e=>s(!0,e),success:(e,t)=>s(!0,e,t),failure:(e,t)=>s(!1,e,t)}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=r},8619:function(e,t){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(r||(t.TextAreaVirtualKeyboardPolicy=r={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(o||(t.TextAreaInputMode=o={}))},7434:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=function(e,t=1){return"undefined"!=typeof self&&self.performance&&self.performance.now&&(r=()=>self.performance.now()),function(o){let a=r(),i=o;return{reset(e){null!=e&&(i=e),a=r()},stop(o){const n=r()-a,s=JSON.stringify({Target:i,Duration:n.toFixed(t),StopInfo:o});e(s)}}}};let r=()=>Date.now()},6123:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0,t.TelemetryCollector=class{getJsonForLogging(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"}addEvent(e,t){null!=e&&null!=t&&(this.events[e]=t)}clearEvents(){this.events={}}getEventsLoggableString(){return JSON.stringify(this.events)}incrementCounter(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)}getCountersLoggableString(){return JSON.stringify(this.counters)}clearCounters(){this.counters={}}startTimer(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})}endTimer(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)}getTimerDuration(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"}getTimersLoggableString(){return JSON.stringify(this.timers)}constructor(){this.counters={},this.timers={},this.events={}}}},2788:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultToJSONResultWhenStringifyFails=void 0,t.forEachPromise=function(e,t,r){return e.reduce(((e,o)=>e.then((()=>r&&r.stop?Promise.resolve(void 0):t(o,r)))),Promise.resolve(void 0))},t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(o(e))}catch{return t.defaultToJSONResultWhenStringifyFails}},t.getPerfWatchMarkName=function(e){if(!e)return"";let t=e.trim().substring(0,200).trim().replace(i,a).substring(0,80);return t&&t.length>0&&t.substr(t.length-1,1)===a&&(t=t.substr(0,t.length-1)),t&&t.length>0&&t.substr(0,1)===a&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error(`utils.retry: attempts expected to be greater than 0 but got ${t}`));let r=Promise.reject();for(let o=1;o<=t;o+=1)r=r.catch((t=>e(o,t)));return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();let r=t(e[0]);for(let o=1;o<e.length;o+=1){const a=e[o];r=r.catch((()=>t(a)))}return r},t.getQueryParameterByName=function(e,t){const r=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;let t=5381,r=t;const o=e.length;for(let a=0;a<o&&(t=4294967295&((t<<5)+t^e.charCodeAt(a)),a!==o-1);a+=2)r=4294967295&((r<<5)+r^e.charCodeAt(a+1));let a=t+35685*r+(23896*r<<16)&4294967295;return a<0&&(a+=4294967296),a},t.defaultToJSONResultWhenStringifyFails="...";const r=5;function o(e,t=0){if(t<0||t>r)return e;if(null==e||"object"!=typeof e)return e;const a={};Object.getOwnPropertyNames(e).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(a[t]=e[t])}));const i=Object.getPrototypeOf(e);i&&"object"==typeof i&&Object.keys(i).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(a[t]=e[t])}));const n={};return Object.keys(a).forEach((e=>{n[e]=o(a[e],t+1)})),n}const a="_",i=new RegExp("\\W+","g")},8630:function(e,t){"use strict";function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},5949:function(e,t){"use strict";function r(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const o=r(e),a=r(t);let i=[];for(let e=0;e<=a.length;++e)i[e]=e;for(let e=1;e<=o.length;++e){const t=[e];for(let r=1;r<=a.length;++r)t[r]=o[e-1]===a[r-1]?i[r-1]:1+Math.min(i[r],i[r-1],t[r-1]);i=t}return i[a.length]}},8086:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=i,t.getStringFeatureGate=n,t.getBooleanFeatureGate=function(e,t){const r=n(e)?.trim().toLowerCase();return"true"===r||"false"!==r&&t},t.getNumberFeatureGate=function(e,t){const r=n(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const o=parseFloat(r);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){const r=n(e)?.trim();if(void 0===r)return t;const o=parseInt(r,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const o=r(5949),a={};function i(){return void 0===globalThis.__get_feature_gate_dictionary_variable?a:globalThis.__get_feature_gate_dictionary_variable()}function n(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return i()[e]??t;const r=i();if(Object.hasOwn(r,e))return r[e]??t;const a=globalThis.__office_online_feature_gates_verbose_log_callback;a(`Failed lookup for FeatureGate ${e}...`);const n=[],s=e.toLowerCase();for(const e of Object.keys(r))(0,o.editDistance)(e.toLowerCase(),s)<=4&&n.push(e);return n.length>0&&a(`Potential candidates found (edit distance <= 4, case-insensitive): [${n.join(", ")}]`),a(`FeatureGate override not found, returning default: ${t}`),t}},4342:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=r(6533);o.__exportStar(r(8086),t),o.__exportStar(r(1945),t),o.__exportStar(r(8630),t),o.__exportStar(r(8890),t),o.__exportStar(r(5550),t),o.__exportStar(r(1294),t)},1945:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,o.getBooleanFeatureGate)(t,r);case"number":return(0,o.getNumberFeatureGate)(t,r);case"string":return(0,o.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}};const o=r(8086)},8890:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,o.isChangeGateEnabled)(e)};const o=r(8630)},5550:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=a,t.overrideTypedChangeGates=function(e,t){return a(t)};const o=r(8630);function a(e){const t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},1294:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=a,t.overrideTypedFeatureGates=function(e,t){return a(t)};const o=r(8086);function a(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,o.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,o.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}},2438:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuidStringPolicyHTML=t.domPurifyIsValidAttribute=t.createGraphicsEditorTrustedTypesDefaultPolicy=t.createTrustedTypesDefaultPolicy=t.bypassPolicy=t.setRuntimeAllowedOrigins=t.urlOriginPolicy=t.emptyStringPolicyURL=t.emptyStringPolicyHTML=t.domPurifyPolicyHtml=void 0;var o=r(20);Object.defineProperty(t,"domPurifyPolicyHtml",{enumerable:!0,get:function(){return o.domPurifyPolicyHtml}});var a=r(1906);Object.defineProperty(t,"emptyStringPolicyHTML",{enumerable:!0,get:function(){return a.emptyStringPolicyHTML}}),Object.defineProperty(t,"emptyStringPolicyURL",{enumerable:!0,get:function(){return a.emptyStringPolicyURL}});var i=r(3800);Object.defineProperty(t,"urlOriginPolicy",{enumerable:!0,get:function(){return i.urlOriginPolicy}}),Object.defineProperty(t,"setRuntimeAllowedOrigins",{enumerable:!0,get:function(){return i.setRuntimeAllowedOrigins}});var n=r(4898);Object.defineProperty(t,"bypassPolicy",{enumerable:!0,get:function(){return n.bypassPolicy}});var s=r(3132);Object.defineProperty(t,"createTrustedTypesDefaultPolicy",{enumerable:!0,get:function(){return s.createTrustedTypesDefaultPolicy}}),Object.defineProperty(t,"createGraphicsEditorTrustedTypesDefaultPolicy",{enumerable:!0,get:function(){return s.createGraphicsEditorTrustedTypesDefaultPolicy}});var c=r(1745);Object.defineProperty(t,"domPurifyIsValidAttribute",{enumerable:!0,get:function(){return c.domPurifyIsValidAttribute}});var l=r(338);Object.defineProperty(t,"uuidStringPolicyHTML",{enumerable:!0,get:function(){return l.uuidStringPolicyHTML}})},1262:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPolicy=void 0;const r={},o="undefined"!=typeof self&&self.trustedTypes?self.trustedTypes:{createPolicy:(e,t)=>t};t.createPolicy=(e,t,a=o,i)=>{try{r[e]||(r[e]=a.createPolicy(e,{createHTML:t.createHTML,createScript:t.createScript,createScriptURL:t.createScriptURL}))}catch(e){i?.(`${e}`)}return r[e]}},4898:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bypassPolicy=t.createBypassPolicy=void 0;const o=r(1262);t.createBypassPolicy=(e,t)=>(0,o.createPolicy)(e,{createHTML:e=>e,createScript:e=>e},t),t.bypassPolicy=(0,t.createBypassPolicy)("bypassPolicy")},3132:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGraphicsEditorTrustedTypesDefaultPolicy=t.createTrustedTypesDefaultPolicy=t.createDefaultPolicyInternal=void 0;const o=r(4342),a=r(1262),i=r(1745),n=r(3800);t.createDefaultPolicyInternal=(e,t)=>{(0,a.createPolicy)("default",{createHTML:(e,r,o)=>{try{if("Element innerHTML"===o&&ee(W,g))return te.has(e)?e:(0,i.sanitizedHTMLAndValidate)(e);if("DOMParser parseFromString"===o&&ee(R,y)||"Element setAttribute"===o&&ee(K,w))return e}catch(e){t?.(`${e}`)}},createScript:(e,r,a)=>{try{if("eval"===a&&ee(U,b))return e;if("HTMLScriptElement text"===a&&ee(q,E)&&(e.startsWith("<math display")||e.startsWith("<math xmlns")))return e;if((0,o.isChangeGateEnabled)("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO:10684524_EnableFuncSinkDefaultTTPolicy")&&"Function"===a&&ee(void 0,_))return e}catch(e){t?.(`${e}`)}},createScriptURL:(e,r,o)=>{try{if("Worker constructor"===o&&ee(X,S)||"HTMLScriptElement src"===o&&ee(G,C)){const{origin:t}=new URL(e,document.baseURI);if((0,n.isAnAllowedOrigin)(t))return e}}catch(e){t?.(`${e}`)}}},e,t)},t.createTrustedTypesDefaultPolicy=e=>(0,t.createDefaultPolicyInternal)(void 0,e),t.createGraphicsEditorTrustedTypesDefaultPolicy=e=>{try{e.window.trustedTypes?.createPolicy("default",{createHTML:(e,t,r)=>{try{if("Element innerHTML"===r&&ee(A,g))return(0,i.sanitizedHTMLAndValidate)(e)}catch{}}})}catch{}};const s=/https?:\/\/[^\s/$.?#].[^\s]*/g,c=/\/officeonline\/versioned\/mathjax\-lowercase\-patched\/\d{1,10}\.\d{1,10}\.\d{1,10}\/mathjax\/\d{1,10}\.\d{1,10}\.\d{1,10}\/(config\/|jax\/output\/html\-css\/)?/,l=/\/(officeonline\/)?o\/s\/h?([0-9a-fA-F])+_app_scripts\/(wp5\/)?/,d=/\/(officeonline\/)?x\/s\/h?([0-9a-fA-F])+__layouts\/app_scripts\/((wp5|ac|cc|es6|rslc\d+|)\/)?/,p=/\/1js\/(build|pr)\/[0-9a-fA-F]+/,u=/\/wd1js\/(ship|debug)\/(we|wv|x)\/(_layouts\/)?app_scripts\/((wp5|ac|cc|es6|rslc\d+)\/)?/,m=/\/wo\/webpack\/((wp5|ac|cc|es6|rslc\d+)\/)?/,f=/\/officeonline\/pods\/s\/(h[0-9a-fA-F]+|\d+)_(app_scripts|pptscripts)\/?/,h=new RegExp(`(${/\/officeonline\/hashed\/[0-9a-fA-F]+\//.source}|${l.source}|${d.source}|${p.source}(${u.source}|${m.source}|/lib-es5/)|${f.source})`),g=/(wordviewerds|meboot|mathjax|jax|mml_htmlormml|common|common50|commonux([0-9a-fA-F\-]){0,10}|jquery(\.signalr\.merge\.\d+\.\d+\.min)?|compatparentelementfix|sharedcommentslazy|richtexteditor|copilotcommonux|copilotcomprehensionux|gc2host|appchrome|pptedit(ds)?(\.debug)?\.(core\.common|core1|core2|core3|precore)|(\@1js\/oscui\-compact\-quill\@\d{1,10}\.\d{1,10}\.\d{1,10}\/[A-Za-z0-9-]+\/v\d{1,10}\/bundled\/dist\/quill\.custom))\.(min\.)?js/,y=/(microsoftajaxds|common|mml_htmlormml|pptedit(ds)?(\.debug)?\.(core1|core2|core3|precore|ext-lazy)|officeextensionmerge)(\.min)?\.js(\:|$)/,S=/(wordeditords(eagercompile|separatedialog|\.debug)?\.(copilotcommon|common([0-9-])*)|recorder|ewats)(\.min)?\.js/,b=/(wordeditords|mathdesigner|microsoftajaxds|pptedit(ds)?(\.debug)?\.core3)\.(min\.)?js/,C=/(dime|wacboot|officewebsurfaces\.core|lpplazy|midgardbootstrapper|mathjax|livepersonacard_with-react_[0-9a-fA-F]{1,30}|pptedit(ds)?(\.debug)?\.(core1|core2|core3|precore))(\.min)?\.js/,E=/(mathjax|wacboot|wordeditords(eagercompile|separatedialog)?(\.box4\.dll1)?)(\.min)?\.js/,w=/(common|copilotcommonux)\.(min\.)?js/,_=/(officebrowserfeedback_floodgate)\.(min\.)?js/,v=new RegExp(`(${h.source})(common|common50|commonux([0-9a-fA-F]|\\-){0,10}|jquery(\\.signalr\\.merge\\.\\d+\\.\\d+\\.min)?|compatparentelementfix|sharedcommentslazy|richtexteditor|appchrome|copilotcommonux|copilotcomprehensionux)\\.(min\\.)?js`),P=new RegExp(`${c.source}(mathjax|jax|mml_htmlormml)\\.js`),T=new RegExp(`${l.source}mathjax/(mathjax)\\.js`),I=new RegExp("/scripts/me/mecontrol/\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}/[a-zA-Z]{1,10}-[a-zA-Z]{1,10}/meboot.min.js"),A=new RegExp(`(/officeonline/versioned/host-word/\\d{1,4}\\.\\d{1,2}\\.\\d{1,2}/|${f.source}|${p.source}(${u.source}|${m.source}|/lib-es5/))(gc2|gc2host)\\.(min\\.)?js`),M=new RegExp(`(${d.source}|${p.source}(${u.source}|${m.source}|/lib-es5/))(gc2host)\\.(min\\.)?js`),x=new RegExp(`(${f.source})(pptedit(ds)?\\.precore)\\.(min\\.)?js`),k=new RegExp(`(${f.source})(pptedit(ds)?\\.core\\.common)\\.(min\\.)?js`),L=new RegExp(`(${f.source})(immersivereader)\\.(min\\.)?js`),D=new RegExp(`(${f.source})(pptedit(ds)?\\.(core1|core2|core3))\\.(min\\.)?js`),W=new RegExp(`(${v.source})|(${P.source})|(${T.source})|(${I.source})|(${A.source})|(${M.source})|(${x.source})|(${k.source})|(${L.source})|(${D.source})`),O=new RegExp(`(${h.source})(microsoftajaxds|common|pptedit(ds)?(.debug)?.(core1|core2|core3|precore|ext-lazy)|officeextensionmerge)\\.(min\\.)?js(\\:|$)`),$=new RegExp(`${c.source}mml_htmlormml.js`),R=new RegExp(`(${O.source})|(${$.source})`),F=new RegExp(`(${d.source}|${p.source}(${u.source}|${m.source}))feedback/officebrowserfeedback_floodgate\\.(min\\.)?js`),U=new RegExp(`((${h.source})(mathdesigner|microsoftajaxds|pptedit(ds)?(.debug)?.core3)\\.(min\\.)?js)|(${F.source})`),j=new RegExp("/office-growth/resources/programmablesurfaces/(int|prod)/officewebsurfaces\\.core\\.(min\\.)?js"),N=new RegExp(`(${h.source}(lpplazy|midgardbootstrapper)|(${c.source}mathjax))\\.(min\\.)?js`),z=new RegExp("/midgard/versionless/livepersonacard_with-react_[0-9a-fA-F]{1,30}\\.(min\\.)?js"),H=new RegExp("/dime/v1/dime\\.js"),J=new RegExp(`(${h.source}(mathjax/mathjax\\.js))`),B=new RegExp(`(${h.source}(pptedit(?:ds)?\\.(precore|core1|core2|core3|ext-lazy)\\.js))`),V=new RegExp("/officeonline/p/s/h?[0-9a-fA-F]+_pptscripts/bootviewds\\.js"),G=new RegExp(`${j.source}|${N.source}|${z.source}|${H.source}|${J.source}|${B.source}|${V.source}`),K=new RegExp(`(${h.source})(common|copilotcommonux)\\.(min\\.)?js`),Z=new RegExp(`${c.source}mathjax.js`),q=new RegExp(`((${h.source})wordeditords(eagercompile|separatedialog)?(\\.box4\\.dll1)?\\.js)|(${Z.source})`),X=new RegExp(`(${h.source})(wordeditords(eagercompile|separatedialog|\\.debug)?\\.(copilotcommon|common([0-9-])*)|recorder|ewats)\\.(min\\.)?js`),Y=e=>"https://amcdn.msftauth.net"===e||(0,n.isAnAllowedOrigin)(e),Q=e=>n.localhostRegex.test(e),ee=(e,t)=>{try{throw new Error}catch(r){if(!r.stack)return!1;const o=r.stack.match(s);if(!o?.length)return!1;for(const r of o)try{const{origin:o,pathname:a}=new URL(r);if(!Y(o))continue;const i=a.toLowerCase(),n=Q(o)&&t?.test(i),s=e?.test(i);if(s||n)return!0}catch{}return!1}},te=new Set(["","<input/>","<a href='#'></a>","<option></option>","<textarea>x</textarea>","<form></form><form></form>","<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>","Add-ins","Bold (Ctrl+B)","Border Options","Bullets","Bullets (Ctrl+.)","Catch up","Checklist (Ctrl+,)","Click to see page load statistics","Clipboard","Clear Formatting","Comments","Copy (Ctrl+C)","Copilot","Cut (Ctrl+X)","Decrease Indent (Ctrl+Shift+M)","Designer","Dictate","Dictate (Alt+`)","Editor","Emphasis","Find","Find (Ctrl+F)","Font Color","Font Name","Font Size","Format Painter (Ctrl+Alt+C, Ctrl+Alt+V) <br /> To apply the formatting in multiple places, double-click Format Painter.","Grow Font Size (Ctrl+Shift+>)","Heading 1","Heading 2","Headings and Other Styles","Help Improve Office","Highlight","Increase Indent (Ctrl+M)","Italic (Ctrl+I)","Mode Menu: Editing","More Collaboration Options","More Options","Normal","Numbering","Numbering (Ctrl+/)","Line Spacing","Paragraph Options","Paragraph Shading","Paste","RibbonOptionsTooltip","Saved <br /> Click the cloud icon to view file location","Sensitivity","Separate Pages","Set Proofing Language","Share","Share: this file is shared","Show Developer Tools Menu","Shrink Font Size (Ctrl+Shift+<)","Strikethrough (Ctrl+Shift+X)","Subscript (Ctrl+Shift+-)","Subtitle","Superscript (Ctrl+Shift++)","Switch to light background","Text Alignment","The current page number in the document. Click or tap to open the Navigation Pane.","The number of words in the selection or document. Click or tap to open the word count dialog box.","Title","Underline (Ctrl+U)","Undo","Undo (Ctrl+Z)","Zoom","Zoom In","Zoom Level","Zoom Out","Zoom to fit page width"])},780:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testContent=t.htmlBlockListAttributes=t.htmlBlockList=t.defaultConfig=void 0,t.defaultConfig={ADD_TAGS:["#comment"],RETURN_TRUSTED_TYPE:!1},t.htmlBlockList=["applet","base","basefont","command","embed","frame","frameset","keygen","link","meta","noframes","noscript","object","param","script","title"],t.htmlBlockListAttributes=["contenteditable","contextmenu","controls","data","decoding","defer","dirname","draggable","dropzone","form","formaction","http-equiv","icon","importance","itemprop","keytype","kind","language","lazyload","manifest","minlength","muted","ping","sandbox","scoped","slot","spellcheck","srcdoc","srclang","start","target","translate","wrap","onerror","onclick","onload","onmouseover","onfocus","onblur","src","href"],t.testContent={maliciousHTML:"<div onerror=\"alert('XSS')\"></div>",maliciousSVG:'<svg><circle cx="50" cy="50" r="40" onclick="alert(\'XSS\')"></circle></svg>',maliciousMathML:"<math><msup><mi>x</mi><mn>2</mn></msup><div onclick=\"alert('XSS')\"></div></math>",sanitizedHTML:"<div></div>",sanitizedSVG:'<svg><circle r="40" cy="50" cx="50"></circle></svg>',sanitizedMathML:"<math><msup><mi>x</mi><mn>2</mn></msup></math><div></div>",missingAttrHTML:['<div paraid="example"></div>','<div lang="en"></div>'],missingTagsHTML:['<div class="InsertMediaM365Dialog" id="insertmediadialog"> <div class="InsertMediaM365Panel" id="insertmediapanel"> <iframe id="insertmediaframe" class="InsertMediaFrame" name="InsertMediaFrame"></iframe></div></div>',"\x3c!-- This is a comment --\x3e<div>Content</div>"]}},20:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.domPurifyPolicyHtml=t.createDomPurifyPolicyHtml=void 0;const o=r(1262),a=r(1745);t.createDomPurifyPolicyHtml=(e,t)=>(0,o.createPolicy)(e,{createHTML:(e,t,r)=>(0,a.sanitizedHTMLAndValidate)(e,t,r)},t),t.domPurifyPolicyHtml=(0,t.createDomPurifyPolicyHtml)("domPurifyHTML")},1745:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.domPurifyIsValidAttribute=t.sanitizedHTMLAndValidate=void 0;const o=r(6533),a=r(3498),i=o.__importStar(r(780));t.sanitizedHTMLAndValidate=(e,t,r)=>{let o=!1;const n=t?(e=>({...i.defaultConfig,ALLOW_ARIA_ATTR:!1!==e.ALLOW_ARIA_ATTR,ALLOW_DATA_ATTR:!1!==e.ALLOW_DATA_ATTR,FORCE_BODY:e.FORCE_BODY||!1,IN_PLACE:e.IN_PLACE||!1,SAFE_FOR_TEMPLATES:e.SAFE_FOR_TEMPLATES||!1,SANITIZE_DOM:!1!==e.SANITIZE_DOM,SANITIZE_NAMED_PROPS:e.SANITIZE_NAMED_PROPS||!1,USE_PROFILES:!!e.USE_PROFILES&&e.USE_PROFILES,WHOLE_DOCUMENT:e.WHOLE_DOCUMENT||!1,PARSER_MEDIA_TYPE:e.PARSER_MEDIA_TYPE?e.PARSER_MEDIA_TYPE:"text/html"}))(t):i.defaultConfig;r&&Object.entries(r).forEach((([e,t])=>{(0,a.addHook)(e,t)}));const s=(0,a.sanitize)(e,n);return r&&Object.entries(r).forEach((([e])=>{(0,a.removeHooks)(e)})),t?.USE_PROFILES?s:(o=(e=>{let t=!1,r=!1;const o=new Set,a=new Set;return e.length>0&&(e.forEach((e=>{e.attribute?(r=i.htmlBlockListAttributes.includes(e.attribute.localName)||r,o.add(e.attribute.localName)):e.element&&(r=i.htmlBlockList.includes(e.element.localName)||r,a.add(e.element.localName))})),(o.size>0||a.size>0)&&(r||(t=!0))),t})(a.removed),o?e:s)},t.domPurifyIsValidAttribute=a.isValidAttribute},1906:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emptyStringPolicyURL=t.createEmptyStringPolicyURL=t.emptyStringPolicyHTML=t.createEmptyStringPolicyHtml=void 0;const o=r(1262);t.createEmptyStringPolicyHtml=(e,t)=>(0,o.createPolicy)(e,{createHTML:e=>""},t),t.emptyStringPolicyHTML=(0,t.createEmptyStringPolicyHtml)("emptyStringPolicyHTML"),t.createEmptyStringPolicyURL=(e,t)=>(0,o.createPolicy)(e,{createScriptURL:e=>""},t),t.emptyStringPolicyURL=(0,t.createEmptyStringPolicyURL)("emptyStringPolicyURL")},3800:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.urlOriginPolicy=t.createUrlOriginPolicy=t.isAnAllowedOrigin=t.bbRunsRegex=t.localhostRegex=t.setRuntimeAllowedOrigins=void 0;const o=r(1262),a=["https://res.cdn.office.net","https://res-sdf.cdn.office.net","https://res-v-sdf.cdn.office.net","https://res-v.cdn.office.net","https://uci.edog.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-h1.cdn.office.net","https://res-1-sdf.cdn.office.net","https://res-2-sdf.cdn.office.net","https://res-1-dev.cdn.officeppe.net","https://res-2-dev.cdn.officeppe.net","https://content.lifecycle.office.net","https://content.lifecycle.officeppe.net","https://res.df.onecdn.static.microsoft","https://res.public.onecdn.static.microsoft","https://res-1.public.onecdn.static.microsoft","https://wordwebclientbuilds.blob.core.windows.net","https://js.live.net","https://c5-onenote-15.cdn.office.net","https://s1-onenote-gcc-15.cdn.office.net","https://ffc-powerpoint.officeapps.live.com","https://ppc-powerpoint.officeapps.live.com","https://powerpoint.officeapps.live.com","https://eurppc-powerpoint.officeapps.live.com","https://ffc-powerpoint.officeapps.live.com","https://fil1-powerpoint.officeapps.live.com","https://fin1-powerpoint.officeapps.live.com","https://fus1-powerpoint.officeapps.live.com","https://gbc-powerpoint.officeapps.live.com","https://jpc-powerpoint.officeapps.live.com","https://usc-powerpoint.officeapps.live.com"].map((e=>e.trim()));let i=[];t.setRuntimeAllowedOrigins=e=>{i=i.concat(e)};const n=[/^https?:\/\/([0-9a-zA-Z]+-)?(onenote|word-edit|word-view|excel|visio)\.officeapps\.live\.com$/],s=[/^https?:\/\/([\w-]+-)?(excel)(-[\w-]+)?\.cdn\.office\.net$/];t.localhostRegex=new RegExp("https?://((localhost|local\\.teams\\.(office|live)\\.com|cpc-[\\w-]+|[\\w-]+\\.[\\w-]+\\.corp\\.microsoft\\.com)(:\\d+)?)(:|/|$)"),t.bbRunsRegex=new RegExp("^https?://[\\w-]+\\.pyxidis\\.off(:\\d+)?$"),t.isAnAllowedOrigin=e=>a.includes(e)||i.includes(e)||n.some((t=>t.test(e)))||s.some((t=>t.test(e)))||t.localhostRegex.test(e)||t.bbRunsRegex.test(e),t.createUrlOriginPolicy=(e,r)=>(0,o.createPolicy)(e,{createScriptURL:e=>{let r;try{r=new URL(e,document.baseURI)?.origin}catch(t){r=new URL(e)?.origin}if(r&&(0,t.isAnAllowedOrigin)(r))return e;throw new Error(`TrustedTypes policy does not allow loading URL: ${e} with origin: ${r}`)}},r),t.urlOriginPolicy=(0,t.createUrlOriginPolicy)("urlOriginPolicy")},338:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuidStringPolicyHTML=t.createUUIDStringPolicyHtml=void 0;const o=r(1262);t.createUUIDStringPolicyHtml=(e,t)=>(0,o.createPolicy)(e,{createHTML:e=>{if(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e))return e;throw new Error("TrustedTypes policy: The provided value is not a valid UUID and cannot be used to create TrustedHTML")}},t),t.uuidStringPolicyHTML=(0,t.createUUIDStringPolicyHtml)("uuidStringPolicyHTML")},3114:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.createWorker=void 0,a(r(1680),t);var i=r(986);Object.defineProperty(t,"createWorker",{enumerable:!0,get:function(){return i.createWorker}})},1680:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.workerName=t.isWorkerThread=t.setUpTrustedTypesConfig=t.importScriptsWithRetry=t.Endpoint=t.paramInsideDef=t.dispatchWorkerError=t.setConfig=t.isThreadingSupported=t.WorkerError=void 0;var o=r(4112);Object.defineProperty(t,"WorkerError",{enumerable:!0,get:function(){return o.WorkerError}});var a=r(2720);Object.defineProperty(t,"isThreadingSupported",{enumerable:!0,get:function(){return a.isThreadingSupported}}),Object.defineProperty(t,"setConfig",{enumerable:!0,get:function(){return a.setConfig}}),Object.defineProperty(t,"dispatchWorkerError",{enumerable:!0,get:function(){return a.dispatchWorkerError}});var i=r(6156);Object.defineProperty(t,"paramInsideDef",{enumerable:!0,get:function(){return i.paramInsideDef}});var n=r(5887);Object.defineProperty(t,"Endpoint",{enumerable:!0,get:function(){return n.Endpoint}});var s=r(6541);Object.defineProperty(t,"importScriptsWithRetry",{enumerable:!0,get:function(){return s.importScriptsWithRetry}});var c=r(1820);Object.defineProperty(t,"setUpTrustedTypesConfig",{enumerable:!0,get:function(){return c.setUpTrustedTypesConfig}});var l=r(4153);Object.defineProperty(t,"isWorkerThread",{enumerable:!0,get:function(){return l.isWorkerThread}}),Object.defineProperty(t,"workerName",{enumerable:!0,get:function(){return l.workerName}})},2720:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThreadMessageKind=void 0,t.isThreadingSupported=s,t.setConfig=function(e){if(c)throw new TypeError("setConfig has already been called");c=e},t.getSafeParams=function(){const e=c??{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?[...e.importScriptUrls]:void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}},t.getCreateTimeout=function(e){return e?.createTimeout??c?.createTimeout??a},t.getCreateMode=function(e){const t=e?.createMode??c?.createMode??i;return"ThreadOrLocal"===t?s()?"Thread":"Local":t},t.dispatchWorkerError=function(e){try{(c?.onWorkerError??p)(e)}catch(t){console.warn(e),l(t)}},t.dispatchCreateWorker=function(e){try{(c?.onCreateWorker??u)(e)}catch(e){l(e)}};const o=r(2406),a=3e5,i="Thread";var n;function s(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}let c;function l(e){setTimeout((()=>{throw e}))}function d(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function p(e){const t=d();if(void 0!==t){const r={kind:n.WorkerError,error:(0,o.encodeResultValue)(e)};t.postMessage(r)}else console.warn(e)}function u(e){const t=d();if(void 0!==t){const r={kind:n.CreateWorker,stats:e};t.postMessage(r)}}!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(n||(t.ThreadMessageKind=n={}))},986:function(e,t,r){"use strict";var o,a=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||(o=function(e){return o=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},o(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=o(e),n=0;n<r.length;n++)"default"!==r[n]&&a(t,e,r[n]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.createWorker=S;const s=r(2720),c=r(5887),l=r(3402),d=r(6156),p=r(8751),u=r(294),m=r(4112),f={...n(r(1680)),createWorker:S};function h(e,t,r,o,a){const{port1:i,port2:n}=new MessageChannel;let s;return Promise.all([o({port:i,options:e,createMode:t}),(0,p.timePromise)(r.createOutside=(0,p.startStopwatch)(),(()=>c.Endpoint.createOutside({port:n,options:e,createMode:t},(e=>a(s=e)))))]).then((()=>s),(e=>(s?s.close("Force"):n.close(),Promise.reject(e))))}function g(e,t,r,o){return h(e,"Local",t,(e=>function(e,t,r){const{def:o,args:a}="def"in r?r:(0,d.paramInsideDef)(r);if("function"!=typeof o){const t={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new m.WorkerError("Loading an InsideScript to create a local worker is unimplemented",t))}return Promise.resolve().then((()=>(0,p.timePromise)(t.insideInit=(0,p.startStopwatch)(),(()=>o({config:(0,s.getSafeParams)(),importTypedWorkers:()=>f,connection:e},...a).then((()=>{}))))))}(e,t,r)),o)}function y(e,t,r,o){let a;t.createThread=(0,p.startStopwatch)();try{a=new u.Thread(e,r)}catch(e){return(0,p.stopStopwatch)(t.createThread,"Error"),Promise.reject(e)}return(0,p.stopStopwatch)(t.createThread,"Success"),h(e,"Thread",t,(e=>a.createInside(e,t)),o).then((e=>(e.hasBeenClosed()?a.terminate():e._onClose=a.terminate.bind(a),e)),(e=>(a.terminate(),Promise.reject(e))))}function S(e,t,r=(()=>{})){const o=(0,s.getCreateMode)(e),a="local"in t?"Local"===o?t.local:t.thread:t,i="Local"===o?g:y,n={id:e.id,createMode:o,createWorker:(0,p.startStopwatch)()},d=(0,p.timePromise)(n.createWorker,(()=>i((0,c.getSafeOptions)(e),n,a,r)));return(0,l.promiseFinally)(d,(()=>{const e=(0,p.createWorkerStats)(n);e&&(0,s.dispatchCreateWorker)(e)}))}},5887:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Endpoint=void 0,t.getSafeOptions=function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls,importScriptsMaxRetries:e.importScriptsMaxRetries,isTrustedTypesPolicyEnabled:e.isTrustedTypesPolicyEnabled}};const o=r(2720),a=r(5606),i=r(2406),n=r(3402),s=r(4112);class c{static _create(e,t,r){const{port:i,options:l,createMode:d}=t,p={type:"Endpoint",side:e,id:l?.id};let u,m;try{u=new a.EndpointState(p,i),m=new c(p,u,d)}catch(e){return Promise.reject(e)}return new Promise(((t,a)=>{u.getCallTimeout=()=>m.callTimeout,u.getOnPostMessageError=()=>m.onPostMessageError,u.onImports=(e,t)=>{Object.defineProperties(m,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),c.resolve()},u.onClose=()=>m.close("Force");const i=(0,o.getCreateTimeout)(l),c=(0,n.setCallbacksTimeout)(i,(()=>{const t="Outside"===e?"inside":"outside",r={cause:"Timeout",idInfo:p,timeout:i},o=new s.WorkerError(`${e} Endpoint timed out waiting for the ${t} to start`,r);c.reject(o)}),{resolve:t,reject:a});let d;m._closedDuringCreate=()=>{c.resolve()};try{d=r(m)}catch(e){return c.reject(e)}m._state?.setExports(d)})).then((()=>(m._closedDuringCreate=void 0,m)),(e=>(m._closedDuringCreate=void 0,m.close(),Promise.reject(e))))}hasBeenClosed(){return void 0===this._state}close(e){if(!this._state)return;if(this._closedDuringCreate){if("Force"!==e){const e={cause:"Connection",idInfo:this._idInfo};throw new s.WorkerError(`${this._idInfo.side} Endpoint's close called during creation`,e)}this._closedDuringCreate()}const t=this._state;this._state=void 0;try{t.close(),this._onClose?.(),this.onClose?.()}catch(e){const t={cause:"Connection",idInfo:this._idInfo,error:(0,i.asError)(e)};(0,o.dispatchWorkerError)(new s.WorkerError(`${this._idInfo.side} Endpoint's close threw an error`,t))}}constructor(e,t,r){this.callTimeout=1/0,this.onPostMessageError=a.throwWorkerError,this._idInfo=e,this._state=t,this.createMode=r;const o=t=>()=>{const r="Outside"===e.side?"inside":"outside",o={cause:"Connection",idInfo:e};throw new s.WorkerError(`${e.side} Endpoint's ${t} referenced before the ${r} Endpoint started`,o)};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:o("post")},call:{configurable:!0,enumerable:!1,get:o("call")}})}}t.Endpoint=c,c.createOutside=(e,t=(()=>{}))=>c._create("Outside",e,t),c.createInside=(e,t)=>c._create("Inside",e,t)},5606:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EndpointState=void 0,t.throwWorkerError=c;const o=r(2720),a=r(2406),i=r(3402),n=r(4112);var s;function c(e){throw e}!function(e){e[e.Invoke=0]="Invoke",e[e.Result=1]="Result",e[e.Names=2]="Names",e[e.Close=3]="Close"}(s||(s={}));let l=-1;t.EndpointState=class{setExports(e){this.exports=e;const t=(0,i.haveNativeProxy)()?void 0:(0,i.getFunctionPropertyNames)(e),r={kind:s.Names,funcNames:t};this.port.postMessage(r)}close(){if(this.isClosed)return;this.isClosed=!0;const e={kind:s.Close};this.port.postMessage(e),this.port.close();for(const e in this.unresolvedCalls){const{reject:t,funcName:r}=this.unresolvedCalls[e],o={cause:"Connection",idInfo:this.idInfo,funcName:r};t(new n.WorkerError(`Importing Endpoint closed while waiting for ${r} result`,o))}}onInvoke({callId:e,funcName:t,args:r}){const i=Promise.resolve().then((()=>{const o=this.exports[t];if(o)return o.apply(this.exports,r);const a=e>=0?"call":"post",i={cause:"Connection",idInfo:this.idInfo,callId:e,funcName:t};throw new n.WorkerError(`Exporting Endpoint received a ${a} to unknown function ${t}`,i)}));e>=0?i.then((r=>this.sendResult(e,t,!0,r)),(r=>this.sendResult(e,t,!1,r))):i.catch((r=>{const i=(0,a.asError)(r),s={cause:"UnhandledError",idInfo:this.idInfo,error:i,callId:e,funcName:t};(0,o.dispatchWorkerError)(new n.WorkerError(`Exporting Endpoint's ${t} implementation threw or rejected`,s))}))}sendResult(e,t,r,o){const i=(0,a.encodeResultValue)(o),n={kind:s.Result,callId:e,funcName:t,isFulfilled:r,resultValue:i};try{this.port.postMessage(n,void 0)}catch(e){this.onSendResultFailed(n,(0,a.asError)(e))}}onSendResultFailed({callId:e,funcName:t,resultValue:r},a){const i=a?`Exporting Endpoint failed to send ${t} result`:`Importing Endpoint failed to deserialize ${t} result`,s={cause:"MessageError",idInfo:this.idInfo,error:a,callId:e,funcName:t},c=new n.WorkerError(i,s);r.isError?(0,o.dispatchWorkerError)(c):this.sendResult(e,t,!1,c)}takeCallbacks(e){const t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t}setCallTimeout(e,t,r,o){return r>i.maxTimeout?o:(0,i.setCallbacksTimeout)(r,(()=>{const o=this.takeCallbacks(e);if(o){const a={cause:"Timeout",idInfo:this.idInfo,timeout:r,callId:e,funcName:t};o.reject(new n.WorkerError(`Importing Endpoint's call to ${t} timed out`,a))}}),o)}sendCall(e,t,r,o){return new Promise(((i,c)=>{const d=l+=1,p={kind:s.Invoke,callId:d,funcName:e,args:t};this.unresolvedCalls[d]={...this.setCallTimeout(d,e,r,{resolve:i,reject:c}),funcName:e};try{this.port.postMessage(p,o)}catch(t){const r=this.takeCallbacks(d);if(r){const o=(0,a.asError)(t),i={cause:"MessageError",idInfo:this.idInfo,error:o,callId:d,funcName:e};r.reject(new n.WorkerError(`Importing Endpoint failed to send call to ${e}`,i))}}}))}sendPost(e,t,r,o){const i={kind:s.Invoke,callId:-1,funcName:e,args:t};try{this.port.postMessage(i,o)}catch(t){const o=(0,a.asError)(t),i={cause:"MessageError",idInfo:this.idInfo,error:o,callId:-1,funcName:e};r(new n.WorkerError(`Importing Endpoint failed to post to ${e}`,i))}}onSendInvokeFailed({callId:e,funcName:t}){const r=e>=0?"call":"post",a={cause:"MessageError",idInfo:this.idInfo,callId:e,funcName:t},i=new n.WorkerError(`Exporting Endpoint failed to deserialize ${r} to ${t}`,a),s=e>=0?this.takeCallbacks(e):void 0;(s?.reject??o.dispatchWorkerError)(i)}onResult({callId:e,funcName:t,isFulfilled:r,resultValue:a}){if(e>=0){const t=this.takeCallbacks(e);t&&(r?t.resolve:t.reject)((0,n.decodeResultValue)(a))}else{const r={cause:"InternalError",idInfo:this.idInfo,callId:e,funcName:t};(0,o.dispatchWorkerError)(new n.WorkerError(`Exporting Endpoint sent a result for a post to ${t}`,r))}}createPostProxy(e){const t=(...e)=>t.transfer(void 0,...e);return t.transfer=(r,...o)=>{if(this.isClosed)return;const a=t.onPostMessageError??this.getOnPostMessageError?.()??c;this.sendPost(e,o,a,r)},t}createCallProxy(e){const t=(...e)=>t.transfer(void 0,...e);return t.transfer=(r,...o)=>{if(this.isClosed){const t={cause:"Connection",idInfo:this.idInfo,funcName:e};return Promise.reject(new n.WorkerError(`${this.idInfo.side} Endpoint's call.${e} called after close`,t))}const a=t.callTimeout??this.getCallTimeout?.()??1/0;return this.sendCall(e,o,a,r)},t.callTimeout=void 0,t}constructor(e,t){this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=(0,i.createEmptyRecord)();const r=()=>this.onClose?.(),o={[s.Invoke]:this.onInvoke.bind(this),[s.Result]:this.onResult.bind(this),[s.Names]:({funcNames:e})=>{this.onImports?.((0,i.createObjectFromFunction)(this.createPostProxy.bind(this),e),(0,i.createObjectFromFunction)(this.createCallProxy.bind(this),e))},[s.Close]:r},a={[s.Invoke]:this.onSendInvokeFailed.bind(this),[s.Result]:this.onSendResultFailed.bind(this),[s.Names]:r,[s.Close]:r};this.port.onmessage=({data:e})=>o[e.kind](e),this.port.onmessageerror=({data:e})=>a[e.kind](e)}}},2406:function(e,t){"use strict";function r(e){return o(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function o(e){if(null==e)return!1;if(e instanceof Error)return!0;const t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return{...e,error:e.error?i(e.error):void 0}}function i(e){return{name:e.name,message:r(e)?e.baseMessage:e.message,stack:e.stack,info:r(e)?a(e.info):void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerError=r,t.isError=o,t.asError=function(e){return o(e)?e:new Error(`(non-Error object) ${function(e){const t=typeof e;switch(t){case"function":case"symbol":case"undefined":return`<${t}>`;case"object":return JSON.stringify(e);default:return`${e}`}}(e)}`)},t.encodeWorkerErrorInfo=a,t.encodeError=i,t.encodeResultValue=function(e){return o(e)?{isError:!0,value:i(e)}:{isError:!1,value:e}}},3402:function(e,t){"use strict";function r(){const e=Object.create(null);return e.key=void 0,delete e.key,e}let o;Object.defineProperty(t,"__esModule",{value:!0}),t.maxTimeout=void 0,t.promiseFinally=function(e,t){return e.then((e=>(t(),e)),(e=>(t(),Promise.reject(e))))},t.setCallbacksTimeout=function(e,r,o){if(e>t.maxTimeout)return o;const a=setTimeout(r,Math.max(0,e));return{resolve:e=>{clearTimeout(a),o.resolve(e)},reject:e=>{clearTimeout(a),o.reject(e)}}},t.createEmptyRecord=r,t.getFunctionPropertyNames=function(e){const t=r();for(;null!=e;){for(const r of Object.getOwnPropertyNames(e))try{"function"==typeof e[r]&&(t[r]=!0)}catch{}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)},t.haveNativeProxy=function(){return o??(o=function(){try{return"function"==typeof Proxy&&!0===new Proxy({},{get:()=>!0}).k}catch{return!1}}())},t.createObjectFromFunction=function(e,t){const o=r(),a=(t,r)=>"then"===r?void 0:t[r]??(t[r]=e(r));return t?(t.forEach((e=>a(o,e))),o):new Proxy(o,{get:a})},t.maxTimeout=1<<30},6541:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.importScriptsWithRetry=function(e,t){if(0!==t)for(const r of e)i(r,t);else{const t=(0,o.getTrustedScriptUrls)([...e]);importScripts(...t)}};const o=r(1820);function a(e,t,r){const o=e.indexOf("?");if(o<0)return`${e}?${t}=${r}`;const a=e.slice(0,o+1),i=e.slice(o+1).split("&");let n=0;for(;n<i.length&&("="!==i[n][t.length]||i[n].slice(0,t.length)!==t);n+=1);return i[n]=`${t}=${r}`,a+i.join("&")}function i(e,t){let r;for(let i=0;i<=t;i+=1)try{const t=i>0?a(e,"retries",String(i)):e,r=(0,o.getTrustedUrl)(t);return void importScripts(r)}catch(e){r=e}throw r}},6156:function(e,t){"use strict";function r(e){throw new ReferenceError(`${e} is not defined`)}Object.defineProperty(t,"__esModule",{value:!0}),t.paramInsideDef=void 0,t.indexObject=function(e,t,o=r){try{const r=t.split(".");for(const t of r)e=e[t];return e??o(t)}catch{return o(t)}},t.paramInsideDef=(e,...r)=>t.paramInsideDef.transfer(e,void 0,...r),t.paramInsideDef.transfer=(e,t,...r)=>({def:e,args:r,transferables:t??[]})},8751:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startStopwatch=function(){return{status:"Pending",start:a()}},t.stopStopwatch=i,t.timePromise=function(e,t){function r(t){throw i(e,(0,o.isWorkerError)(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((t=>i(e,"Success")??t),r)}catch(e){r(e)}},t.createWorkerStats=function(e){const{id:t,createMode:r,createWorker:o,insideInit:a,createOutside:i,createThread:s}=e,{status:l,start:d,end:p}=o;if("Pending"!==l&&void 0!==p)return{id:t,createMode:r,createWorker:{status:l,absStart:d,duration:n(p-d)},createThread:"Thread"===r?c(s,d,p):void 0,createOutside:c(i,d,p),insideInit:c(a,d,p)}};const o=r(2406),a="undefined"!=typeof performance&&void 0!==performance.timeOrigin?()=>performance.now()+performance.timeOrigin:()=>Date.now();function i(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,r??a()))}function n(e){return Math.round(1e3*e)/1e3}function s(e,t,r){return e<t?t:e>r?r:e}function c(e,t,r){const o=s(e?.start??1/0,t,r),a=s(e?.end??1/0,t,r);return{status:e?.status??"Pending",start:n(o-t),end:n(a-t),duration:n(a-o)}}},294:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Thread=void 0;const a=r(4342),i=r(2720),n=r(3402),s=r(6156),c=o(r(138)),l=r(1820),d=r(4112);let p=-1;t.Thread=class{revokeBlobUrl(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)}createInside(e,t){const{port:r,options:o}=e,s={type:"Thread",side:"Outside",id:o.id},c=this.worker,l=new Promise(((e,n)=>{this.createCallbacks={resolve:e,reject:n};const l={config:(0,i.getSafeParams)(),port:r,options:o,script:this.script,args:this.args,featureGateDictionary:(0,a.getFeatureGateDictionary)(),changeGateDictionary:(0,a.getChangeGateDictionary)()};c.postMessage(l,[r,...this.transferables]),c.onerror=e=>{e.preventDefault();const t=(0,d.getErrorEventWorkerError)(s,"worker.onerror",e);this.createCallbacks?this.createCallbacks.reject(t):(0,i.dispatchWorkerError)(t)},c.onmessage=({data:e})=>{switch(e.kind){case i.ThreadMessageKind.InitResult:return t.insideInit=e.stopwatch,void 0===e.error?this.createCallbacks?.resolve():this.createCallbacks?.reject((0,d.decodeResultValue)(e.error));case i.ThreadMessageKind.WorkerError:return(0,i.dispatchWorkerError)((0,d.decodeResultValue)(e.error));case i.ThreadMessageKind.CreateWorker:return(0,i.dispatchCreateWorker)(e.stats)}}}));return(0,n.promiseFinally)(l,(()=>{this.createCallbacks=void 0}))}terminate(){if(!this.worker)return;const e=this.worker;this.worker=void 0,this.createCallbacks?.resolve(),e.terminate(),this.revokeBlobUrl()}constructor(e,t){try{let r;(0,l.setUpTrustedTypesConfig)(e.isTrustedTypesPolicyEnabled),[this.script,this.args,this.transferables,r]=function(e){const{def:t,args:r,transferables:o}="def"in e?e:(0,s.paramInsideDef)(e);if("function"!=typeof t)return[t,r,o,void 0];const a=`__generatedInsideInit${p+=1}`;return[{scriptUrl:void 0,insideInitName:a},r,o,`var ${a} = ${t.toString()};`]}(t);const o=void 0===r?[c.default]:[r,"\n\n",c.default];this.blobUrl=URL.createObjectURL(new Blob(o,{type:"application/javascript"}));const a={};null!=e.id&&(a.name=e.id);const i=(0,l.getTrustedUrl)(this.blobUrl);this.worker=new Worker(i,a)}catch(e){throw this.worker?.terminate(),this.revokeBlobUrl(),e}}}},138:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default='(function(){var threadBootstrap;(()=>{var e={399:function(e){e.exports=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,r){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,r)}function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function o(e,n,i){return o=r()?Reflect.construct:function(e,r,o){var n=[null];n.push.apply(n,r);var i=new(Function.bind.apply(e,n));return o&&t(i,o.prototype),i},o.apply(null,arguments)}function n(e){return i(e)||a(e)||c(e)||l()}function i(e){if(Array.isArray(e))return s(e)}function a(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function c(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u=Object.hasOwnProperty,f=Object.setPrototypeOf,d=Object.isFrozen,p=Object.getPrototypeOf,m=Object.getOwnPropertyDescriptor,y=Object.freeze,h=Object.seal,g=Object.create,_="undefined"!=typeof Reflect&&Reflect,b=_.apply,v=_.construct;b||(b=function(e,t,r){return e.apply(t,r)}),y||(y=function(e){return e}),h||(h=function(e){return e}),v||(v=function(e,t){return o(e,n(t))});var w=k(Array.prototype.forEach),T=k(Array.prototype.pop),S=k(Array.prototype.push),E=k(String.prototype.toLowerCase),O=k(String.prototype.toString),P=k(String.prototype.match),x=k(String.prototype.replace),A=k(String.prototype.indexOf),R=k(String.prototype.trim),M=k(RegExp.prototype.test),L=j(TypeError);function k(e){return function(t){for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];return b(e,t,o)}}function j(e){return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return v(e,r)}}function C(e,t,r){var o;r=null!==(o=r)&&void 0!==o?o:E,f&&f(e,null);for(var n=t.length;n--;){var i=t[n];if("string"==typeof i){var a=r(i);a!==i&&(d(t)||(t[n]=a),i=a)}e[i]=!0}return e}function N(e){var t,r=g(null);for(t in e)!0===b(u,e,[t])&&(r[t]=e[t]);return r}function D(e,t){for(;null!==e;){var r=m(e,t);if(r){if(r.get)return k(r.get);if("function"==typeof r.value)return k(r.value)}e=p(e)}function o(e){return console.warn("fallback value for",e),null}return o}var I=y(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),U=y(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),F=y(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),H=y(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),$=y(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),G=y(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),z=y(["#text"]),W=y(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),B=y(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),V=y(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Z=y(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),q=h(/\\{\\{[\\w\\W]*|[\\w\\W]*\\}\\}/gm),Y=h(/<%[\\w\\W]*|[\\w\\W]*%>/gm),K=h(/\\${[\\w\\W]*}/gm),X=h(/^data-[\\-\\w.\\u00B7-\\uFFFF]/),J=h(/^aria-[\\-\\w]+$/),Q=h(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i),ee=h(/^(?:\\w+script|data):/i),te=h(/[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g),re=h(/^html$/i),oe=h(/^[a-z][.\\w]*(-[.\\w]+)+$/i),ne=function(){return"undefined"==typeof window?null:window},ie=function(t,r){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var o=null,n="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(n)&&(o=r.currentScript.getAttribute(n));var i="dompurify"+(o?"#"+o:"");try{return t.createPolicy(i,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function ae(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne(),r=function(e){return ae(e)};if(r.version="2.5.7",r.removed=[],!t||!t.document||9!==t.document.nodeType)return r.isSupported=!1,r;var o=t.document,i=t.document,a=t.DocumentFragment,c=t.HTMLTemplateElement,s=t.Node,l=t.Element,u=t.NodeFilter,f=t.NamedNodeMap,d=void 0===f?t.NamedNodeMap||t.MozNamedAttrMap:f,p=t.HTMLFormElement,m=t.DOMParser,h=t.trustedTypes,g=l.prototype,_=D(g,"cloneNode"),b=D(g,"nextSibling"),v=D(g,"childNodes"),k=D(g,"parentNode");if("function"==typeof c){var j=i.createElement("template");j.content&&j.content.ownerDocument&&(i=j.content.ownerDocument)}var ce=ie(h,o),se=ce?ce.createHTML(""):"",le=i,ue=le.implementation,fe=le.createNodeIterator,de=le.createDocumentFragment,pe=le.getElementsByTagName,me=o.importNode,ye={};try{ye=N(i).documentMode?i.documentMode:{}}catch(e){}var he={};r.isSupported="function"==typeof k&&ue&&void 0!==ue.createHTMLDocument&&9!==ye;var ge,_e,be=q,ve=Y,we=K,Te=X,Se=J,Ee=ee,Oe=te,Pe=oe,xe=Q,Ae=null,Re=C({},[].concat(n(I),n(U),n(F),n($),n(z))),Me=null,Le=C({},[].concat(n(W),n(B),n(V),n(Z))),ke=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),je=null,Ce=null,Ne=!0,De=!0,Ie=!1,Ue=!0,Fe=!1,He=!0,$e=!1,Ge=!1,ze=!1,We=!1,Be=!1,Ve=!1,Ze=!0,qe=!1,Ye="user-content-",Ke=!0,Xe=!1,Je={},Qe=null,et=C({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),tt=null,rt=C({},["audio","video","img","source","image","track"]),ot=null,nt=C({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),it="http://www.w3.org/1998/Math/MathML",at="http://www.w3.org/2000/svg",ct="http://www.w3.org/1999/xhtml",st=ct,lt=!1,ut=null,ft=C({},[it,at,ct],O),dt=["application/xhtml+xml","text/html"],pt="text/html",mt=null,yt=i.createElement("form"),ht=function(e){return e instanceof RegExp||e instanceof Function},gt=function(t){mt&&mt===t||(t&&"object"===e(t)||(t={}),t=N(t),ge=ge=-1===dt.indexOf(t.PARSER_MEDIA_TYPE)?pt:t.PARSER_MEDIA_TYPE,_e="application/xhtml+xml"===ge?O:E,Ae="ALLOWED_TAGS"in t?C({},t.ALLOWED_TAGS,_e):Re,Me="ALLOWED_ATTR"in t?C({},t.ALLOWED_ATTR,_e):Le,ut="ALLOWED_NAMESPACES"in t?C({},t.ALLOWED_NAMESPACES,O):ft,ot="ADD_URI_SAFE_ATTR"in t?C(N(nt),t.ADD_URI_SAFE_ATTR,_e):nt,tt="ADD_DATA_URI_TAGS"in t?C(N(rt),t.ADD_DATA_URI_TAGS,_e):rt,Qe="FORBID_CONTENTS"in t?C({},t.FORBID_CONTENTS,_e):et,je="FORBID_TAGS"in t?C({},t.FORBID_TAGS,_e):{},Ce="FORBID_ATTR"in t?C({},t.FORBID_ATTR,_e):{},Je="USE_PROFILES"in t&&t.USE_PROFILES,Ne=!1!==t.ALLOW_ARIA_ATTR,De=!1!==t.ALLOW_DATA_ATTR,Ie=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Ue=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Fe=t.SAFE_FOR_TEMPLATES||!1,He=!1!==t.SAFE_FOR_XML,$e=t.WHOLE_DOCUMENT||!1,We=t.RETURN_DOM||!1,Be=t.RETURN_DOM_FRAGMENT||!1,Ve=t.RETURN_TRUSTED_TYPE||!1,ze=t.FORCE_BODY||!1,Ze=!1!==t.SANITIZE_DOM,qe=t.SANITIZE_NAMED_PROPS||!1,Ke=!1!==t.KEEP_CONTENT,Xe=t.IN_PLACE||!1,xe=t.ALLOWED_URI_REGEXP||xe,st=t.NAMESPACE||ct,ke=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&ht(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ke.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&ht(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ke.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(ke.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Fe&&(De=!1),Be&&(We=!0),Je&&(Ae=C({},n(z)),Me=[],!0===Je.html&&(C(Ae,I),C(Me,W)),!0===Je.svg&&(C(Ae,U),C(Me,B),C(Me,Z)),!0===Je.svgFilters&&(C(Ae,F),C(Me,B),C(Me,Z)),!0===Je.mathMl&&(C(Ae,$),C(Me,V),C(Me,Z))),t.ADD_TAGS&&(Ae===Re&&(Ae=N(Ae)),C(Ae,t.ADD_TAGS,_e)),t.ADD_ATTR&&(Me===Le&&(Me=N(Me)),C(Me,t.ADD_ATTR,_e)),t.ADD_URI_SAFE_ATTR&&C(ot,t.ADD_URI_SAFE_ATTR,_e),t.FORBID_CONTENTS&&(Qe===et&&(Qe=N(Qe)),C(Qe,t.FORBID_CONTENTS,_e)),Ke&&(Ae["#text"]=!0),$e&&C(Ae,["html","head","body"]),Ae.table&&(C(Ae,["tbody"]),delete je.tbody),y&&y(t),mt=t)},_t=C({},["mi","mo","mn","ms","mtext"]),bt=C({},["annotation-xml"]),vt=C({},["title","style","font","a","script"]),wt=C({},U);C(wt,F),C(wt,H);var Tt=C({},$);C(Tt,G);var St=function(e){var t=k(e);t&&t.tagName||(t={namespaceURI:st,tagName:"template"});var r=E(e.tagName),o=E(t.tagName);return!!ut[e.namespaceURI]&&(e.namespaceURI===at?t.namespaceURI===ct?"svg"===r:t.namespaceURI===it?"svg"===r&&("annotation-xml"===o||_t[o]):Boolean(wt[r]):e.namespaceURI===it?t.namespaceURI===ct?"math"===r:t.namespaceURI===at?"math"===r&&bt[o]:Boolean(Tt[r]):e.namespaceURI===ct?!(t.namespaceURI===at&&!bt[o])&&!(t.namespaceURI===it&&!_t[o])&&!Tt[r]&&(vt[r]||!wt[r]):!("application/xhtml+xml"!==ge||!ut[e.namespaceURI]))},Et=function(e){S(r.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=se}catch(t){e.remove()}}},Ot=function(e,t){try{S(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){S(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Me[e])if(We||Be)try{Et(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Pt=function(e){var t,r;if(ze)e="<remove></remove>"+e;else{var o=P(e,/^[\\r\\n\\t ]+/);r=o&&o[0]}"application/xhtml+xml"===ge&&st===ct&&(e=\'<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>\'+e+"</body></html>");var n=ce?ce.createHTML(e):e;if(st===ct)try{t=(new m).parseFromString(n,ge)}catch(e){}if(!t||!t.documentElement){t=ue.createDocument(st,"template",null);try{t.documentElement.innerHTML=lt?se:n}catch(e){}}var a=t.body||t.documentElement;return e&&r&&a.insertBefore(i.createTextNode(r),a.childNodes[0]||null),st===ct?pe.call(t,$e?"html":"body")[0]:$e?t.documentElement:a},xt=function(e){return fe.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null,!1)},At=function(e){return e instanceof p&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof d)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},Rt=function(t){return"object"===e(s)?t instanceof s:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},Mt=function(e,t,o){he[e]&&w(he[e],(function(e){e.call(r,t,o,mt)}))},Lt=function(e){var t;if(Mt("beforeSanitizeElements",e,null),At(e))return Et(e),!0;if(M(/[\\u0080-\\uFFFF]/,e.nodeName))return Et(e),!0;var o=_e(e.nodeName);if(Mt("uponSanitizeElement",e,{tagName:o,allowedTags:Ae}),e.hasChildNodes()&&!Rt(e.firstElementChild)&&(!Rt(e.content)||!Rt(e.content.firstElementChild))&&M(/<[/\\w]/g,e.innerHTML)&&M(/<[/\\w]/g,e.textContent))return Et(e),!0;if("select"===o&&M(/<template/i,e.innerHTML))return Et(e),!0;if(7===e.nodeType)return Et(e),!0;if(He&&8===e.nodeType&&M(/<[/\\w]/g,e.data))return Et(e),!0;if(!Ae[o]||je[o]){if(!je[o]&&jt(o)){if(ke.tagNameCheck instanceof RegExp&&M(ke.tagNameCheck,o))return!1;if(ke.tagNameCheck instanceof Function&&ke.tagNameCheck(o))return!1}if(Ke&&!Qe[o]){var n=k(e)||e.parentNode,i=v(e)||e.childNodes;if(i&&n)for(var a=i.length-1;a>=0;--a){var c=_(i[a],!0);c.__removalCount=(e.__removalCount||0)+1,n.insertBefore(c,b(e))}}return Et(e),!0}return e instanceof l&&!St(e)?(Et(e),!0):"noscript"!==o&&"noembed"!==o&&"noframes"!==o||!M(/<\\/no(script|embed|frames)/i,e.innerHTML)?(Fe&&3===e.nodeType&&(t=e.textContent,t=x(t,be," "),t=x(t,ve," "),t=x(t,we," "),e.textContent!==t&&(S(r.removed,{element:e.cloneNode()}),e.textContent=t)),Mt("afterSanitizeElements",e,null),!1):(Et(e),!0)},kt=function(e,t,r){if(Ze&&("id"===t||"name"===t)&&(r in i||r in yt))return!1;if(De&&!Ce[t]&&M(Te,t));else if(Ne&&M(Se,t));else if(!Me[t]||Ce[t]){if(!(jt(e)&&(ke.tagNameCheck instanceof RegExp&&M(ke.tagNameCheck,e)||ke.tagNameCheck instanceof Function&&ke.tagNameCheck(e))&&(ke.attributeNameCheck instanceof RegExp&&M(ke.attributeNameCheck,t)||ke.attributeNameCheck instanceof Function&&ke.attributeNameCheck(t))||"is"===t&&ke.allowCustomizedBuiltInElements&&(ke.tagNameCheck instanceof RegExp&&M(ke.tagNameCheck,r)||ke.tagNameCheck instanceof Function&&ke.tagNameCheck(r))))return!1}else if(ot[t]);else if(M(xe,x(r,Oe,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==A(r,"data:")||!tt[e])if(Ie&&!M(Ee,x(r,Oe,"")));else if(r)return!1;return!0},jt=function(e){return"annotation-xml"!==e&&P(e,Pe)},Ct=function(t){var o,n,i,a;Mt("beforeSanitizeAttributes",t,null);var c=t.attributes;if(c){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Me};for(a=c.length;a--;){var l=o=c[a],u=l.name,f=l.namespaceURI;if(n="value"===u?o.value:R(o.value),i=_e(u),s.attrName=i,s.attrValue=n,s.keepAttr=!0,s.forceKeepAttr=void 0,Mt("uponSanitizeAttribute",t,s),n=s.attrValue,!s.forceKeepAttr&&(Ot(u,t),s.keepAttr))if(Ue||!M(/\\/>/i,n)){Fe&&(n=x(n,be," "),n=x(n,ve," "),n=x(n,we," "));var d=_e(t.nodeName);if(kt(d,i,n))if(!qe||"id"!==i&&"name"!==i||(Ot(u,t),n=Ye+n),He&&M(/((--!?|])>)|<\\/(style|title)/i,n))Ot(u,t);else{if(ce&&"object"===e(h)&&"function"==typeof h.getAttributeType)if(f);else switch(h.getAttributeType(d,i)){case"TrustedHTML":n=ce.createHTML(n);break;case"TrustedScriptURL":n=ce.createScriptURL(n)}try{f?t.setAttributeNS(f,u,n):t.setAttribute(u,n),At(t)?Et(t):T(r.removed)}catch(e){}}}else Ot(u,t)}Mt("afterSanitizeAttributes",t,null)}},Nt=function e(t){var r,o=xt(t);for(Mt("beforeSanitizeShadowDOM",t,null);r=o.nextNode();)Mt("uponSanitizeShadowNode",r,null),Lt(r)||(r.content instanceof a&&e(r.content),Ct(r));Mt("afterSanitizeShadowDOM",t,null)};return r.sanitize=function(n){var i,c,l,u,f,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((lt=!n)&&(n="\\x3c!--\\x3e"),"string"!=typeof n&&!Rt(n)){if("function"!=typeof n.toString)throw L("toString is not a function");if("string"!=typeof(n=n.toString()))throw L("dirty is not a string, aborting")}if(!r.isSupported){if("object"===e(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof n)return t.toStaticHTML(n);if(Rt(n))return t.toStaticHTML(n.outerHTML)}return n}if(Ge||gt(d),r.removed=[],"string"==typeof n&&(Xe=!1),Xe){if(n.nodeName){var p=_e(n.nodeName);if(!Ae[p]||je[p])throw L("root node is forbidden and cannot be sanitized in-place")}}else if(n instanceof s)1===(c=(i=Pt("\\x3c!----\\x3e")).ownerDocument.importNode(n,!0)).nodeType&&"BODY"===c.nodeName||"HTML"===c.nodeName?i=c:i.appendChild(c);else{if(!We&&!Fe&&!$e&&-1===n.indexOf("<"))return ce&&Ve?ce.createHTML(n):n;if(!(i=Pt(n)))return We?null:Ve?se:""}i&&ze&&Et(i.firstChild);for(var m=xt(Xe?n:i);l=m.nextNode();)3===l.nodeType&&l===u||Lt(l)||(l.content instanceof a&&Nt(l.content),Ct(l),u=l);if(u=null,Xe)return n;if(We){if(Be)for(f=de.call(i.ownerDocument);i.firstChild;)f.appendChild(i.firstChild);else f=i;return(Me.shadowroot||Me.shadowrootmod)&&(f=me.call(o,f,!0)),f}var y=$e?i.outerHTML:i.innerHTML;return $e&&Ae["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&M(re,i.ownerDocument.doctype.name)&&(y="<!DOCTYPE "+i.ownerDocument.doctype.name+">\\n"+y),Fe&&(y=x(y,be," "),y=x(y,ve," "),y=x(y,we," ")),ce&&Ve?ce.createHTML(y):y},r.setConfig=function(e){gt(e),Ge=!0},r.clearConfig=function(){mt=null,Ge=!1},r.isValidAttribute=function(e,t,r){mt||gt({});var o=_e(e),n=_e(t);return kt(o,n,r)},r.addHook=function(e,t){"function"==typeof t&&(he[e]=he[e]||[],S(he[e],t))},r.removeHook=function(e){if(he[e])return T(he[e])},r.removeHooks=function(e){he[e]&&(he[e]=[])},r.removeAllHooks=function(){he={}},r}return ae()}()},216:(e,t)=>{"use strict";function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},87:(e,t)=>{"use strict";function r(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const o=r(e),n=r(t);let i=[];for(let e=0;e<=n.length;++e)i[e]=e;for(let e=1;e<=o.length;++e){const t=[e];for(let r=1;r<=n.length;++r)t[r]=o[e-1]===n[r-1]?i[r-1]:1+Math.min(i[r],i[r-1],t[r-1]);i=t}return i[n.length]}},448:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){const r=a(e)?.trim().toLowerCase();if("true"===r)return!0;if("false"===r)return!1;return t},t.getNumberFeatureGate=function(e,t){const r=a(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const o=parseFloat(r);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){const r=a(e)?.trim();if(void 0===r)return t;const o=parseInt(r,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const o=r(87);const n={};function i(){return void 0===globalThis.__get_feature_gate_dictionary_variable?n:globalThis.__get_feature_gate_dictionary_variable()}function a(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return i()[e]??t;const r=i();if(Object.hasOwn(r,e))return r[e]??t;const n=globalThis.__office_online_feature_gates_verbose_log_callback;n(`Failed lookup for FeatureGate ${e}...`);const a=[],c=e.toLowerCase();for(const e of Object.keys(r))(0,o.editDistance)(e.toLowerCase(),c)<=4&&a.push(e);return a.length>0&&n(`Potential candidates found (edit distance <= 4, case-insensitive): [${a.join(", ")}]`),n(`FeatureGate override not found, returning default: ${t}`),t}},400:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=r(533);o.__exportStar(r(448),t),o.__exportStar(r(187),t),o.__exportStar(r(216),t),o.__exportStar(r(340),t),o.__exportStar(r(56),t),o.__exportStar(r(96),t)},187:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,o.getBooleanFeatureGate)(t,r);case"number":return(0,o.getNumberFeatureGate)(t,r);case"string":return(0,o.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}};const o=r(448)},340:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,o.isChangeGateEnabled)(e)};const o=r(216)},56:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=n,t.overrideTypedChangeGates=function(e,t){return n(t)};const o=r(216);function n(e){const t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},96:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=n,t.overrideTypedFeatureGates=function(e,t){return n(t)};const o=r(448);function n(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,o.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,o.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}},268:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuidStringPolicyHTML=t.domPurifyIsValidAttribute=t.createGraphicsEditorTrustedTypesDefaultPolicy=t.createTrustedTypesDefaultPolicy=t.bypassPolicy=t.setRuntimeAllowedOrigins=t.urlOriginPolicy=t.emptyStringPolicyURL=t.emptyStringPolicyHTML=t.domPurifyPolicyHtml=void 0;var o=r(782);Object.defineProperty(t,"domPurifyPolicyHtml",{enumerable:!0,get:function(){return o.domPurifyPolicyHtml}});var n=r(908);Object.defineProperty(t,"emptyStringPolicyHTML",{enumerable:!0,get:function(){return n.emptyStringPolicyHTML}}),Object.defineProperty(t,"emptyStringPolicyURL",{enumerable:!0,get:function(){return n.emptyStringPolicyURL}});var i=r(642);Object.defineProperty(t,"urlOriginPolicy",{enumerable:!0,get:function(){return i.urlOriginPolicy}}),Object.defineProperty(t,"setRuntimeAllowedOrigins",{enumerable:!0,get:function(){return i.setRuntimeAllowedOrigins}});var a=r(460);Object.defineProperty(t,"bypassPolicy",{enumerable:!0,get:function(){return a.bypassPolicy}});var c=r(22);Object.defineProperty(t,"createTrustedTypesDefaultPolicy",{enumerable:!0,get:function(){return c.createTrustedTypesDefaultPolicy}}),Object.defineProperty(t,"createGraphicsEditorTrustedTypesDefaultPolicy",{enumerable:!0,get:function(){return c.createGraphicsEditorTrustedTypesDefaultPolicy}});var s=r(203);Object.defineProperty(t,"domPurifyIsValidAttribute",{enumerable:!0,get:function(){return s.domPurifyIsValidAttribute}});var l=r(380);Object.defineProperty(t,"uuidStringPolicyHTML",{enumerable:!0,get:function(){return l.uuidStringPolicyHTML}})},728:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPolicy=void 0;const r={},o="undefined"!=typeof self&&self.trustedTypes?self.trustedTypes:{createPolicy:(e,t)=>t};t.createPolicy=(e,t,n=o,i)=>{try{r[e]||(r[e]=n.createPolicy(e,{createHTML:t.createHTML,createScript:t.createScript,createScriptURL:t.createScriptURL}))}catch(e){i?.(`${e}`)}return r[e]}},460:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bypassPolicy=t.createBypassPolicy=void 0;const o=r(728);t.createBypassPolicy=(e,t)=>(0,o.createPolicy)(e,{createHTML:e=>e,createScript:e=>e},t),t.bypassPolicy=(0,t.createBypassPolicy)("bypassPolicy")},22:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGraphicsEditorTrustedTypesDefaultPolicy=t.createTrustedTypesDefaultPolicy=t.createDefaultPolicyInternal=void 0;const o=r(400),n=r(728),i=r(203),a=r(642);t.createDefaultPolicyInternal=(e,t)=>{(0,n.createPolicy)("default",{createHTML:(e,r,o)=>{try{if("Element innerHTML"===o&&ee(C,h))return te.has(e)?e:(0,i.sanitizedHTMLAndValidate)(e);if("DOMParser parseFromString"===o&&ee(I,g)||"Element setAttribute"===o&&ee(q,T))return e}catch(e){t?.(`${e}`)}},createScript:(e,r,n)=>{try{if("eval"===n&&ee(F,b))return e;if("HTMLScriptElement text"===n&&ee(K,w)&&(e.startsWith("<math display")||e.startsWith("<math xmlns")))return e;if((0,o.isChangeGateEnabled)("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO:10684524_EnableFuncSinkDefaultTTPolicy")&&"Function"===n&&ee(void 0,S))return e}catch(e){t?.(`${e}`)}},createScriptURL:(e,r,o)=>{try{if("Worker constructor"===o&&ee(X,_)||"HTMLScriptElement src"===o&&ee(Z,v)){const{origin:t}=new URL(e,document.baseURI);if((0,a.isAnAllowedOrigin)(t))return e}}catch(e){t?.(`${e}`)}}},e,t)};t.createTrustedTypesDefaultPolicy=e=>(0,t.createDefaultPolicyInternal)(void 0,e);t.createGraphicsEditorTrustedTypesDefaultPolicy=e=>{try{e.window.trustedTypes?.createPolicy("default",{createHTML:(e,t,r)=>{try{if("Element innerHTML"===r&&ee(A,h))return(0,i.sanitizedHTMLAndValidate)(e)}catch{}}})}catch{}};const c=/https?:\\/\\/[^\\s/$.?#].[^\\s]*/g,s=/\\/officeonline\\/versioned\\/mathjax\\-lowercase\\-patched\\/\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}\\/mathjax\\/\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}\\/(config\\/|jax\\/output\\/html\\-css\\/)?/,l=/\\/(officeonline\\/)?o\\/s\\/h?([0-9a-fA-F])+_app_scripts\\/(wp5\\/)?/,u=/\\/(officeonline\\/)?x\\/s\\/h?([0-9a-fA-F])+__layouts\\/app_scripts\\/((wp5|ac|cc|es6|rslc\\d+|)\\/)?/,f=/\\/1js\\/(build|pr)\\/[0-9a-fA-F]+/,d=/\\/wd1js\\/(ship|debug)\\/(we|wv|x)\\/(_layouts\\/)?app_scripts\\/((wp5|ac|cc|es6|rslc\\d+)\\/)?/,p=/\\/wo\\/webpack\\/((wp5|ac|cc|es6|rslc\\d+)\\/)?/,m=/\\/officeonline\\/pods\\/s\\/(h[0-9a-fA-F]+|\\d+)_(app_scripts|pptscripts)\\/?/,y=new RegExp(`(${/\\/officeonline\\/hashed\\/[0-9a-fA-F]+\\//.source}|${l.source}|${u.source}|${f.source}(${d.source}|${p.source}|/lib-es5/)|${m.source})`),h=/(wordviewerds|meboot|mathjax|jax|mml_htmlormml|common|common50|commonux([0-9a-fA-F\\-]){0,10}|jquery(\\.signalr\\.merge\\.\\d+\\.\\d+\\.min)?|compatparentelementfix|sharedcommentslazy|richtexteditor|copilotcommonux|copilotcomprehensionux|gc2host|appchrome|pptedit(ds)?(\\.debug)?\\.(core\\.common|core1|core2|core3|precore)|(\\@1js\\/oscui\\-compact\\-quill\\@\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}\\/[A-Za-z0-9-]+\\/v\\d{1,10}\\/bundled\\/dist\\/quill\\.custom))\\.(min\\.)?js/,g=/(microsoftajaxds|common|mml_htmlormml|pptedit(ds)?(\\.debug)?\\.(core1|core2|core3|precore|ext-lazy)|officeextensionmerge)(\\.min)?\\.js(\\:|$)/,_=/(wordeditords(eagercompile|separatedialog|\\.debug)?\\.(copilotcommon|common([0-9-])*)|recorder|ewats)(\\.min)?\\.js/,b=/(wordeditords|mathdesigner|microsoftajaxds|pptedit(ds)?(\\.debug)?\\.core3)\\.(min\\.)?js/,v=/(dime|wacboot|officewebsurfaces\\.core|lpplazy|midgardbootstrapper|mathjax|livepersonacard_with-react_[0-9a-fA-F]{1,30}|pptedit(ds)?(\\.debug)?\\.(core1|core2|core3|precore))(\\.min)?\\.js/,w=/(mathjax|wacboot|wordeditords(eagercompile|separatedialog)?(\\.box4\\.dll1)?)(\\.min)?\\.js/,T=/(common|copilotcommonux)\\.(min\\.)?js/,S=/(officebrowserfeedback_floodgate)\\.(min\\.)?js/,E=new RegExp(`(${y.source})(common|common50|commonux([0-9a-fA-F]|\\\\-){0,10}|jquery(\\\\.signalr\\\\.merge\\\\.\\\\d+\\\\.\\\\d+\\\\.min)?|compatparentelementfix|sharedcommentslazy|richtexteditor|appchrome|copilotcommonux|copilotcomprehensionux)\\\\.(min\\\\.)?js`),O=new RegExp(`${s.source}(mathjax|jax|mml_htmlormml)\\\\.js`),P=new RegExp(`${l.source}mathjax/(mathjax)\\\\.js`),x=new RegExp("/scripts/me/mecontrol/\\\\d{1,10}\\\\.\\\\d{1,10}\\\\.\\\\d{1,10}/[a-zA-Z]{1,10}-[a-zA-Z]{1,10}/meboot.min.js"),A=new RegExp(`(/officeonline/versioned/host-word/\\\\d{1,4}\\\\.\\\\d{1,2}\\\\.\\\\d{1,2}/|${m.source}|${f.source}(${d.source}|${p.source}|/lib-es5/))(gc2|gc2host)\\\\.(min\\\\.)?js`),R=new RegExp(`(${u.source}|${f.source}(${d.source}|${p.source}|/lib-es5/))(gc2host)\\\\.(min\\\\.)?js`),M=new RegExp(`(${m.source})(pptedit(ds)?\\\\.precore)\\\\.(min\\\\.)?js`),L=new RegExp(`(${m.source})(pptedit(ds)?\\\\.core\\\\.common)\\\\.(min\\\\.)?js`),k=new RegExp(`(${m.source})(immersivereader)\\\\.(min\\\\.)?js`),j=new RegExp(`(${m.source})(pptedit(ds)?\\\\.(core1|core2|core3))\\\\.(min\\\\.)?js`),C=new RegExp(`(${E.source})|(${O.source})|(${P.source})|(${x.source})|(${A.source})|(${R.source})|(${M.source})|(${L.source})|(${k.source})|(${j.source})`),N=new RegExp(`(${y.source})(microsoftajaxds|common|pptedit(ds)?(.debug)?.(core1|core2|core3|precore|ext-lazy)|officeextensionmerge)\\\\.(min\\\\.)?js(\\\\:|$)`),D=new RegExp(`${s.source}mml_htmlormml.js`),I=new RegExp(`(${N.source})|(${D.source})`),U=new RegExp(`(${u.source}|${f.source}(${d.source}|${p.source}))feedback/officebrowserfeedback_floodgate\\\\.(min\\\\.)?js`),F=new RegExp(`((${y.source})(mathdesigner|microsoftajaxds|pptedit(ds)?(.debug)?.core3)\\\\.(min\\\\.)?js)|(${U.source})`),H=new RegExp("/office-growth/resources/programmablesurfaces/(int|prod)/officewebsurfaces\\\\.core\\\\.(min\\\\.)?js"),$=new RegExp(`(${y.source}(lpplazy|midgardbootstrapper)|(${s.source}mathjax))\\\\.(min\\\\.)?js`),G=new RegExp("/midgard/versionless/livepersonacard_with-react_[0-9a-fA-F]{1,30}\\\\.(min\\\\.)?js"),z=new RegExp("/dime/v1/dime\\\\.js"),W=new RegExp(`(${y.source}(mathjax/mathjax\\\\.js))`),B=new RegExp(`(${y.source}(pptedit(?:ds)?\\\\.(precore|core1|core2|core3|ext-lazy)\\\\.js))`),V=new RegExp("/officeonline/p/s/h?[0-9a-fA-F]+_pptscripts/bootviewds\\\\.js"),Z=new RegExp(`${H.source}|${$.source}|${G.source}|${z.source}|${W.source}|${B.source}|${V.source}`),q=new RegExp(`(${y.source})(common|copilotcommonux)\\\\.(min\\\\.)?js`),Y=new RegExp(`${s.source}mathjax.js`),K=new RegExp(`((${y.source})wordeditords(eagercompile|separatedialog)?(\\\\.box4\\\\.dll1)?\\\\.js)|(${Y.source})`),X=new RegExp(`(${y.source})(wordeditords(eagercompile|separatedialog|\\\\.debug)?\\\\.(copilotcommon|common([0-9-])*)|recorder|ewats)\\\\.(min\\\\.)?js`),J=e=>"https://amcdn.msftauth.net"===e||(0,a.isAnAllowedOrigin)(e),Q=e=>a.localhostRegex.test(e),ee=(e,t)=>{try{throw new Error}catch(r){if(!r.stack)return!1;const o=r.stack.match(c);if(!o?.length)return!1;for(const r of o)try{const{origin:o,pathname:n}=new URL(r);if(!J(o))continue;const i=n.toLowerCase(),a=Q(o)&&t?.test(i),c=e?.test(i);if(c||a)return!0}catch{}return!1}},te=new Set(["","<input/>","<a href=\'#\'></a>","<option></option>","<textarea>x</textarea>","<form></form><form></form>","<a href=\'\' disabled=\'disabled\'></a><select disabled=\'disabled\'><option/></select>","Add-ins","Bold (Ctrl+B)","Border Options","Bullets","Bullets (Ctrl+.)","Catch up","Checklist (Ctrl+,)","Click to see page load statistics","Clipboard","Clear Formatting","Comments","Copy (Ctrl+C)","Copilot","Cut (Ctrl+X)","Decrease Indent (Ctrl+Shift+M)","Designer","Dictate","Dictate (Alt+`)","Editor","Emphasis","Find","Find (Ctrl+F)","Font Color","Font Name","Font Size","Format Painter (Ctrl+Alt+C, Ctrl+Alt+V) <br /> To apply the formatting in multiple places, double-click Format Painter.","Grow Font Size (Ctrl+Shift+>)","Heading 1","Heading 2","Headings and Other Styles","Help Improve Office","Highlight","Increase Indent (Ctrl+M)","Italic (Ctrl+I)","Mode Menu: Editing","More Collaboration Options","More Options","Normal","Numbering","Numbering (Ctrl+/)","Line Spacing","Paragraph Options","Paragraph Shading","Paste","RibbonOptionsTooltip","Saved <br /> Click the cloud icon to view file location","Sensitivity","Separate Pages","Set Proofing Language","Share","Share: this file is shared","Show Developer Tools Menu","Shrink Font Size (Ctrl+Shift+<)","Strikethrough (Ctrl+Shift+X)","Subscript (Ctrl+Shift+-)","Subtitle","Superscript (Ctrl+Shift++)","Switch to light background","Text Alignment","The current page number in the document. Click or tap to open the Navigation Pane.","The number of words in the selection or document. Click or tap to open the word count dialog box.","Title","Underline (Ctrl+U)","Undo","Undo (Ctrl+Z)","Zoom","Zoom In","Zoom Level","Zoom Out","Zoom to fit page width"])},650:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testContent=t.htmlBlockListAttributes=t.htmlBlockList=t.defaultConfig=void 0,t.defaultConfig={ADD_TAGS:["#comment"],RETURN_TRUSTED_TYPE:!1},t.htmlBlockList=["applet","base","basefont","command","embed","frame","frameset","keygen","link","meta","noframes","noscript","object","param","script","title"],t.htmlBlockListAttributes=["contenteditable","contextmenu","controls","data","decoding","defer","dirname","draggable","dropzone","form","formaction","http-equiv","icon","importance","itemprop","keytype","kind","language","lazyload","manifest","minlength","muted","ping","sandbox","scoped","slot","spellcheck","srcdoc","srclang","start","target","translate","wrap","onerror","onclick","onload","onmouseover","onfocus","onblur","src","href"],t.testContent={maliciousHTML:"<div onerror=\\"alert(\'XSS\')\\"></div>",maliciousSVG:\'<svg><circle cx="50" cy="50" r="40" onclick="alert(\\\'XSS\\\')"></circle></svg>\',maliciousMathML:"<math><msup><mi>x</mi><mn>2</mn></msup><div onclick=\\"alert(\'XSS\')\\"></div></math>",sanitizedHTML:"<div></div>",sanitizedSVG:\'<svg><circle r="40" cy="50" cx="50"></circle></svg>\',sanitizedMathML:"<math><msup><mi>x</mi><mn>2</mn></msup></math><div></div>",missingAttrHTML:[\'<div paraid="example"></div>\',\'<div lang="en"></div>\'],missingTagsHTML:[\'<div class="InsertMediaM365Dialog" id="insertmediadialog"> <div class="InsertMediaM365Panel" id="insertmediapanel"> <iframe id="insertmediaframe" class="InsertMediaFrame" name="InsertMediaFrame"></iframe></div></div>\',"\\x3c!-- This is a comment --\\x3e<div>Content</div>"]}},782:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.domPurifyPolicyHtml=t.createDomPurifyPolicyHtml=void 0;const o=r(728),n=r(203);t.createDomPurifyPolicyHtml=(e,t)=>(0,o.createPolicy)(e,{createHTML:(e,t,r)=>(0,n.sanitizedHTMLAndValidate)(e,t,r)},t),t.domPurifyPolicyHtml=(0,t.createDomPurifyPolicyHtml)("domPurifyHTML")},203:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.domPurifyIsValidAttribute=t.sanitizedHTMLAndValidate=void 0;const o=r(533),n=r(399),i=o.__importStar(r(650));t.sanitizedHTMLAndValidate=(e,t,r)=>{let o=!1;const a=t?(e=>({...i.defaultConfig,ALLOW_ARIA_ATTR:!1!==e.ALLOW_ARIA_ATTR,ALLOW_DATA_ATTR:!1!==e.ALLOW_DATA_ATTR,FORCE_BODY:e.FORCE_BODY||!1,IN_PLACE:e.IN_PLACE||!1,SAFE_FOR_TEMPLATES:e.SAFE_FOR_TEMPLATES||!1,SANITIZE_DOM:!1!==e.SANITIZE_DOM,SANITIZE_NAMED_PROPS:e.SANITIZE_NAMED_PROPS||!1,USE_PROFILES:!!e.USE_PROFILES&&e.USE_PROFILES,WHOLE_DOCUMENT:e.WHOLE_DOCUMENT||!1,PARSER_MEDIA_TYPE:e.PARSER_MEDIA_TYPE?e.PARSER_MEDIA_TYPE:"text/html"}))(t):i.defaultConfig;r&&Object.entries(r).forEach((([e,t])=>{(0,n.addHook)(e,t)}));const c=(0,n.sanitize)(e,a);return r&&Object.entries(r).forEach((([e])=>{(0,n.removeHooks)(e)})),t?.USE_PROFILES?c:(o=(e=>{let t=!1,r=!1;const o=new Set,n=new Set;return e.length>0&&(e.forEach((e=>{e.attribute?(r=i.htmlBlockListAttributes.includes(e.attribute.localName)||r,o.add(e.attribute.localName)):e.element&&(r=i.htmlBlockList.includes(e.element.localName)||r,n.add(e.element.localName))})),(o.size>0||n.size>0)&&(r||(t=!0))),t})(n.removed),o?e:c)},t.domPurifyIsValidAttribute=n.isValidAttribute},908:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emptyStringPolicyURL=t.createEmptyStringPolicyURL=t.emptyStringPolicyHTML=t.createEmptyStringPolicyHtml=void 0;const o=r(728);t.createEmptyStringPolicyHtml=(e,t)=>(0,o.createPolicy)(e,{createHTML:e=>""},t),t.emptyStringPolicyHTML=(0,t.createEmptyStringPolicyHtml)("emptyStringPolicyHTML");t.createEmptyStringPolicyURL=(e,t)=>(0,o.createPolicy)(e,{createScriptURL:e=>""},t),t.emptyStringPolicyURL=(0,t.createEmptyStringPolicyURL)("emptyStringPolicyURL")},642:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.urlOriginPolicy=t.createUrlOriginPolicy=t.isAnAllowedOrigin=t.bbRunsRegex=t.localhostRegex=t.setRuntimeAllowedOrigins=void 0;const o=r(728),n=["https://res.cdn.office.net","https://res-sdf.cdn.office.net","https://res-v-sdf.cdn.office.net","https://res-v.cdn.office.net","https://uci.edog.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-h1.cdn.office.net","https://res-1-sdf.cdn.office.net","https://res-2-sdf.cdn.office.net","https://res-1-dev.cdn.officeppe.net","https://res-2-dev.cdn.officeppe.net","https://content.lifecycle.office.net","https://content.lifecycle.officeppe.net","https://res.df.onecdn.static.microsoft","https://res.public.onecdn.static.microsoft","https://res-1.public.onecdn.static.microsoft","https://wordwebclientbuilds.blob.core.windows.net","https://js.live.net","https://c5-onenote-15.cdn.office.net","https://s1-onenote-gcc-15.cdn.office.net","https://ffc-powerpoint.officeapps.live.com","https://ppc-powerpoint.officeapps.live.com","https://powerpoint.officeapps.live.com","https://eurppc-powerpoint.officeapps.live.com","https://ffc-powerpoint.officeapps.live.com","https://fil1-powerpoint.officeapps.live.com","https://fin1-powerpoint.officeapps.live.com","https://fus1-powerpoint.officeapps.live.com","https://gbc-powerpoint.officeapps.live.com","https://jpc-powerpoint.officeapps.live.com","https://usc-powerpoint.officeapps.live.com"].map((e=>e.trim()));let i=[];t.setRuntimeAllowedOrigins=e=>{i=i.concat(e)};const a=[/^https?:\\/\\/([0-9a-zA-Z]+-)?(onenote|word-edit|word-view|excel|visio)\\.officeapps\\.live\\.com$/],c=[/^https?:\\/\\/([\\w-]+-)?(excel)(-[\\w-]+)?\\.cdn\\.office\\.net$/];t.localhostRegex=new RegExp("https?://((localhost|local\\\\.teams\\\\.(office|live)\\\\.com|cpc-[\\\\w-]+|[\\\\w-]+\\\\.[\\\\w-]+\\\\.corp\\\\.microsoft\\\\.com)(:\\\\d+)?)(:|/|$)"),t.bbRunsRegex=new RegExp("^https?://[\\\\w-]+\\\\.pyxidis\\\\.off(:\\\\d+)?$");t.isAnAllowedOrigin=e=>n.includes(e)||i.includes(e)||a.some((t=>t.test(e)))||c.some((t=>t.test(e)))||t.localhostRegex.test(e)||t.bbRunsRegex.test(e);t.createUrlOriginPolicy=(e,r)=>(0,o.createPolicy)(e,{createScriptURL:e=>{let r;try{r=new URL(e,document.baseURI)?.origin}catch(t){r=new URL(e)?.origin}if(r&&(0,t.isAnAllowedOrigin)(r))return e;throw new Error(`TrustedTypes policy does not allow loading URL: ${e} with origin: ${r}`)}},r),t.urlOriginPolicy=(0,t.createUrlOriginPolicy)("urlOriginPolicy")},380:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuidStringPolicyHTML=t.createUUIDStringPolicyHtml=void 0;const o=r(728);t.createUUIDStringPolicyHtml=(e,t)=>(0,o.createPolicy)(e,{createHTML:e=>{if(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e))return e;throw new Error("TrustedTypes policy: The provided value is not a valid UUID and cannot be used to create TrustedHTML")}},t),t.uuidStringPolicyHTML=(0,t.createUUIDStringPolicyHtml)("uuidStringPolicyHTML")},691:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThreadMessageKind=void 0,t.isThreadingSupported=c,t.setConfig=function(e){if(s)throw new TypeError("setConfig has already been called");s=e},t.getSafeParams=function(){const e=s??{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?[...e.importScriptUrls]:void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}},t.getCreateTimeout=function(e){return e?.createTimeout??s?.createTimeout??n},t.getCreateMode=function(e){const t=e?.createMode??s?.createMode??i;return"ThreadOrLocal"===t?c()?"Thread":"Local":t},t.dispatchWorkerError=function(e){try{(s?.onWorkerError??f)(e)}catch(t){console.warn(e),l(t)}},t.dispatchCreateWorker=function(e){try{(s?.onCreateWorker??d)(e)}catch(e){l(e)}};const o=r(739),n=3e5,i="Thread";var a;function c(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}let s;function l(e){setTimeout((()=>{throw e}))}function u(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function f(e){const t=u();if(void 0!==t){const r={kind:a.WorkerError,error:(0,o.encodeResultValue)(e)};t.postMessage(r)}else console.warn(e)}function d(e){const t=u();if(void 0!==t){const r={kind:a.CreateWorker,stats:e};t.postMessage(r)}}!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(a||(t.ThreadMessageKind=a={}))},739:(e,t)=>{"use strict";function r(e){return o(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function o(e){if(null==e)return!1;if(e instanceof Error)return!0;const t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function n(e){return{...e,error:e.error?i(e.error):void 0}}function i(e){return{name:e.name,message:r(e)?e.baseMessage:e.message,stack:e.stack,info:r(e)?n(e.info):void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerError=r,t.isError=o,t.asError=function(e){return o(e)?e:new Error(`(non-Error object) ${function(e){const t=typeof e;switch(t){case"function":case"symbol":case"undefined":return`<${t}>`;case"object":return JSON.stringify(e);default:return`${e}`}}(e)}`)},t.encodeWorkerErrorInfo=n,t.encodeError=i,t.encodeResultValue=function(e){return o(e)?{isError:!0,value:i(e)}:{isError:!1,value:e}}},762:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.importScriptsWithRetry=function(e,t){if(0===t){const t=(0,o.getTrustedScriptUrls)([...e]);return void importScripts(...t)}for(const r of e)i(r,t)};const o=r(481);function n(e,t,r){const o=e.indexOf("?");if(o<0)return`${e}?${t}=${r}`;const n=e.slice(0,o+1),i=e.slice(o+1).split("&");let a=0;for(;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]=`${t}=${r}`,n+i.join("&")}function i(e,t){let r;for(let i=0;i<=t;i+=1)try{const t=i>0?n(e,"retries",String(i)):e,r=(0,o.getTrustedUrl)(t);return void importScripts(r)}catch(e){r=e}throw r}},619:(e,t)=>{"use strict";function r(e){throw new ReferenceError(`${e} is not defined`)}Object.defineProperty(t,"__esModule",{value:!0}),t.paramInsideDef=void 0,t.indexObject=function(e,t,o=r){try{const r=t.split(".");for(const t of r)e=e[t];return e??o(t)}catch{return o(t)}},t.paramInsideDef=(e,...r)=>t.paramInsideDef.transfer(e,void 0,...r),t.paramInsideDef.transfer=(e,t,...r)=>({def:e,args:r,transferables:t??[]})},506:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startStopwatch=function(){return{status:"Pending",start:n()}},t.stopStopwatch=i,t.timePromise=function(e,t){function r(t){throw i(e,(0,o.isWorkerError)(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((t=>i(e,"Success")??t),r)}catch(e){r(e)}},t.createWorkerStats=function(e){const{id:t,createMode:r,createWorker:o,insideInit:n,createOutside:i,createThread:c}=e,{status:l,start:u,end:f}=o;if("Pending"===l||void 0===f)return;return{id:t,createMode:r,createWorker:{status:l,absStart:u,duration:a(f-u)},createThread:"Thread"===r?s(c,u,f):void 0,createOutside:s(i,u,f),insideInit:s(n,u,f)}};const o=r(739),n="undefined"!=typeof performance&&void 0!==performance.timeOrigin?()=>performance.now()+performance.timeOrigin:()=>Date.now();function i(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,r??n()))}function a(e){return Math.round(1e3*e)/1e3}function c(e,t,r){return e<t?t:e>r?r:e}function s(e,t,r){const o=c(e?.start??1/0,t,r),n=c(e?.end??1/0,t,r);return{status:e?.status??"Pending",start:a(o-t),end:a(n-t),duration:a(n-o)}}},481:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setUpTrustedTypesConfig=function(e){n=e??!1,i=n?o.urlOriginPolicy:void 0},t.getTrustedUrl=a,t.getTrustedScriptUrls=function(e){if(!n||!i)return e;return e.map(a)};const o=r(268);let n,i;function a(e){if(n&&i)try{return i.createScriptURL(e)}catch{return e}return e}},533:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>C,__assign:()=>i,__asyncDelegator:()=>O,__asyncGenerator:()=>E,__asyncValues:()=>P,__await:()=>S,__awaiter:()=>m,__classPrivateFieldGet:()=>L,__classPrivateFieldIn:()=>j,__classPrivateFieldSet:()=>k,__createBinding:()=>h,__decorate:()=>c,__disposeResources:()=>D,__esDecorate:()=>l,__exportStar:()=>g,__extends:()=>n,__generator:()=>y,__importDefault:()=>M,__importStar:()=>R,__makeTemplateObject:()=>x,__metadata:()=>p,__param:()=>s,__propKey:()=>f,__read:()=>b,__rest:()=>a,__runInitializers:()=>u,__setFunctionName:()=>d,__spread:()=>v,__spreadArray:()=>T,__spreadArrays:()=>w,__values:()=>_,default:()=>I});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},i.apply(this,arguments)};function a(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}function c(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function s(e,t){return function(r,o){t(r,o,e)}}function l(e,t,r,o,n,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var c,s=o.kind,l="getter"===s?"get":"setter"===s?"set":"value",u=!t&&e?o.static?e:e.prototype:null,f=t||(u?Object.getOwnPropertyDescriptor(u,o.name):{}),d=!1,p=r.length-1;p>=0;p--){var m={};for(var y in o)m[y]="access"===y?{}:o[y];for(var y in o.access)m.access[y]=o.access[y];m.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var h=(0,r[p])("accessor"===s?{get:f.get,set:f.set}:f[l],m);if("accessor"===s){if(void 0===h)continue;if(null===h||"object"!=typeof h)throw new TypeError("Object expected");(c=a(h.get))&&(f.get=c),(c=a(h.set))&&(f.set=c),(c=a(h.init))&&n.unshift(c)}else(c=a(h))&&("field"===s?n.unshift(c):f[l]=c)}u&&Object.defineProperty(u,o.name,f),d=!0}function u(e,t,r){for(var o=arguments.length>2,n=0;n<t.length;n++)r=o?t[n].call(e,r):t[n].call(e);return o?r:void 0}function f(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function m(e,t,r,o){return new(r||(r=Promise))((function(n,i){function a(e){try{s(o.next(e))}catch(e){i(e)}}function c(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,c)}s((o=o.apply(e,t||[])).next())}))}function y(e,t){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(r=1,o&&(n=2&c[0]?o.return:c[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,c[1])).done)return n;switch(o=0,n&&(c=[2&c[0],n.value]),c[0]){case 0:case 1:n=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,o=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!n||c[1]>n[0]&&c[1]<n[3])){a.label=c[1];break}if(6===c[0]&&a.label<n[1]){a.label=n[1],n=c;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(c);break}n[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],o=0}finally{r=n=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}var h=Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]};function g(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||h(t,e,r)}function _(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,n++)o[n]=i[a];return o}function T(e,t,r){if(r||2===arguments.length)for(var o,n=0,i=t.length;n<i;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function E(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=r.apply(e,t||[]),i=[];return o={},a("next"),a("throw"),a("return"),o[Symbol.asyncIterator]=function(){return this},o;function a(e){n[e]&&(o[e]=function(t){return new Promise((function(r,o){i.push([e,t,r,o])>1||c(e,t)}))})}function c(e,t){try{(r=n[e](t)).value instanceof S?Promise.resolve(r.value.v).then(s,l):u(i[0][2],r)}catch(e){u(i[0][3],e)}var r}function s(e){c("next",e)}function l(e){c("throw",e)}function u(e,t){e(t),i.shift(),i.length&&c(i[0][0],i[0][1])}}function O(e){var t,r;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,n){t[o]=e[o]?function(t){return(r=!r)?{value:S(e[o](t)),done:!1}:n?n(t):t}:n}}function P(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=_(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(r){t[r]=e[r]&&function(t){return new Promise((function(o,n){(function(e,t,r,o){Promise.resolve(o).then((function(t){e({value:t,done:r})}),t)})(o,n,(t=e[r](t)).done,t.value)}))}}}function x(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var A=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function R(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&h(t,e,r);return A(t,e),t}function M(e){return e&&e.__esModule?e:{default:e}}function L(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)}function k(e,t,r,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r}function j(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function C(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var o;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");o=t[Symbol.asyncDispose]}if(void 0===o){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");o=t[Symbol.dispose]}if("function"!=typeof o)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:o,async:r})}else r&&e.stack.push({async:!0});return t}var N="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var o=new Error(r);return o.name="SuppressedError",o.error=e,o.suppressed=t,o};function D(e){function t(t){e.error=e.hasError?new N(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var o=e.stack.pop();try{var n=o.dispose&&o.dispose.call(o.value);if(o.async)return Promise.resolve(n).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const I={__extends:n,__assign:i,__rest:a,__decorate:c,__param:s,__metadata:p,__awaiter:m,__generator:y,__createBinding:h,__exportStar:g,__values:_,__read:b,__spread:v,__spreadArrays:w,__spreadArray:T,__await:S,__asyncGenerator:E,__asyncDelegator:O,__asyncValues:P,__makeTemplateObject:x,__importStar:R,__importDefault:M,__classPrivateFieldGet:L,__classPrivateFieldSet:k,__classPrivateFieldIn:j,__addDisposableResource:C,__disposeResources:D}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,r),i.exports}r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};(()=>{"use strict";var e=o;Object.defineProperty(e,"__esModule",{value:!0});const t=r(400),n=r(691),i=r(739),a=r(762),c=r(619),s=r(506),l=r(481);self.onmessage=({data:{config:e,port:r,options:o,script:u,args:f,featureGateDictionary:d,changeGateDictionary:p}})=>{self.onmessage=null,self.__typed_workers_thread=!0,(0,l.setUpTrustedTypesConfig)(o.isTrustedTypesPolicyEnabled),(0,t.setFeatureGateDictionaryGetter)((()=>d)),(0,t.setChangeGateDictionaryGetter)((()=>p));const m=o.importScriptsMaxRetries??e.importScriptsMaxRetries??0;let y;function h(){if(y)return y;if(void 0===e.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return(0,a.importScriptsWithRetry)([e.typedWorkersUrl],m),y=(0,c.indexObject)(self,e.typedWorkersName??"typedWorkers"),y.setConfig(e),y}const g=(0,s.startStopwatch)();function _(e,t){const r=e?void 0:(0,i.encodeResultValue)((0,i.asError)(t)),o={kind:n.ThreadMessageKind.InitResult,error:r,stopwatch:g};self.postMessage(o),e||setTimeout(self.close.bind(self),6e4)}try{(0,s.timePromise)(g,(()=>{(0,a.importScriptsWithRetry)([...o?.importScriptUrls??e.importScriptUrls??[],...void 0!==u.scriptUrl?[u.scriptUrl]:[]],m);return(0,c.indexObject)(self,u.insideInitName)({config:e,importTypedWorkers:h,connection:{port:r,options:o,createMode:"Thread"}},...f)})).then((()=>_(!0)),(e=>_(!1,e)))}catch(e){_(!1,e)}}})(),threadBootstrap=o})();})()'},1820:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setUpTrustedTypesConfig=function(e){a=e??!1,i=a?o.urlOriginPolicy:void 0},t.getTrustedUrl=n,t.getTrustedScriptUrls=function(e){return a&&i?e.map(n):e};const o=r(2438);let a,i;function n(e){if(a&&i)try{return i.createScriptURL(e)}catch{return e}return e}},4112:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.knownErrorClasses=t.WorkerError=void 0,t.getErrorEventWorkerError=function(e,t,r){if((0,o.isError)(r.error)){if((0,o.isWorkerError)(r.error))return r.error;const i={cause:"UnhandledError",idInfo:e,error:r.error};return new a(`${t} received an unhandled error`,i)}if(null==r.message)return new a(`${t} received a non-error (worker script fetch probably failed)`,{cause:"UnhandledError",idInfo:e});const i={cause:"UnhandledError",idInfo:e},n=`${r.message} at ${r.filename}:${r.lineno}:${r.colno}`;return new a(`${t} received an unhandled error: ${n}`,i)},t.decodeError=i,t.decodeWorkerErrorInfo=n,t.decodeResultValue=function(e){return e.isError?i(e.value):e.value};const o=r(2406);class a extends Error{constructor(e,t){super(`${e}; info = ${JSON.stringify({...t,error:t.error?.message})}`),this.baseMessage=e,this.info=t,this.name="WorkerError"}}function i(e){let r;if("WorkerError"===e.name)r=new a(e.message,n(e.info));else{const o=t.knownErrorClasses[e.name];o?r=new o(e.message):(r=new Error(e.message),r.name=e.name)}return null!=e.stack&&(r.stack=e.stack),r}function n(e){return{...e,error:e.error?i(e.error):void 0}}t.WorkerError=a,a.isWorkerError=o.isWorkerError,t.knownErrorClasses={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError}},4153:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerThread=function(){return"undefined"!=typeof WorkerGlobalScope},t.workerName=function(){return"undefined"==typeof self?void 0:self.name}},6533:function(e,t,r){"use strict";r.r(t),r.d(t,{__addDisposableResource:function(){return W},__assign:function(){return i},__asyncDelegator:function(){return P},__asyncGenerator:function(){return v},__asyncValues:function(){return T},__await:function(){return _},__awaiter:function(){return f},__classPrivateFieldGet:function(){return k},__classPrivateFieldIn:function(){return D},__classPrivateFieldSet:function(){return L},__createBinding:function(){return g},__decorate:function(){return s},__disposeResources:function(){return $},__esDecorate:function(){return l},__exportStar:function(){return y},__extends:function(){return a},__generator:function(){return h},__importDefault:function(){return x},__importStar:function(){return M},__makeTemplateObject:function(){return I},__metadata:function(){return m},__param:function(){return c},__propKey:function(){return p},__read:function(){return b},__rest:function(){return n},__runInitializers:function(){return d},__setFunctionName:function(){return u},__spread:function(){return C},__spreadArray:function(){return w},__spreadArrays:function(){return E},__values:function(){return S},default:function(){return R}});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},i.apply(this,arguments)};function n(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(r[o[a]]=e[o[a]])}return r}function s(e,t,r,o){var a,i=arguments.length,n=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(n=(i<3?a(n):i>3?a(t,r,n):a(t,r))||n);return i>3&&n&&Object.defineProperty(t,r,n),n}function c(e,t){return function(r,o){t(r,o,e)}}function l(e,t,r,o,a,i){function n(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,c=o.kind,l="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?o.static?e:e.prototype:null,p=t||(d?Object.getOwnPropertyDescriptor(d,o.name):{}),u=!1,m=r.length-1;m>=0;m--){var f={};for(var h in o)f[h]="access"===h?{}:o[h];for(var h in o.access)f.access[h]=o.access[h];f.addInitializer=function(e){if(u)throw new TypeError("Cannot add initializers after decoration has completed");i.push(n(e||null))};var g=(0,r[m])("accessor"===c?{get:p.get,set:p.set}:p[l],f);if("accessor"===c){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(s=n(g.get))&&(p.get=s),(s=n(g.set))&&(p.set=s),(s=n(g.init))&&a.unshift(s)}else(s=n(g))&&("field"===c?a.unshift(s):p[l]=s)}d&&Object.defineProperty(d,o.name,p),u=!0}function d(e,t,r){for(var o=arguments.length>2,a=0;a<t.length;a++)r=o?t[a].call(e,r):t[a].call(e);return o?r:void 0}function p(e){return"symbol"==typeof e?e:"".concat(e)}function u(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,o){return new(r||(r=Promise))((function(a,i){function n(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,s)}c((o=o.apply(e,t||[])).next())}))}function h(e,t){var r,o,a,i,n={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(n=0)),n;)try{if(r=1,o&&(a=2&s[0]?o.return:s[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,s[1])).done)return a;switch(o=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,o=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if(!((a=(a=n.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){n=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){n.label=s[1];break}if(6===s[0]&&n.label<a[1]){n.label=a[1],a=s;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(s);break}a[2]&&n.ops.pop(),n.trys.pop();continue}s=t.call(e,n)}catch(e){s=[6,e],o=0}finally{r=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var g=Object.create?function(e,t,r,o){void 0===o&&(o=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,a)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]};function y(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function S(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,a,i=r.call(e),n=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)n.push(o.value)}catch(e){a={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return n}function C(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function E(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],n=0,s=i.length;n<s;n++,a++)o[a]=i[n];return o}function w(e,t,r){if(r||2===arguments.length)for(var o,a=0,i=t.length;a<i;a++)!o&&a in t||(o||(o=Array.prototype.slice.call(t,0,a)),o[a]=t[a]);return e.concat(o||Array.prototype.slice.call(t))}function _(e){return this instanceof _?(this.v=e,this):new _(e)}function v(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,a=r.apply(e,t||[]),i=[];return o={},n("next"),n("throw"),n("return"),o[Symbol.asyncIterator]=function(){return this},o;function n(e){a[e]&&(o[e]=function(t){return new Promise((function(r,o){i.push([e,t,r,o])>1||s(e,t)}))})}function s(e,t){try{(r=a[e](t)).value instanceof _?Promise.resolve(r.value.v).then(c,l):d(i[0][2],r)}catch(e){d(i[0][3],e)}var r}function c(e){s("next",e)}function l(e){s("throw",e)}function d(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function P(e){var t,r;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,a){t[o]=e[o]?function(t){return(r=!r)?{value:_(e[o](t)),done:!1}:a?a(t):t}:a}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=S(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(r){t[r]=e[r]&&function(t){return new Promise((function(o,a){!function(e,t,r,o){Promise.resolve(o).then((function(t){e({value:t,done:r})}),t)}(o,a,(t=e[r](t)).done,t.value)}))}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var A=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function M(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return A(t,e),t}function x(e){return e&&e.__esModule?e:{default:e}}function k(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)}function L(e,t,r,o,a){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?a.call(e,r):a?a.value=r:t.set(e,r),r}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function W(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var o;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");o=t[Symbol.asyncDispose]}if(void 0===o){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");o=t[Symbol.dispose]}if("function"!=typeof o)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:o,async:r})}else r&&e.stack.push({async:!0});return t}var O="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var o=new Error(r);return o.name="SuppressedError",o.error=e,o.suppressed=t,o};function $(e){function t(t){e.error=e.hasError?new O(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var o=e.stack.pop();try{var a=o.dispose&&o.dispose.call(o.value);if(o.async)return Promise.resolve(a).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const R={__extends:a,__assign:i,__rest:n,__decorate:s,__param:c,__metadata:m,__awaiter:f,__generator:h,__createBinding:g,__exportStar:y,__values:S,__read:b,__spread:C,__spreadArrays:E,__spreadArray:w,__await:_,__asyncGenerator:v,__asyncDelegator:P,__asyncValues:T,__makeTemplateObject:I,__importStar:M,__importDefault:x,__classPrivateFieldGet:k,__classPrivateFieldSet:L,__classPrivateFieldIn:D,__addDisposableResource:W,__disposeResources:$}}},t={};function r(o){var a=t[o];if(void 0!==a)return a.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,r),i.exports}r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};!function(){"use strict";let e,t;function a(t,r){return e&&e[t]?e[t]:r}r.r(o),r.d(o,{Base64Image:function(){return ba},ClipboardData:function(){return ya},ClipboardManager:function(){return Ia},ImageDimension:function(){return Ca},PackageCopyError:function(){return la},PackagePasteError:function(){return ca},PasteSessionInfo:function(){return da},SvgData:function(){return Sa},testCopy:function(){return Wa},testPaste:function(){return Oa}});const i=(e,t=!1)=>t;var n=r(6521);let s;function c(){return s}function l(e){if(!e)throw new Error("The 'logger' argument is missing");s=n.Hv.getFromExternalLogger(e)}const d="",p=".",u="1";var m,f,h,g,y,S;function b(e,t){return C(e,[t])}function C(e,t){if(!function(e){if(!e||"object"!=typeof e||!("reason"in e))return!1;return!!function(e){if(!e&&0!==e)return!1;const t=Number(e);return!isNaN(t)&&t.toString()===e.toString()}(e.reason)}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;const r=e.reason;return t.indexOf(r)>=0}function E(e){if(e&&"object"==typeof e){if(w(e.reason))return!0;if(e.innerError&&"string"==typeof e.innerError)try{if(w(JSON.parse(e.innerError).reason))return!0}catch{}}if("string"==typeof e)try{if(w(JSON.parse(e).reason))return!0}catch{}return!1}function w(e){return e===h.LocalStorageInitilizationInaccessible}(f=m||(m={}))[f.SystemClipboard=0]="SystemClipboard",f[f.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",f[f.InMemory=4]="InMemory",f[f.LocalStorage=5]="LocalStorage",f[f.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",f[f.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory",f[f.AsyncSystemClipboard=8]="AsyncSystemClipboard",f[f.AsyncSystemClipboardAndLocalStorage=9]="AsyncSystemClipboardAndLocalStorage",f[f.AsyncSystemClipboardAndInMemory=10]="AsyncSystemClipboardAndInMemory",function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage",e[e.AsyncClipboardReadFailure=44]="AsyncClipboardReadFailure",e[e.AsyncClipboardWriteFailure=45]="AsyncClipboardWriteFailure"}(h||(h={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(g||(g={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext",e[e.FailedToReadFromAsyncClipboard=16]="FailedToReadFromAsyncClipboard"}(y||(y={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(S||(S={}));class _ extends Error{static augmentParameterValue(e){return e&&"string"==typeof e?e.trim():d}constructor(e,t,r){const o=_.augmentParameterValue(e);if(super(o),this.name=_.augmentParameterValue(t),this.errorName=this.name,this.name?c().ULS.traceTag(596456211,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Error '${this.name}': ${o}`):c().ULS.traceTag(596456212,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Error message: ${o}`),r){this.innerError=r;let e=this.innerError.message;e||(e=this.innerError.name);const t=_.augmentParameterValue(e);t.length>0&&c().ULS.traceTag(596456213,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Inner error message: ${t}`)}this.stack||(this.stack=(new Error).stack)}}class v extends _{constructor(e,t){super(e,"NoValidKeyError",t)}}class P extends _{static getDefaultMessage(e){let t="Missing argument";return e.length>0&&(t=`Missing argument: '${e}'`),t}constructor(e,t,r){const o=_.augmentParameterValue(t),a=P.getDefaultMessage(o);let i=_.augmentParameterValue(e);0===i.length&&(i=a),super(i,"MissingArgumentError",r),this.name=o}}class T extends _{static getDefaultMessage(e,t){return e.length>0?`Invalid '${e}' argument: '${t}'`:"Invalid argument"}constructor(e,t,r,o){const a=_.augmentParameterValue(t);let i=r;i||(i=d);const n=T.getDefaultMessage(a,i);let s=_.augmentParameterValue(e);0===e.length&&(s=n),super(s,"InvalidArgumentError",o),this.name=a,this.value=i}}class I extends _{constructor(e,t){super(e,"InvalidOperationError",t)}}class A extends _{constructor(e,t,r,o,a){super(`${e}. Data version: ${t}, Infra version: ${r}, blockMismatchDataVersion: ${o}`,"MismatchVersionError",a)}}class M extends _{constructor(e,t,r,o){super(`${e}. Duration in clipboard (ms) : ${t}, TTL (ms): ${r}`,"TTLClipboardDataError",o)}}class x extends _{constructor(e,t,r,o){super(`${e}. Data User Hash : ${t}, infra User Hash: ${r}`,"UserHashMismatchError",o)}}class k extends _{constructor(e,t){super(e,"UnexpectedError",t)}}function L(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:d}class D extends _{constructor(e,t,r,o,a){super(t||`reason=${e}`,r,o),this.reason=e,a&&(this.errorName=a)}}class W extends D{constructor(e,t,r){super(e,t,"CopyError",r,L(e,g))}}class O extends D{constructor(e,t,r){super(e,t,"PasteError",r,L(e,y))}}class $ extends D{constructor(e,t,r){super(e,t,"CancelError",r,L(e,S))}}class R extends D{constructor(e,t,r){super(e,t,"ClipboardPlatformError",r,L(e,h))}}function F(e){if(!e||!Array.isArray(e)||0===e.length)return void c().ULS.traceTag(596456214,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,"rethrowAfterAllActions: no actions to execute");let t,r=0;if(e.forEach((e=>{if(r+=1,e)try{e()}catch(e){c().ULS.traceTag(596456216,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`rethrowAfterAllActions: callback action #${r} threw an exception: ${e.message}`),t||(t=new I(e.message,e))}else c().ULS.traceTag(596456215,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`rethrowAfterAllActions: callback action #${r} is empty`)})),t)throw t}function U(){return j}const j={userAgent:()=>window&&window.navigator?window.navigator.userAgent:d,appVersion:()=>window&&window.navigator?window.navigator.appVersion:d};let N={};const z=new RegExp("(\\bTrident/| MSIE )"),H=16.16299,J=17.17123,B=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function V(){if(void 0===N.isIEProperty){N.isIEProperty=!1;const e=U();if(e&&e.userAgent&&"function"==typeof e.userAgent){const t=e.userAgent();if(t){const e=t.match(z);e&&2===e.length&&(N.isIEProperty=!0)}}}return N.isIEProperty}function G(){if(void 0===N.isEdgeProperty){N.isEdgeProperty=!1,N.isEdgeWithTextHtmlClipboardSupportProperty=!1,N.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;const e=U();if(e&&e.appVersion&&"function"==typeof e.appVersion){const t=e.appVersion();if(t){const e=t.match(B);if(e&&2===e.length){N.isEdgeProperty=!0;const t=Number(e[1]);isNaN(t)||(t>=H&&(N.isEdgeWithTextHtmlClipboardSupportProperty=!0),t>=J&&(N.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return N.isEdgeProperty}const K=(e,t,r,o)=>{e.postMessage(t,r,o)},Z="copy",q="cut",X="paste",Y="copy",Q="paste",ee=(e,t,r,o)=>{const a=o||!1;return e.addEventListener(t,r,a),()=>{e.removeEventListener(t,r,a)}},te="text/plain",re="Text",oe="text/html",ae="image/png",ie="metadata/is-last-copy-was-external",ne="metadata/ccp-infra-version",se="copyId",ce="metadata/copy-context",le=function(){const e={items:{}};return{getData:()=>e,getItem:e=>{},setItem:(e,t)=>{throw new I(`Cannot set an item with clipboard data format '${e}' in an immutable empty clipboard (content is ${t&&t.length>0?"not ":d}empty)`)},setDeferredItem:(e,t)=>{throw new I(`Cannot set a deferred item with clipboard data format '${e}' in an immutable empty clipboard`)},hasDeferredItem:e=>!1,getDeferredItem:e=>{},get:()=>be(void 0)}}();function de(){return le}function pe(e){return e&&e.items?Object.keys(e.items).length:0}function ue(e){return pe(e&&e.getData())}function me(e=void 0){let t=e;t||(t={items:{}});const r={getItem:e=>fe(t,e),setItem:(e,r)=>{he(t,e,r)},setDeferredItem:(e,r)=>{he(t,e,r)},hasDeferredItem:e=>{if(!t||!t.items)return!1;const r=t.items[e];return!!r&&r instanceof Promise},getDeferredItem:e=>function(e,t){if(!e)throw new P(d,"clipboardItemsData");if(!e.items)throw new T(d,"clipboardItemsData.items");const r=e.items[t];return!r||r instanceof Promise?r:Promise.resolve(new Blob([r],{type:te}))}(t,e),getData:()=>t,get:()=>be(t)};return r}function fe(e,t){if(!e)throw new P(d,"clipboardItemsData");if(!e.items)throw new T(d,"clipboardItemsData.items");const r=e.items[t];if(!(r&&r instanceof Promise))return r}function he(e,t,r){if(!e)throw new P(d,"clipboardItemsData");if(!e.items)throw new T(d,"clipboardItemsData.items");e.items[t]=r}function ge(e,t){if(!e||0===e.length||!t||!t.trim())return d;let r;return e.forEach((e=>{e.clipboardDataFormat!==t||e.deferred||(r=e.data)})),r||d}function ye(e){return ge(e,te)}function Se(e){let t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:te,data:d}),t}function be(e){const t=[];if(0===pe(e))return t;for(const r in e.items){let o=e.items[r];o||(o=d);const a={clipboardDataFormat:r,data:o,deferred:o instanceof Promise};t.push(a)}return t}var Ce,Ee,we,_e;(Ee=Ce||(Ce={}))[Ee.SystemClipboard=0]="SystemClipboard",Ee[Ee.InMemory=2]="InMemory",Ee[Ee.LocalStorage=3]="LocalStorage",Ee[Ee.AsyncSystemClipboard=4]="AsyncSystemClipboard",function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PictureInCell=2048]="PictureInCell",e[e.ColumnWidths=4096]="ColumnWidths",e[e.Copilot=8192]="Copilot",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink",e[e.PastePictureInCell=2052]="PastePictureInCell",e[e.PasteWithColumnWidths=4100]="PasteWithColumnWidths",e[e.PasteWithCopilot=8196]="PasteWithCopilot"}(we||(we={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(_e||(_e={}));const ve="BulsEndpointUrl",Pe="usid",Te="-",Ie=1,Ae=3600,Me=2;let xe=De(),ke=!1;function Le(){if(!ke)throw new I("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return xe}function De(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:d,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:Ie,sharedClipboardExpirationInMinutes:Ae,clipboardPromiseTimeoutInMinutes:Me,remoteLoggerPath:d}}function We(){let e=d;return window&&window.location&&window.location.origin?(e=window.location.origin,e||(e=d)):(c().ULS.traceTag(595932950,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`windowLocation.getWindowLocation: is window exist: ${!!window}. is window.location exist: ${window&&!!window.location}. is window.location.origin exist ${window&&window.location&&!!window.location.origin}. is window.location.protocol exist ${window&&window.location&&!!window.location.protocol}. is window.location.hostname exist ${window&&window.location&&!!window.location.hostname}. is window.location.port exist ${window&&window.location&&!!window.location.port}`),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}const Oe="://",$e="http",Re="https",Fe=".",Ue="/",je=":",Ne=new RegExp("^\\d+$");let ze,He,Je=!1;function Be(e){if(!e)throw new P(d,"origin");const t=e.trim().toLowerCase();let r=d,o=t.split(Oe,3);if(!o||0===o.length||!o[0]||o[0]!==$e&&o[0]!==Re)throw new T("Missing protocol","origin",e);if(1===o.length)throw new T("Missing domain","origin",e);if(o.length>2)throw new T(`'${Oe}' should appear once`,"origin",e);let a=o[1];if(!a)throw new T("Missing domain","origin",e);if(r=o[0]+Oe,a=a.trim(),o=a.trim().split(Ue,3),!o||0===o.length||!o[0]||!o[0].trim())throw new T("Missing domain","origin",e);if(o.length>2)throw new T("The last part of the origin should be the domain","origin",e);if(2===o.length&&o[1])throw new T("The last part of the origin should be the domain","origin",e);if(o=a.split(je,3),!o||0===o.length||!o[0]||!o[0].trim())throw new T("Missing domain","origin",e);if(o.length>2||2===o.length&&(!o[1]||!o[1].trim()))throw new T("The last part of the origin should be the domain and an optional port number","origin",e);if(a=o[0].trim(),r+=a,2===o.length){const t=o[1].trim(),a=Ne.exec(t);if(!a||1!==a.length)throw new T("Invalid port number","origin",e);const i=Number(t);if(isNaN(i))throw new T("Invalid port number","origin",e);r+=je+t}return c().ULS.traceTag(596452423,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`getValidatedOrigin: origin = '${e}'; validated origin = '${r}'`),r}function Ve(e){Ze();const t=e.split(Oe,2),r=t[0],o=Ge(t[1]),a={protocol:r};if(a.environment=Ke(e,o,He),o.length<=a.environment.length+1)throw new T("Missing app component","origin",e);if(o.charAt(a.environment.length)!==Fe)throw new T("Missing a domain separator after the environment component","origin",e);const i=o.substr(a.environment.length+Fe.length);if(a.app=Ke(e,i,ze),a.app.length<i.length&&i.charAt(a.app.length)!==Te)throw new T(`When the Office Online app name is not the domain prefix, '${Te}' should precede it`,"origin",e);return a}function Ge(e){if(!e)throw new P(d,"stringToReverse");const t=e.length;let r=d;for(let o=t-1;o>=0;o-=1)r+=e.charAt(o);return r}function Ke(e,t,r){if(!t)throw new P(d,"reversedValidatedHostname");if(!r)throw new P(d,"reversedStringsToLengthMap");const o=t.length,a=Object.keys(r).filter((e=>{const a=r[e];return a<=o&&t.substr(0,a)===e}));if(a&&a.length>0)return Ge(a[0]);throw new T("Invalid origin","validatedOrigin",e)}function Ze(){if(Je)return;const e=Le();e.whitelistOriginComponents&&(ze=qe(e.sharedClipboardHostingApps),He=qe(e.sharedClipboardHostingEnvironments),Je=!0)}function qe(e){const t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((e=>{t[Ge(e)]=e.length})),t):t}function Xe(){return Qe()}function Ye(e){if(!e)throw new P(d,"id");const t=e.trim().toLowerCase();if(0===t.length)throw new T(d,"id");return t}function Qe(){return(Math.random()+1).toString(36).substring(7)}function et(e,t,r,o,a){const i={id:e,operationCode:t,destination:r,userHash:o,clipboardItemsData:a};return rt(i),i}class tt{}tt.localStorageData="localStorage/data",tt.localStorageMetadata="localStorage/metadata",tt.initIframe="initIframe";const rt=function(e){if(!e)throw new P(d,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new P(d,"id");if(!e.operationCode)throw new P(d,"operationCode");if(!e.destination)throw new P(d,"destination");if("get"!==(t=e.operationCode)&&"set"!==t&&"init"!==t)throw new T(d,"operationCode",e.operationCode);var t;if("set"!==e.operationCode&&e.clipboardItemsData)throw new T(`'${e.operationCode}' expects no clipboard items`,"clipboardItemsData")};function ot(e,t,r,o,a){const i={id:e,operationCode:t,failed:r,error:o,clipboardItemsData:a};return at(i),i}const at=function(e){if(!e)throw new P(d,"clipboardOperationResultMessage");const t=["failed","error","clipboardItemsData","operationCode","id","userHash"];let r=!1;for(const o of t)if(e.hasOwnProperty(o)){r=!0;break}if(!r)throw new v("clipboardOperationResultMessage has no valid key");if(!e.id||0===e.id.trim().length)throw c().ULS.traceTag(553747865,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`Missing argument 'id'. keys: ${JSON.stringify(Object.keys(e))}, isConstructorObject: ${e.constructor===Object}, operationCode: ${e.operationCode}, id: ${e.id}, failed: ${e.failed}, error: ${e.error}.`),new P(d,"id");if(!e.operationCode)throw new P(d,"operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new T(d,"operationCode",e.operationCode);if(e.failed){if(!e.error)throw new T(`A failed '${e.operationCode}' operation expects a non-empty error argument`,"error");if(e.clipboardItemsData)throw new T(`A failed '${e.operationCode}' operation does not expect a clipboardItemsData argument`,"clipboardItemsData")}else{if(e.error)throw new T(`'${e.operationCode}' expects an empty error argument`,"error");if("unknownresult"===e.operationCode)throw new T(`'${e.operationCode}' can only be used with a failure message`,"operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new T(`'${e.operationCode}' expects a clipboardItems argument`,"clipboardItemsData")}else if(e.clipboardItemsData)throw new T(`'${e.operationCode}' expects no clipboardItemsData argument`,"clipboardItemsData")};function it(e){if(!e||0===e.trim().length)throw new T(d,"className",e);return(()=>{let t=!1;function r(t){return`${e}:${t}: already disposed`}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&c().ULS.traceTag(596456217,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new I(r(e))}}})()}class nt{initialize(e){return e.then((e=>(this.clipboardStorage=e,c().ULS.traceTag(596453007,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Clipboard strategy type '${this.clipboardStrategyType}' was initialized.`),Promise.resolve(this))),(e=>(c().ULS.traceTag(596453008,n.nh.msoulscat_ES_EWAJS,E(e)?n.kp.Info:n.kp.Error,`Failed to initialize clipboard strategy type '${this.clipboardStrategyType}'. Error: ${n.Wp.getStringifiedError(e)}`),Promise.reject(e))))}set(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){const e="ClipboardStrategyBase.set: this.clipboardStorage should be defined";return c().ULS.shipAssertTag(596121485,n.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new R(h.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new R(h.SetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).set`,e))}}get(e){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){const e="ClipboardStrategyBase.get: this.clipboardStorage should be defined";return c().ULS.shipAssertTag(596121486,n.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new R(h.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then((e=>(this.clipboardDataProcessor&&this.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)))).catch((t=>{throw c().ULS.traceTag(507848131,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`ClipboardStrategyBase.get - Failed to get clipboard items. Command id: ${e.id}, Error: ${n.Wp.getStringifiedError(t)}`),t}))}catch(e){return Promise.reject(new R(h.GetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).get`,e))}}onSystemClipboardChangedExternally(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(de(),e):(c().ULS.shipAssertTag(595882508,n.nh.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new R(h.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new R(h.ClearClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).onSystemClipboardChangedExternally`,e))}}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())}constructor(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=it(`${e}`)}}const st=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function ct(e){let t=e;return t&&0!==t.trim().length||(t=Xe()),new ut(t)}function lt(){return st?window.performance.now():Date.now()}function dt(e){return st?new Date(e+window.performance.timing.navigationStart):new Date(e)}function pt(e,t,r){if(!r)throw new P(d,"creationTimestamp");return`${e?"Fulfilled":"Still unfulfilled"} after ${e?t?t-r:"?":lt()-r}ms`}class ut{fulfilled(){return this.isFulfilled}resolve(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):c().ULS.traceTag(596456257,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`Deferred promise - resolve: the resolve for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}reject(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):c().ULS.traceTag(596456260,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`Deferred promise - reject: the reject for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}markAsFulfilled(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=lt(),c().ULS.traceTag(596456261,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Deferred promise: marking promise #${this.sequenceId} with id '${this.id}' as fulfilled (${this.rejected?"rejected":"resolved"}). ${pt(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`))}fulfillmentCheck(e){return c().ULS.traceTag(596456258,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Deferred promise: asked to ${e} deferred promise #${this.sequenceId} with id '${this.id}'`),this.isFulfilled&&c().ULS.traceTag(596456259,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`Deferred promise: cannot ${e} deferred promise #${this.sequenceId} with id '${this.id}' since it was ${this.rejected?"rejected":"resolved"} already on ${dt(this.fulfillmentTimestamp)}. ${pt(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`),this.isFulfilled}constructor(e){this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=Ye(e),ut.sequenceId+=1,this.sequenceId=ut.sequenceId,this.creationTimestamp=lt(),c().ULS.traceTag(596456225,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Deferred promise: creating deferred promise #${this.sequenceId} with id '${this.id}' on ${dt(this.creationTimestamp)}`),this.promise=new Promise(((e,t)=>{c().ULS.traceTag(596456226,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Deferred promise: registering callback for promise #${this.sequenceId} with id '${this.id}' on ${dt(lt())}`),this.internalResolve=e,this.internalReject=t}))}}ut.sequenceId=0;class mt{getDeferredPromise(e){const t=Ye(e);return this.deferredResultMessagePromiseCache[t]}getPromise(e){const t=this.getDeferredPromise(e);if(t)return c().ULS.traceTag(596456218,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Deferred promise cache: found a deferred promise with id '${e}'.`),t.promise;c().ULS.traceTag(596456219,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Deferred promise cache: there is no deferred promise with id '${e}'.`)}addNewPromise(e){const t=ct(e);if(this.getDeferredPromise(t.id))throw new T("A deferred promise already exists in the cache for the specified id","id",t.id);const r=Ye(t.id);return this.deferredResultMessagePromiseCache[r]=t,c().ULS.traceTag(596456220,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Deferred promise cache: added a new deferred promise with id '${t.id}'.`),t}getLength(){let e=0;for(const t in this.deferredResultMessagePromiseCache)e+=1;return e}delete(e){if(!this.getDeferredPromise(e))return void c().ULS.traceTag(596456221,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Deferred promise cache: no need to delete an item with id '${e}' since this id is not associated with an existing deferred promise.`);const t=Ye(e);delete this.deferredResultMessagePromiseCache[t],c().ULS.traceTag(596456222,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Deferred promise cache: deleted id '${e}'.`)}clear(){if(c().ULS.traceTag(596456223,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Deferred promise cache: clearing ${this.getLength()} items from the cache`),this.deferredResultMessagePromiseCache)for(const e in this.deferredResultMessagePromiseCache){const t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){c().ULS.traceTag(596456224,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`Deferred promise cache: clear failed to reject promise id '${e}' with this exception: ${t.message}. Ignoring.`)}}this.deferredResultMessagePromiseCache={}}constructor(){this.deferredResultMessagePromiseCache={}}}const ft="initmessageid",ht="CreatorOrigin";function gt(e){if(!e)throw new P(d,"remoteWindow");if(!("window"in e)||!e.window)throw new P(d,"remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new P(d,"remoteWindow.windowOrigin");const t=function(e){Ze();const t=Be(e),r=Be(We().origin);if(t===r)return t;if(!Le().whitelistOriginComponents)throw new I(`validateOriginForReceivedMessage: Caller origin '${e}' doesn't match the current window's origin '${r}'`);const o=Ve(t),a=Ve(r);if(o.protocol!==a.protocol)throw new I(`validateRemoteWindowOrigin: Caller origin's protocol '${o.protocol}' doesn't match the current window origin's protocol '${a.protocol}'`);if(o.environment!==a.environment)throw new I(`validateRemoteWindowOrigin: Caller origin's environment '${o.environment}' doesn't match the current window origin's environment '${a.environment}'`);return t}(e.windowOrigin);return{window:e.window,windowOrigin:t}}class yt{get disposableImplementationExtension(){return this._disposableImplementationExtension}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(F([()=>{this.sender&&this.sender.dispose()},()=>{this.receiver&&this.receiver.dispose()}]),this.disposableImplementationExtension.dispose())}postMessage(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new P(d,"outgoingMessage");if(!this.sender){const e="WindowRPCBase::postMessage - this.sender should be defined";throw c().ULS.shipAssertTag(596121484,n.nh.msoulscat_ES_EWAJS,!1,e),new I(e)}this.sender.postMessage(e)}constructor(e,t,r,o){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=it(o)}}function St(){return bt}const bt={addEventListener:(e,t)=>window.addEventListener(e,t),removeEventListener:(e,t)=>window.removeEventListener(e,t)},Ct="message";class Et{dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(St().removeEventListener(Ct,this.windowMessageHandler),this.disposableImplementationExtension.dispose())}shouldFilterMessageEvent(e){try{if(!e.origin||!e.source)return c().ULS.traceTag(596452370,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return c().ULS.traceTag(596452371,n.nh.msoulscat_ES_EWAJS,n.kp.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return c().ULS.traceTag(596452372,n.nh.msoulscat_ES_EWAJS,n.kp.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return c().ULS.traceTag(596452373,n.nh.msoulscat_ES_EWAJS,n.kp.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1}onMessageReceived(e){if(this.shouldFilterMessageEvent(e))return;let t;try{t=this.deserializer.deserialize(e.data)}catch(e){c().ULS.traceTag(596452374,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Window RPC Receiver: unable to deserialize incoming message. ${n.Wp.getStringifiedError(e)}`);try{this.handler.handleDeserializationError(e)}catch(e){c().ULS.traceTag(596452184,n.nh.msoulscat_ES_EWAJS,n.kp.Error,`Window RPC Receiver: unable to handle deserialization error. ${n.Wp.getStringifiedError(e)}`)}return}if(t)try{this.handler.handleMessage(t).catch((e=>{c().ULS.traceTag(595985880,n.nh.msoulscat_ES_EWAJS,n.kp.Error,`Window RPC Receiver: unable to process incoming message. ${n.Wp.getStringifiedError(e)}`)}))}catch(e){c().ULS.traceTag(596452186,n.nh.msoulscat_ES_EWAJS,n.kp.Error,`Window RPC Receiver: unable to process incoming message. ${n.Wp.getStringifiedError(e)}`)}else c().ULS.traceTag(596452185,n.nh.msoulscat_ES_EWAJS,n.kp.Error,"Window RPC Receiver: the incoming message is empty")}constructor(e,t,r){if(this.deserializer=e,this.handler=t,this.windowMessageHandler=e=>this.onMessageReceived(e),!e)throw new P(d,"deserializer");if(!t)throw new P(d,"handler");if(!r)throw new P(d,"windowRPC");this.disposableImplementationExtension=it("WindowRPCReceiverInternal"),this.remoteWindow=gt(r.remoteWindow),St().addEventListener(Ct,this.windowMessageHandler)}}class wt{postMessage(e){if(!e)throw new P(d,"outgoingMessage");if(!this.remoteWindow.window)throw new I("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new I("The remote window does not support postMessage");const t=this.serializer.serialize(e);K(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e,t,r=!1){if(this.serializer=e,this.delayedQueueEnabled=r,!e)throw new P(d,"serializer");if(!t)throw new P(d,"windowRPC");this.disposableImplementationExtension=it("WindowRPCSenderInternal"),this.remoteWindow=gt(t.remoteWindow)}}const _t="OfficeOnlineCCP_",vt=_t+"Metadata_",Pt=_t+"Data_",Tt="_LocalStorageChangedFlag";function It(e){return vt+e}class At{constructor(){this.copyStatus=xt.Started,this.isTimestampStoredInSystemClipboard=!1,this.isAsyncSerializeFailed=!1,this.succeededPopulatingSystemClipboardSync=void 0,this.succeededPopulatingSystemClipboardAsync=void 0,this.isFullSheetCopy=!1}}class Mt{profilingMessage(e){const t=n.TZ.timeStamp()-this.startTime;return`onPasteProfiling: ${e}, pasteId: ${this.id}, timeMS: ${t.toFixed()}`}constructor(){this.startTime=n.TZ.timeStamp()}}var xt;function kt(e){let t;return e&&e.lastCopy&&(t={...e.lastCopy}),{lastCopy:t}}!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(xt||(xt={}));class Lt{get(e){this.disposableImplementationExtension.throwIfDisposed("get"),c().ULS.traceTag(595716238,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`localStorageClipboardStorage.get: commandParameters.id='${e?e.id:d}'`);const t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(de());try{const e=JSON.parse(t);if(!e||0===pe(e))return Promise.resolve(de());const r=me(e);return Promise.resolve(r)}catch(e){return Promise.resolve(de())}}set(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),c().ULS.traceTag(595716239,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`localStorageClipboardStorage.set: item count=${ue(e)}'; commandParameters.id='${t?t.id:d}'`),0===ue(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));const r=`${this.localStorageKey+Tt}`,o=Xe();return c().ULS.traceTag(595654546,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`localStorageClipboardStorage.set: set local storage value. eventFalgKey = ${r}. eventFlagValue = ${o}`),localStorage.setItem(r,o),Promise.resolve()}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[te,oe,"data/shadow-workbook"]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new R(h.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: failed access to localStorage",e)}if(!e)throw new R(h.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=Ce.LocalStorage,this.disposableImplementationExtension=it("LocalStorageClipboardStorage")}}class Dt extends nt{constructor(e){super(m.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},e)}}class Wt{onStorageChanged(e){c().ULS.shipAssertTag(595716249,n.nh.msoulscat_ES_EWAJS,null!=e,"e should not be null"),c().ULS.traceTag(595716288,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = ${e.key}. localStorageKeyToWatch = ${this.localStorageKeyToWatch}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),c().ULS.traceTag(595716289,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((()=>{this.raiseMetadataChangedEvent()}),(()=>{c().ULS.traceTag(595716295,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))}raiseMetadataChangedEvent(){return c().ULS.traceTag(595715525,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.clipboardStrategy.get({userHash:0}).then((e=>{this.listener(e),c().ULS.traceTag(595716232,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = ${this.lastLocalStorageValue}`)}),(e=>{c().ULS.traceTag(595716233,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))}isLocalStorageValueChanged(){const e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return c().ULS.traceTag(595715526,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = ${this.lastLocalStorageValue}. currentLocalStorageValue = ${e}`),this.lastLocalStorageValue=e,t}waitForLocalStorageValueToChange(e){if(c().ULS.traceTag(595715527,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged())return c().ULS.traceTag(595715528,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = ${this.lastLocalStorageValue}`),Promise.resolve();const t=ct(),r=new Date,o=setInterval((()=>{const a=(new Date).getTime()-r.getTime();c().ULS.traceTag(595715529,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = ${r}. elapseTime = ${a}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()?(clearInterval(o),c().ULS.traceTag(595716234,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = ${r}. elapseTime = ${a}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.resolve()):a>e&&(clearInterval(o),c().ULS.traceTag(595716235,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = ${r}. elapseTime = ${a}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.reject())}),200);return t.promise}constructor(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}}var Ot=r(2438);const $t="\n",Rt="\r",Ft=new RegExp(`(${$t}${Rt})|(${Rt}${$t})|(${Rt})`,"g"),Ut=new RegExp("(\t)","g"),jt=10240,Nt=new RegExp("<","g"),zt=new RegExp(">","g"),Ht="table",Jt="tr",Bt="td",Vt=`Version:0.9${$t}StartHTML:0000000100${$t}EndHTML:{EndHTML0}${$t}StartFragment:0000000134${$t}EndFragment:{EndFragm}${$t}<html>${$t}<body>${$t}\x3c!--StartFragment--\x3e${$t}`,Gt=`\x3c!--EndFragment--\x3e${$t}</body>${$t}</html>`,Kt="0000000000",Zt="data-ccp-timestamp";function qt(e){return e?e.replace(Ft,$t):e}function Xt(e){return e?e.length<=jt?e:e.substr(0,jt):d}function Yt(e){var t,r;const o=function(e){return e?e.replace(Ft,`</${Bt}></${Jt}><${Jt}><${Bt}>`):e}((r=(t=e)?t.replace(Nt,"&lt;").replace(zt,"&gt;"):d)?r.replace(Ut,`</${Bt}><${Bt}>`):r);return`<${Ht}><${Jt}><${Bt}>${o}</${Bt}></${Jt}></${Ht}>`}function Qt(e){const t=[],r=e.getElementsByTagName("td");if(r.length>0){t.push(r[0].innerText);for(let e=1;e<r.length;e+=1)t.push("\t"),t.push(r[e].innerText)}return t.join("")}function er(e){if(!G()||G()&&N.isEdgeVersionWithTextHtmlWrapperSupportProperty)return e;const t=10,r=Vt.length+e.length+Gt.length;let o=(r-Gt.length).toString();if(o.length<t&&(o=Kt.substr(0,t-o.length)+o),o.length!==t){const e=`addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Fragment xml comment is ${o.length} but it should be 10`;throw c().ULS.shipAssertTag(596128536,n.nh.msoulscat_ES_EWAJS,!1,e),new R(h.UnexpectedClipboardTextHtmlContentLength,e)}let a=(r-7).toString();if(a.length<t&&(a=Kt.substr(0,t-a.length)+a),a.length!==t){const e=`addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Html tag is ${a.length} but it should be 10`;throw c().ULS.shipAssertTag(596128537,n.nh.msoulscat_ES_EWAJS,!1,e),new R(h.UnexpectedClipboardTextHtmlContentLength,e)}const i=Vt.replace("{EndHTML0}",a).replace("{EndFragm}",o)+e+Gt;return c().ULS.shipAssertTag(596128538,n.nh.msoulscat_ES_EWAJS,i.length===r,`addClipboardWrapperForEdge: The resulting text/html payload length of ${i.length} differs from the expected length of ${r}`),i}class tr{get clipboardStrategy(){if(this.clipboardPlatformEnvironment)return this.clipboardPlatformEnvironment.getClipboardStrategy();throw new I("clipboardPlatformEnvironment is missing")}onCopy(e){if(!e)return Promise.reject(new W(g.MissingArgumentError,"Missing commandParameters argument",new P(d,"commandParameters")));let t,r;this.initialClipboardStrategyType=e.dataClipboardStrategyType,t=new At;try{t.id=Qe(),c().ULS.traceTag(595937123,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.onCopy: copy ${t.id} started.`),t.sessionId=this.applicationHost.getSessionId(),t.commandParameters=e;const o=this.getCopyFlowHandler(t);t.sourceItem=this.getSourceItem(o,t),this.clearInProgressCopyIfNeeded(t),this.inProgressCopyContext=t,r=this.serialize(o,t),c().ULS.traceTag(595937152,n.nh.msoulscat_ES_EWAJS,n.kp.Verbose,`CopyPasteFlowManager.onCopy: updating metadata for copy id ${t.id} after serialize.`),this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType)&&r&&r.synchronousResult&&r.synchronousResult.setItem(ce,this.metadataManager.serializeMetadata({lastCopy:{...t,copyStatus:t.isFromCache?xt.Completed:xt.SynchronousPhaseCompleted}})),this.metadataManager.updateMetadata({lastCopy:t})}catch(r){return t?c().ULS.traceTag(595734742,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.onCopy: catching error for copy id ${t.id} during serialize.`):c().ULS.traceTag(595734743,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`CopyPasteFlowManager.onCopy: catching error and no copy context during serialize. CopyCommandId: ${e?.id}`),this.copyCompleteCleanup(t,e),Promise.reject(r)}try{return this.writeClipboardItems(e,t,r).then((()=>this.rejectIfCopyCancelled(t))).then((()=>(c().ULS.traceTag(504715104,n.nh.msoulscat_ES_EWAJS,n.kp.Verbose,`CopyPasteFlowManager.onCopy: Write to clipboard completed for both sync and async phase. CopyId: ${t?.id}.`),this.copyCompleteCleanup(t,e),t)),(r=>{c().ULS.traceTag(595734747,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.onCopy: Error in writeClipboardItems. CopyId: ${t?.id}. Error: ${n.Wp.getStringifiedError(r)}`);let o=r;return this.copyCompleteCleanup(t,e),o||(c().ULS.shipAssertTag(595854806,n.nh.msoulscat_ES_EWAJS,!1,`copyPasteFlowManager.onCopy: promise rejected without error. CopyId: ${t?.id}.`),o=new W(g.UnknownCopyErrorType,"copyPasteFlowManager.onCopy failed without specified error")),o.copyContext=t,Promise.reject(o)}))}catch(r){return this.copyCompleteCleanup(t,e),c().ULS.traceTag(596456160,n.nh.msoulscat_ES_EWAJS,n.kp.Error,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to store content in the clipboard. CopyId: ${t?.id}. Exception: ${n.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`),Promise.reject(new W(g.SaveToTheClipboardFailed,`Failed to store content in the clipboard (with an exception): ${r.message}`,r))}}onPaste(e){const t=new Mt;try{if(!e)return Promise.reject(new O(y.MissingArgumentError,"Missing commandParameters argument",new P(d,"commandParameters")));this.initialClipboardStrategyType=e.dataClipboardStrategyType,e.isTimestampStoredInSystemClipboard=!0,t.id=Xe(),t.sessionId=this.applicationHost.getSessionId(),t.commandParameters=e,t.clipboardItems=de(),t.isClipboardInaccessible=!1,c().ULS.traceTag(595685636,n.nh.msoulscat_ES_EWAJS,n.kp.Info,t.profilingMessage("start"));const r=this.metadataManager.getCachedMetadata();t.copyContextSnapshot=r.lastCopy,this.applicationHost.initializePasteContext(t),t.copyContextSnapshot?c().ULS.traceTag(595937154,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.onPaste: paste started for copy id ${t.copyContextSnapshot.id}`):c().ULS.traceTag(595730637,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"CopyPasteFlowManager.onPaste: paste started and copy context is null");let o,a=!1;return e.skipClipboardAccess?(c().ULS.traceTag(595685637,n.nh.msoulscat_ES_EWAJS,n.kp.Info,t.profilingMessage("skipClipboardAccess")),o=Promise.resolve()):o=this.readFromClipboard(t,e).then((r=>{if(c().ULS.traceTag(595685638,n.nh.msoulscat_ES_EWAJS,n.kp.Info,t.profilingMessage("readFromClipboard_then")),e.isAsyncClipboardAPI&&this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType)){let e={lastCopy:void 0};if(!this.isEmptyClipboard(r)){const o=r.getItem(ce);o&&(e=this.metadataManager.deserializeMetadata(o),(!t?.copyContextSnapshot||t.copyContextSnapshot.id!==e?.lastCopy?.id||t?.copyContextSnapshot?.id===e?.lastCopy?.id&&t?.copyContextSnapshot?.copyStatus!==xt.Completed&&e?.lastCopy?.copyStatus===xt.Completed)&&(t.copyContextSnapshot=e?.lastCopy,this.metadataManager.updateMetadata(e)))}e?.lastCopy||(t.copyContextSnapshot=void 0,this.metadataManager.updateMetadata({lastCopy:void 0}),r.setItem(ie,u))}return t.clipboardItems=r,Promise.resolve()}),(e=>e&&e.reason&&e.reason===y.ClipboardIsInaccessible?(t.isClipboardInaccessible=!0,Promise.resolve()):Promise.reject(e))),o.then((()=>e.isAsyncClipboardAPI&&this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType)?t:this.readClipboardItemsAgainIfMetadataNotSync(t,e))).then((()=>(c().ULS.traceTag(595685639,n.nh.msoulscat_ES_EWAJS,n.kp.Info,t.profilingMessage("getPasteFlowHandler")),this.getPasteFlowHandler(t)))).then((e=>(a||e.beforePaste&&e.beforePaste(t),e))).then((r=>{if(c().ULS.traceTag(595685640,n.nh.msoulscat_ES_EWAJS,n.kp.Info,t.profilingMessage("getPasteFlowHandler_then")),t.clipboardItems?.getItem(ie)!==u&&!t.isSameSession&&(!e.isAsyncClipboardAPI||!this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType))&&t.copyContextSnapshot&&t.copyContextSnapshot.copyStatus!==xt.Completed&&r.shouldWaitForCopyToComplete(t)){c().ULS.traceTag(595937155,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.onPaste: pasteFlowHandler ask to waiting for copy (${t.copyContextSnapshot.id}) to complete. current status ${t.copyContextSnapshot.copyStatus}. copy session id is ${t.copyContextSnapshot.sessionId}`),c().ULS.traceTag(595683427,n.nh.msoulscat_ES_EWAJS,n.kp.Info,t.profilingMessage("onDeferredPasteStarted")),r.onDeferredPasteStarted(t);const o=this.continueWhenCopyComplete(e,t).then((e=>(c().ULS.traceTag(595685642,n.nh.msoulscat_ES_EWAJS,n.kp.Info,t.profilingMessage("onDeferredPasteCompleted")),r.onDeferredPasteCompleted(t),t.copyContextSnapshot=this.metadataManager.getCachedMetadata().lastCopy,t.clipboardItems=e,r)),(e=>(r.onDeferredPasteCompleted(t),c().ULS.traceTag(595882504,n.nh.msoulscat_ES_EWAJS,n.kp.Error,`CopyPasteFlowManager.onPaste: got error while wait for deferred paste to complete. error: [${e}]`),Promise.reject(e))));return c().ULS.traceTag(595685643,n.nh.msoulscat_ES_EWAJS,n.kp.Info,t.profilingMessage("continueWhenCopyComplete")),this.testHook("continueWhenCopyComplete"),o}return c().ULS.traceTag(595940941,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.onPaste: not wait for copy(${t.copyContextSnapshot&&t.copyContextSnapshot.id}) to complete. is copyContextSnapshot defined: ${void 0!==t.copyContextSnapshot}. copyStatus: ${t.copyContextSnapshot&&t.copyContextSnapshot.copyStatus}`),r})).then((e=>this.deserialize(e,t))).then((()=>{c().ULS.traceTag(595685644,n.nh.msoulscat_ES_EWAJS,n.kp.Info,t.profilingMessage("deserialize_then")),t.clipboardItems&&t.clipboardItems.getItem(ie)===u&&(c().ULS.traceTag(595685645,n.nh.msoulscat_ES_EWAJS,n.kp.Info,t.profilingMessage("onSystemClipboardChangedExternally")),this.onSystemClipboardChangedExternally())})).then((()=>{const e=t.clipboardItems;if(void 0===e)return;const r=e.getItem(oe);if(void 0!==r){const e=function(e){if(!e||!e.trim())return;const t=new DOMParser,r=Ot.domPurifyPolicyHtml.createHTML(e),o=t.parseFromString(r,"text/html"),a=function(e){const t=e.getElementsByTagName("meta");for(let e=0;e<t.length;e+=1){const r=t[e];if("ProgId"===r.getAttribute("name")){const e=r.getAttribute("content");if(null!==e){if(e.length>64)return void c().ULS.shipAssertTag(595683460,n.nh.msoulscat_ES_EWAJS,!1,"ProgID longer than 64 characters");if(e.startsWith("Word"))return"Word Desktop";if(e.startsWith("Excel"))return"Excel Desktop";if(e.startsWith("PowerPoint"))return"PowerPoint Desktop";if(e.startsWith("OneNote"))return"OneNote Desktop";c().ULS.traceTag(595683457,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"htmlClipboardItem.getOfficeDesktopOrigin: unrecognized ProgId content")}return}}}(o);if(void 0!==a)return a;const i=function(e){if(null===e||null===e.body||null===e.body.children||0===e.body.children.length)return;const t=e.body.children[0];if(null!=t&&null!=t.classList)for(let e=0;e<t.classList.length;e+=1){const r=t.classList[e];if(r.startsWith("SCXO"))return"OneNote Online";if(r.startsWith("SCXP"))return"PowerPoint Online";if(r.startsWith("SCXW"))return"Word Online"}}(o);return void 0!==i?i:function(e){if(null===e)return!1;const t=e.getElementsByTagName("b");if(0===t.length)return!1;const r=t[0];return!(null==r||null==r.id||null==r.id.startsWith||!r.id.startsWith("docs-internal-guid-"))}(o)?"Google Docs":void 0}(r);void 0!==e&&(t.externalAppSource=e)}})).then((()=>t)).catch((e=>{let r=e;return r||(c().ULS.shipAssertTag(595858762,n.nh.msoulscat_ES_EWAJS,!1,"copyPasteFlowManager.onPaste: promise rejected without error"),r=new O(y.UnknownPasteError,"copyPasteFlowManager.onPaste failed without specified error")),r.pasteContext=t,Promise.reject(r)}))}catch(e){return c().ULS.shipAssertTag(596456161,n.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Exception: ${n.Wp.getStringifiedError(e)}`),Promise.reject(new O(y.FailedToReadFromClipboard,`Failed to read data from the clipboard (with an exception): ${e.message}`,e,t))}}onCancelCopy(e){try{if(this.inProgressCopyContext?(this.inProgressCopyContext.markForCancellation=!0,c().ULS.traceTag(595734748,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.onCancelCopy: canceling copy for copy id ${this.inProgressCopyContext.id}.`)):c().ULS.traceTag(595734749,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"CopyPasteFlowManager.onCancelCopy: no inProgressCopyContext."),!e)return Promise.resolve();this.metadataManager.clear();const t=de(),r={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:we.Copy};return this.clipboardStrategy.set(t,r).catch((e=>(c().ULS.traceTag(596456162,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard: ${n.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new $(S.FailedToClearClipboard,`Failed to clear the clipboard: ${e.message}`,e)))))}catch(e){return c().ULS.traceTag(596456163,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard. Exception: ${n.Wp.getStringifiedError(e)}`),Promise.reject(new $(S.FailedToClearClipboard,`Failed to clear the clipboard (with an exception): ${e.message}`,e))}}isAsyncClipboardEnhancementsEnabled(e){return this.isAsyncClipboardEnhancementsFGEnabled&&e===m.AsyncSystemClipboard}async onSystemClipboardChangedExternally(){this.onCancelCopy(!1),this.metadataManager.updateMetadata({lastCopy:void 0});const e={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:we.Copy};await this.clipboardStrategy.onSystemClipboardChangedExternally(e)}readClipboardItemsAgainIfMetadataNotSync(e,t){let r=!1;return this.metadataManager.getMetadataSyncPromise().then((t=>{t&&t.lastCopy?(e.copyContextSnapshot&&(r=t.lastCopy.id!==e.copyContextSnapshot.id||t.lastCopy.copyStatus!==e.copyContextSnapshot.copyStatus),e.copyContextSnapshot=t.lastCopy,c().ULS.traceTag(595937158,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata is sync. copy id = ${e.copyContextSnapshot.id}. copy status = ${e.copyContextSnapshot.copyStatus}. isMetadataChanged = ${r}`)):c().ULS.traceTag(595937025,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata or metadata.lastCopy are not defined. This should be possible only when the last copy was external (i.e. there is no previous copy operation in xlo). do nothing")})).then((()=>r?this.readRichClipboardOnly(e,t,e.clipboardItems):Promise.resolve(e.clipboardItems))).then((t=>(e.clipboardItems=t,e)))}getCopyFlowHandler(e){let t;try{t=this.applicationHost.getCopyFlowHandler(e)}catch(e){throw c().ULS.shipAssertTag(596456192,n.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler failed with an exception: ${n.Wp.getStringifiedError(e)}`),new W(g.FetchCopyFlowHandlerFailed,`applicationHost.getCopyFlowHandler failed with an exception: ${e.message}`,e)}if(!t){const e="CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw c().ULS.shipAssertTag(596456193,n.nh.msoulscat_ES_EWAJS,!1,e),new W(g.CopyFlowHandlerNotFound,e)}return t}getSourceItem(e,t){try{return e.getSourceItem(t)}catch(e){throw c().ULS.shipAssertTag(596456194,n.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.getSourceItem failed with an exception: ${n.Wp.getStringifiedError(e)}`),new W(g.FetchSourceItemFailed,`applicationHost.getSourceItem failed with an exception: ${e.message}`,e)}}serialize(e,t){try{e.beforeSerialize(t)}catch(e){throw c().ULS.shipAssertTag(596456195,n.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.beforeSerialize failed with an exception. CopyId: ${t?.id}. Error: ${n.Wp.getStringifiedError(e)}`),new W(g.BeforeSerializeFailed,`copyFlowHandler.beforeSerialize failed with an exception: ${e.message}`,e)}let r;c().ULS.traceTag(504715103,n.nh.msoulscat_ES_EWAJS,n.kp.Verbose,`CopyPasteFlowManager.serialize: copyFlowHandler.beforeSerialize completed. CopyId: ${t?.id}.`);try{r=e.serialize(t)}catch(e){throw c().ULS.shipAssertTag(596456196,n.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.serialize: copyFlowHandler.serialize failed with an exception. CopyId: ${t?.id}. Error: ${n.Wp.getStringifiedError(e)}`),new W(g.SerializeFailed,`copyFlowHandler.serialize failed with an exception: ${e.message}`,e)}if(!r)throw c().ULS.shipAssertTag(596456197,n.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.serialize: copyFlowHandler.serialize should return a non null result. CopyId: ${t?.id}.`),new W(g.SerializeResultNotValid,"copyFlowHandler.serialize should return a non null result");return c().ULS.traceTag(504715102,n.nh.msoulscat_ES_EWAJS,n.kp.Verbose,`CopyPasteFlowManager.serialize completed. CopyId: ${t?.id}.`),r}setClipboardSync(e,t,r){try{r?c().ULS.traceTag(595734750,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.setClipboardSync: start setClipboardSync for copy id ${r.id}.`):c().ULS.traceTag(595734751,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,"CopyPasteFlowManager.setClipboardSync: no copy context.");let o=e;return o||(o=de()),this.clipboardStrategy.set(o,t).catch((e=>{if(c().ULS.traceTag(596456198,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. isKeyboardEvent: ${t.isKeyboardEvent}, Error: ${n.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),e&&void 0!==e.reason){const t=e;if(t.reason===h.ClipboardIsInaccessible)return Promise.reject(new W(g.ClipboardIsInaccessible,t.message,t));if(t.reason===h.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation)return Promise.reject(new W(g.SuccessiveCutCopyOverridingPendingCutCopy,`A successive Cut/Copy user event occurred before the last Cut/Copy browser event fired: ${t.message}`,t));if(t.reason===h.RejectingBlockedSyncCutCopyPromise)return Promise.reject(new W(g.BlockedSynchronousCutCopy,`In the user Cut/Copy operation, the async part occurred before its predecessor sync Cut/Copy browser event fired: ${t.message}`,t))}return Promise.reject(new W(g.SaveToTheClipboardFailed,`Failed to synchronously store content in the clipboard: ${e.message}`,e))})).then((()=>{r.succeededPopulatingSystemClipboardSync=t.isTimestampStoredInSystemClipboard}))}catch(e){return c().ULS.shipAssertTag(596456199,n.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. Exception: ${n.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new W(g.SaveToTheClipboardFailed,`Failed to synchronously store content in the clipboard (with an exception): ${e.message}`,e))}}setClipboardAsync(e,t,r){return c().ULS.traceTag(595734752,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.setClipboardAsync: start setClipboardAsync for copy id ${r.id}.`),e?e.then((e=>{try{if(c().ULS.traceTag(505794970,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.setClipboardAsync: clipboardItemsPromise resolved for copy id ${r?.id}.`),this.isEmptyClipboard(e))return Promise.resolve();this.isAsyncClipboardEnhancementsEnabled(t.dataClipboardStrategyType)&&e.setItem(ce,this.metadataManager.serializeMetadata({lastCopy:{...r,copyStatus:xt.Completed}}));const o=t.stopwatch;t.stopwatch=void 0;const a={...t};return a.isTimestampStoredInSystemClipboard=!1,t.isAsyncSystemClipboardEnabled&&this.isAsyncClipboardEnhancementsEnabled(t.dataClipboardStrategyType)&&(a.stopwatch=o),t.stopwatch=o,t.isKeyboardEvent&&(a.isKeyboardEvent=!1,a.silentClipboardAccessFailures=!0),this.clipboardStrategy.set(e,a).catch((e=>(c().ULS.traceTag(596456200,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`CopyPasteFlowManager.setClipboardAsync: Failed to asynchronously store content in the clipboard. CopyId: ${r?.id}. Error: ${n.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),e&&void 0!==e.reason&&e.reason===h.ClipboardIsInaccessible?Promise.resolve():Promise.reject(new W(g.SaveToTheClipboardFailed,`Failed to asynchronously store content in the clipboard: ${e&&e.message}`,e))))).then((()=>{c().ULS.traceTag(505794969,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.setClipboardAsync: setClipboardAsync completed for copy id ${r.id}.`),r.succeededPopulatingSystemClipboardAsync=a.isTimestampStoredInSystemClipboard}))}catch(e){return c().ULS.shipAssertTag(596456201,n.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.setClipboardAsync: Failed to asynchronously store content in the clipboard. CopyId: ${r?.id}. Exception: ${n.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new W(g.SaveToTheClipboardFailed,`Failed to asynchronously store content in the clipboard (with an exception): ${e.message}`,e))}}),(e=>(r.isAsyncSerializeFailed=!0,c().ULS.traceTag(596456202,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`CopyPasteFlowManager.setClipboardAsync: Failed to asynchronously serialize the content - Marking copyContext.isAsyncSerializeFailed as true. CopyId: ${r?.id}. Error: ${n.Wp.getStringifiedError(e)}. Call stack: ${e&&e.stack?e.stack:"NA"}`),Promise.reject(new W(g.AsyncSerializeFailed,`Failed to asynchronously serialize the content. Error: ${e?e.message:"..."}`,e))))):(c().ULS.traceTag(595734753,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.setClipboardAsync: no clipboardItemsPromise. resolving promise for copy id ${r.id}.`),Promise.resolve())}isEmptyClipboard(e){return e?0===ue(e)&&(c().ULS.traceTag(596456204,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result does not contain items."),!0):(c().ULS.traceTag(596456203,n.nh.msoulscat_ES_EWAJS,n.kp.Error,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result is undefined."),!0)}writeClipboardItems(e,t,r){return this.isAsyncClipboardEnhancementsEnabled(e?.dataClipboardStrategyType)?this.writeClipboardItemsInSyncPhase(e,t,r).then((()=>this.rejectIfCopyCancelled(t).then((()=>this.setClipboardAsync(r.asynchronousResult,e,t))))):Promise.all([this.writeClipboardItemsInSyncPhase(e,t,r),this.rejectIfCopyCancelled(t).then((()=>this.setClipboardAsync(r.asynchronousResult,e,t)))])}writeClipboardItemsInSyncPhase(e,t,r){return this.setClipboardSync(r.synchronousResult,e,t).then((()=>this.rejectIfCopyCancelled(t))).then((()=>{t.copyStatus=xt.SynchronousPhaseCompleted,c().ULS.traceTag(595937153,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.onCopy: updating metadata for copy id ${t.id} after status changed to SynchronousPhaseCompleted.`),this.metadataManager.updateMetadata({lastCopy:t})})).catch((r=>{if(t?c().ULS.traceTag(595734744,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: Error in setClipboardSync. CopyId: ${t?.id}. Error: ${n.Wp.getStringifiedError(r)}`):c().ULS.traceTag(595734745,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: no copy context. CopyCommandId: ${e?.id}`),r&&r.reason){const e=r.reason;if(e===g.SuccessiveCutCopyOverridingPendingCutCopy||e===g.BlockedSynchronousCutCopy||e===g.CopyOperationCancelled||this.initialClipboardStrategyType===m.AsyncSystemClipboard&&e===g.ClipboardIsInaccessible)return c().ULS.traceTag(595734746,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: synchronous copy failed to populate the clipboard. CopyId: ${t?.id}. Rejecting the promise: ${n.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`),Promise.reject(r)}return c().ULS.traceTag(596456159,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: synchronous copy failed to populate the clipboard. Ignoring this failure since the active selection will allow for the required functionality. CopyId: ${t?.id}. Error: ${n.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`),this.metadataManager.updateMetadata({lastCopy:t}),Promise.resolve()}))}readFromClipboard(e,t){c().ULS.traceTag(595685646,n.nh.msoulscat_ES_EWAJS,n.kp.Info,e.profilingMessage("readFromClipboard")),e.copyContextSnapshot&&(t.isTimestampStoredInSystemClipboard=e.copyContextSnapshot.isTimestampStoredInSystemClipboard);const r=this.clipboardStrategy.get(t);return c().ULS.traceTag(595685647,n.nh.msoulscat_ES_EWAJS,n.kp.Info,e.profilingMessage("readFromClipboard_ret")),r?r.then((t=>(c().ULS.traceTag(595685648,n.nh.msoulscat_ES_EWAJS,n.kp.Info,e.profilingMessage("readFromClipboard_then")),t?Promise.resolve(t):(c().ULS.traceTag(596456206,n.nh.msoulscat_ES_EWAJS,n.kp.Error,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Intercepted a missing clipboard item collection"),Promise.reject(new O(y.FailedToReadFromClipboard,"Failed to read data from the clipboard. Intercepted a missing clipboard item collection",new O(y.ClipboardIsEmpty,d)))))),(e=>{if(c().ULS.traceTag(596456207,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard: ${n.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),t.isPasteCommandFromRecoveryUI&&t.pasteRecoveryCachedClipboardItems)return c().ULS.traceTag(577249542,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"CopyPasteInfra.copyPasteFlowManager.onPaste: Returning 'pasteRecoveryCachedClipboardItems'"),Promise.resolve(t.pasteRecoveryCachedClipboardItems);const r=e;return b(e,h.ClipboardIsInaccessible)?Promise.reject(new O(y.ClipboardIsInaccessible,r.message,r)):b(e,h.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(new O(y.SuccessivePasteOverridingPendingPaste,`A successive Paste user event occurred before the last Paste browser event fired: ${r.message}`,r)):b(e,h.AsyncClipboardReadFailure)?Promise.reject(new O(y.FailedToReadFromAsyncClipboard,r.message,r)):Promise.reject(new O(y.FailedToReadFromClipboard,`Failed to read data from the clipboard: ${e.message}`,e))})):(c().ULS.shipAssertTag(596456205,n.nh.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. clipboardStrategy.get() did not return an object"),Promise.reject(new O(y.FailedToReadFromClipboard,"Failed to read data from the clipboard. clipboardStrategy.get() did not return an object",new O(y.ReadFromClipboardReturnNullOrUndefined,d))))}getPasteFlowHandler(e){let t;try{t=this.applicationHost.getPasteFlowHandler(e)}catch(e){throw c().ULS.shipAssertTag(596456208,n.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler failed. Exception: ${n.Wp.getStringifiedError(e)}`),new O(y.FetchPasteFlowHandlerFailed,`applicationHost.getPasteFlowHandler failed with an exception: ${e.message}`,e)}if(!t){const e="CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw c().ULS.shipAssertTag(596456209,n.nh.msoulscat_ES_EWAJS,!1,e),new O(y.PasteFlowHandlerNotFound,e)}return t}deserialize(e,t){return c().ULS.traceTag(595683456,n.nh.msoulscat_ES_EWAJS,n.kp.Info,t.profilingMessage("deserialize")),e.deserialize(t).catch((e=>{const t=n.Wp.getStringifiedError(e);return c().ULS.traceTag(596456210,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onPaste: Deserialization failed: ${t}.`),Promise.reject(new O(y.DeserializeOperationFailed,`Deserialization failed: ${t}`,e))}))}copyCompleteCleanup(e,t){e?(c().ULS.traceTag(595734754,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: start copy complete for copy id ${e.id}.`),t&&(e.isTimestampStoredInSystemClipboard=t.isTimestampStoredInSystemClipboard),e&&this.inProgressCopyContext&&e.id===this.inProgressCopyContext.id?(this.inProgressCopyContext=void 0,e.copyStatus=xt.Completed,c().ULS.traceTag(595937159,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: updating metadata for copy id ${e.id} after copy completed.`),this.metadataManager.updateMetadata({lastCopy:e})):c().ULS.traceTag(595734755,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: not setting copy status to complete state for copy id ${e.id}.`)):c().ULS.traceTag(595734784,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`CopyPasteFlowManager.copyCompleteCleanup: no copy context. CopyCommandId: ${t?.id}`)}readRichClipboardOnly(e,t,r){return t.skipSystemClipboardAccess=!0,this.readFromClipboard(e,t).then((e=>(c().ULS.traceTag(595937160,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"CopyPasteFlowManager.readRichClipboardOnly: get clipboard items."),e)),(e=>(c().ULS.traceTag(595940942,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`CopyPasteFlowManager.readRichClipboardOnly: reading form rich clipboard failed with error: ${n.Wp.getStringifiedError(e)}. use clipboard items from the first read as fallback.`),Promise.resolve(r))))}continueWhenCopyComplete(e,t){if(!t||!t.copyContextSnapshot)return Promise.resolve(void 0);if(t.copyContextSnapshot.copyStatus===xt.Completed)return Promise.resolve(void 0);if(this.deferredPasteData&&this.deferredPasteData.copyContextId!==t.copyContextSnapshot.id&&(c().ULS.shipAssertTag(595937161,n.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.continueWhenCopyComplete: deferred paste for another copy(${this.deferredPasteData.copyContextId} !== ${t.copyContextSnapshot.id}) exist, this is not expected as we should clean deferred paste data when new copy started(both same and cross session)`),this.rejectDeferredPasteData(y.DeferredPasteRejectedBecauseOtherCopyCompleted)),!this.deferredPasteData){const r=this.metadataManager.getCachedMetadata();if(r&&r.lastCopy&&r.lastCopy.copyStatus===xt.Completed&&r.lastCopy.id===t.copyContextSnapshot.id)return c().ULS.traceTag(595937162,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.continueWhenCopyComplete: copy ${r.lastCopy.id} already completed, not need for waiting any longer, reading the rich clipboard items`),this.readRichClipboardOnly(t,e,t.clipboardItems);const o=ct(),a=o.promise.then((()=>this.readRichClipboardOnly(t,e,t.clipboardItems)));this.deferredPasteData={copyContextId:t.copyContextSnapshot.id,copyCompleteDeferredPromise:o,readClipboardPromise:a,numberOfDeferredPaste:0,createdDate:new Date}}return this.deferredPasteData.numberOfDeferredPaste+=1,c().ULS.traceTag(595937163,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.continueWhenCopyComplete: new deferred paste created for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}`),this.deferredPasteData.readClipboardPromise}rejectDeferredPasteData(e){if(this.deferredPasteData){c().ULS.traceTag(595937164,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.rejectDeferredPasteData: reject deferred pastes for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}. totalTime = ${(new Date).getTime()-this.deferredPasteData.createdDate.getTime()}ms`);const t=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,t.reject(new O(e,"CopyPasteFlowManager.rejectDeferredPasteData: reject deferred paste"))}}resolveDeferredPasteData(){if(this.deferredPasteData){c().ULS.traceTag(595937165,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.resolveDeferredPasteData: resolve deferred pastes for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}. totalTime = ${(new Date).getTime()-this.deferredPasteData.createdDate.getTime()}ms`);const e=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,e.resolve()}}rejectIfCopyCancelled(e){return e?c().ULS.traceTag(595734785,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: start rejectIfCopyCancelled for copy id ${e.id}.`):c().ULS.traceTag(595734786,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,"CopyPasteFlowManager.rejectIfCopyCancelled: no copy context."),e&&e.markForCancellation?(c().ULS.traceTag(595734787,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: reject for copy id ${e.id}.`),Promise.reject(new W(g.CopyOperationCancelled,`CopyPasteFlowManager.rejectIfCopyCancelled: Rejecting since copyContext with id ${e.id} is marked for cancellation`))):(e&&c().ULS.traceTag(595734788,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: resolve for copy id ${e.id}.`),Promise.resolve())}clearInProgressCopyIfNeeded(e){e&&e.markForCancellation||!this.inProgressCopyContext||e&&this.inProgressCopyContext.id===e.id||(c().ULS.traceTag(595937166,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.clearInProgressCopyIfNeeded: cancel previous in-progress copy (id = ${this.inProgressCopyContext.id}) as new copy started (${e.id})`),this.inProgressCopyContext.markForCancellation=!0,this.inProgressCopyContext=void 0)}onMetadataChanged(e){e&&e.lastCopy?(c().ULS.traceTag(595937167,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.onMetadataChanged: the status of copy id ${e.lastCopy.id} from session ${e.lastCopy.sessionId} changed to ${e.lastCopy.copyStatus}`),this.clearInProgressCopyIfNeeded(e.lastCopy),this.deferredPasteData&&e.lastCopy.id!==this.deferredPasteData.copyContextId&&(c().ULS.traceTag(595734789,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.onMetadataChanged: reject deferred paste because copy id ${e.lastCopy.id} is not equal to ${this.deferredPasteData.copyContextId}`),this.rejectDeferredPasteData(y.DeferredPasteRejectedBecauseOtherCopyStarted)),e.lastCopy.copyStatus===xt.Completed&&this.onCopyCompletedSuccessfully(e.lastCopy)):(c().ULS.traceTag(595734790,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"CopyPasteFlowManager.onMetadataChanged: no metadata or no metadata.lastCopy"),this.deferredPasteData&&(c().ULS.traceTag(595724049,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"CopyPasteFlowManager.onMetadataChanged: reject deferred paste because metadata update without copy context"),this.rejectDeferredPasteData(y.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext)))}onCopyCompletedSuccessfully(e){e?c().ULS.traceTag(595734791,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CopyPasteFlowManager.onCopyCompletedSuccessfully: start onCopyCompletedSuccessfully for copy id ${e.id}.`):c().ULS.traceTag(595734792,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,"CopyPasteFlowManager.onCopyCompletedSuccessfully: no copy context."),this.deferredPasteData&&e&&e.copyStatus===xt.Completed&&e.id===this.deferredPasteData.copyContextId&&this.resolveDeferredPasteData()}testHook(e){}constructor(e,t,r){if(this.clipboardPlatformEnvironment=e,this.applicationHost=t,this.inProgressCopyContext=void 0,this.deferredPasteData=void 0,this.isAsyncClipboardEnhancementsFGEnabled=!1,!r)throw new P(d,"logger");l(r),c().ULS.shipAssertTag(596456157,n.nh.msoulscat_ES_EWAJS,!!e,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'clipboardPlatformEnvironment' argument"),c().ULS.shipAssertTag(596456158,n.nh.msoulscat_ES_EWAJS,!!t,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'applicationHost' argument"),this.metadataManager=e.getMetadataManager(),this.metadataManager.addMetadataChangeListener("CopyPasteFlowManagerOnMetadataChangedListener",this.onMetadataChanged.bind(this)),c().ULS.shipAssertTag(596456156,n.nh.msoulscat_ES_EWAJS,!!this.metadataManager,"CopyPasteInfra.copyPasteFlowManager.ctor: metadataManager is not valid"),this.isAsyncClipboardEnhancementsFGEnabled=i(0,!1)}}r(2788),r(3114);var rr=r(4342);let or,ar;const ir={serializeMetadata:function(e){if(!e)return"{}";try{const t={},r=function(e){if(e)try{if(!e.id)throw new R(h.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.id is not defined");if(!e.sessionId)throw new R(h.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.sessionId is not defined");if(void 0===e.copyStatus)throw new R(h.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.copyStatus is not defined");return{id:e.id,sessionId:e.sessionId,sourceItem:ar.serializeSourceItem(e.sourceItem),commandParameters:ar.serializeCommandParameters(e.commandParameters),copyStatus:e.copyStatus,isTimestampStoredInSystemClipboard:e.isTimestampStoredInSystemClipboard,isAsyncSerializeFailed:e.isAsyncSerializeFailed,asyncClipboardItemsKeys:e.asyncClipboardItemsKeys,syncClipboardItemsKeys:e.syncClipboardItemsKeys,isFullSheetCopy:e.isFullSheetCopy}}catch(e){return void c().ULS.traceTag(595945243,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`MetadataSerializer.serializeCopyContext: failed to serialized copyContext: ${n.Wp.getStringifiedError(e)}`)}}(e.lastCopy);return r&&(t.copyContext=r),JSON.stringify(t)}catch(e){return c().ULS.traceTag(595945242,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`MetadataSerializer.serializeMetadata: failed to serialized metadata: ${n.Wp.getStringifiedError(e)}`),"{}"}},deserializeMetadata:function(e){if(!e)return{};try{const t=JSON.parse(e),r={};return t.copyContext&&(r.lastCopy=function(e){if(e)try{if(!e.id)throw new R(h.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.id is not defined");if(!e.sessionId)throw new R(h.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sessionId is not defined");if(!e.copyStatus)throw new R(h.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.copyStatus is not defined");if(!e.sourceItem)throw new R(h.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sourceItem is not defined");if(!e.commandParameters)throw new R(h.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.commandParameters is not defined");const t=new At;return t.id=e.id,t.sessionId=e.sessionId,t.copyStatus=e.copyStatus,t.isTimestampStoredInSystemClipboard=e.isTimestampStoredInSystemClipboard,t.isAsyncSerializeFailed=e.isAsyncSerializeFailed,t.sourceItem=ar.deserializeSourceItem(e.sourceItem),t.commandParameters=ar.deserializeCommandParameters(e.commandParameters),t.asyncClipboardItemsKeys=e.asyncClipboardItemsKeys,t.syncClipboardItemsKeys=e.syncClipboardItemsKeys,t.isFullSheetCopy=e.isFullSheetCopy,t}catch(e){return void c().ULS.traceTag(595945245,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`MetadataSerializer.deserializeMetadata: failed to deserialized copyContext with error: ${n.Wp.getStringifiedError(e)}.`)}}(t.copyContext)),r}catch(e){c().ULS.traceTag(595945244,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`MetadataSerializer.deserializeMetadata: failed to deserialized metadata with error: ${n.Wp.getStringifiedError(e)}`)}return{}}};let nr,sr,cr,lr={};const dr={};let pr;const ur={getCachedMetadata:function(){return c().ULS.traceTag(595730648,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`MetadataManager.getCachedMetadata: get cached metadata with value: ${yr(lr)}`),kt(lr)},updateMetadata:function(e){c().ULS.traceTag(595730652,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`MetadataManager.updateMetadata: start update metadata with metadata : ${yr(e)}`);const t={...lr,...e},r=me();r.setItem("metadata",sr.serializeMetadata(t)),c().ULS.traceTag(595730653,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`MetadataManager.updateMetadata: schedule metadata with value: ${yr(t)}`),hr(r,t)},clear:function(){c().ULS.traceTag(595730654,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"MetadataManager.clear: start clear metadata");hr(me(),{})},addMetadataChangeListener:function(e,t){e||c().ULS.traceTag(595936158,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define"),t||c().ULS.traceTag(595936159,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,"MetadataManager.addMetadataChangeListener: expected listener to be define"),dr[e]&&c().ULS.traceTag(595936160,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`MetadataManager.addMetadataChangeListener: listener with same listenerId(${e} already exist.`),dr[e]=t},removeMetadataChangeListener:function(e){e||c().ULS.traceTag(595936161,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define"),dr[e]?delete dr[e]:c().ULS.traceTag(595936162,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`MetadataManager.removeMetadataChangeListener: can't find listener with listenerId = ${e}.`)},getMetadataSyncPromise:function(){return pr&&(0,rr.isChangeGateEnabled)("OfficeVSO:2594435_ArtCCPWaitForCopyToComplete")?(c().ULS.traceTag(595937174,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"MetadataManager.getMetadataSyncPromise: metadata not sync, return deferred promise."),pr.deferredPromise.promise.then((e=>(c().ULS.traceTag(595937175,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"MetadataManager.getMetadataSyncPromise: sync promise resolved."),e)))):(c().ULS.traceTag(595937173,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"MetadataManager.getMetadataSyncPromise: metadata is sync, return resolved promise."),Promise.resolve(kt(lr)))},isMetadataSync:function(){return!pr},serializeMetadata:function(e){return sr.serializeMetadata(e)},deserializeMetadata:function(e){return sr.deserializeMetadata(e)}};function mr(e){try{if(e&&0!==ue(e)){const t=e.getItem("metadata");lr=sr.deserializeMetadata(t),c().ULS.traceTag(595730650,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`MetadataManager.onMetadataChanged: set cached metadata with value ${yr(lr)}`)}else c().ULS.traceTag(595730649,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"MetadataManager.onMetadataChanged: set empty cached metadata because clipboardItems were not found"),lr={}}catch(e){c().ULS.traceTag(595945248,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`MetadataManager.onMetadataChanged: failed to parse metadata string with error: ${n.Wp.getStringifiedError(e)}`),lr={}}fr(kt(lr))}function fr(e){c().ULS.traceTag(595730651,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`MetadataManager.updateListenerForMetadataChanged: update listeners with metadata : ${yr(e)}`);for(const t in dr){const r=dr[t];r&&r(e)}}function hr(e,t){const r=Xe();pr?pr.metadataSyncMessageId=r:(pr={metadataSyncMessageId:r,deferredPromise:ct()},c().ULS.traceTag(595937176,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`MetadataManager.scheduleMetadataUpdate: _syncMetadata created. ${pr.metadataSyncMessageId}`)),c().ULS.traceTag(595937177,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`MetadataManager.scheduleMetadataUpdate: set metadata request was sent with message id ${r}.`),setTimeout((()=>{nr.set(e,{}).then((()=>{lr=t,c().ULS.traceTag(595937178,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`MetadataManager.scheduleMetadataUpdate: set metadata successfully. messageId=${r}. _syncMetadata.metadataSyncMessageId = ${pr&&pr.metadataSyncMessageId}. newMetadata = ${yr(t)}`),gr(r)}),(e=>{c().ULS.traceTag(595945250,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`MetadataManager.updateMetadata: failed to update metadata store with error: ${n.Wp.getStringifiedError(e)}`),gr(r)}))}),0)}function gr(e){if(c().ULS.traceTag(595730655,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`MetadataManager.notifyMetadataSyncIfNeeded: start notifyMetadataSyncIfNeeded with messageId: ${e}`),pr&&pr.metadataSyncMessageId===e){const e=pr;pr=void 0;const t=kt(lr);c().ULS.traceTag(595730656,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`MetadataManager.notifyMetadataSyncIfNeeded: resolve with metadata: ${yr(t)}`),fr(t),e.deferredPromise.resolve(t)}}function yr(e){return e?e.lastCopy?`copyContext.id=${e.lastCopy.id}`:"copy context is null":"metadata is null"}const Sr="ccp_infra_version=['|\"](\\d+)['|\"]";class br{wrapTextWithDataSignature(e,t,r,o="null",a){const i={ccp_infra_version:3,ccp_infra_timestamp:r,ccp_infra_user_hash:this.userHash,ccp_infra_copy_id:o};let n;return n=null!==a&&0!==Object.keys(a).length?{...i,...a}:i,n[Zt]=r,function(e,t,r){let o="";return r&&(o=Object.keys(r).reduce(((e,t)=>t?`${e} ${t}='${r[t]}'`:e),"")),`<${t}${o}>${e}</${t}>`}(e,t,n)}ensureDataSignatureInHtmlItem(e){if(0===ue(e))return;const t=Se(e),r=ge(t,se),o=ge(t,"metadata/additional-signature-data-attributes");let a=null;if(o!==d&&(a=JSON.parse(o)),e.hasDeferredItem(oe)){const t=e.getDeferredItem(oe);if(t){const o=t.then((e=>e.text())).then((e=>void 0!==this.getRegExIntValue(e,Sr)?new Blob([e],{type:oe}):new Blob([this.wrapTextWithDataSignature(e,"div",Date.now(),r,a)],{type:oe})));return void e.setDeferredItem(oe,o)}}else{const o=ge(t,oe);if(o){if(void 0!==this.getRegExIntValue(o,Sr))return;return void e.setItem(oe,this.wrapTextWithDataSignature(o,"div",Date.now(),r,a))}}if(e.hasDeferredItem(te)){const t=e.getDeferredItem(te);if(t){const o=t.then((e=>e.text())).then((e=>{const t=Yt(e),o=this.wrapTextWithDataSignature(t,"pre",Date.now(),r,a);return new Blob([er(o)],{type:oe})}));e.setDeferredItem(oe,o)}}else{const o=Yt(ye(t)),i=this.wrapTextWithDataSignature(o,"pre",Date.now(),r,a);e.setItem(oe,er(i))}}extractSignatureData(e){if(pe(e)>0){const t=fe(e,oe),r=this.getRegExIntValue(t,Sr);if(void 0===r)return this.parsePreSignatureData(t);if(this.blockMismatchDataVersion&&3!==r)throw c().ULS.traceTag(595902983,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`clipboardDataManager.extractSignatureData: block mismatch version. dataVer = ${r}, CCPInfraVersion = 3`),new A("ClipboardDataManagerImpl.extractSignatureData",r,3,this.blockMismatchDataVersion);return r<3?(c().ULS.traceTag(595902986,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`clipboardDataManager.extractSignatureData: got data with older version then app version: dataVer = ${r}, CCPInfraVersion = 3. Converting to the data`),this.parseOldSignatureData(t)):(r>3&&c().ULS.traceTag(595900176,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`clipboardDataManager.extractSignatureData: got data with newer version then app version: dataVer = ${r}, CCPInfraVersion = 3. ( It's OK - Should be forward compatibility)`),this.parseCurrentVersionSignatureData(t))}}parseCurrentVersionSignatureData(e){const t=this.getRegExIntValue(e,"\\s+ccp_infra_timestamp=['|\"](\\d+)['|\"]"),r=this.getRegExIntValue(e,"\\s+ccp_infra_user_hash=['|\"](\\d+)['|\"]");if(void 0!==t&&void 0!==r){const o=this.getRegExStringValue(e,"\\s+ccp_infra_copy_id=['|\"]([\\w-]+)['|\"]");return o&&c().ULS.traceTag(595183181,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`clipboardDataManager.parseCurrentVersionSignatureData: copy ID of legacy paste cross session : ${o}`),{ccp_infra_version:3,ccp_infra_timestamp:t,ccp_infra_user_hash:r,ccp_infra_copy_id:o||""}}c().ULS.traceTag(595902985,n.nh.msoulscat_ES_EWAJS,n.kp.Error,`clipboardDataManager.extractSignatureData: Failed to extract SignatureData. textHtmlItem: ${e}`)}parseOldSignatureData(e){return this.parseCurrentVersionSignatureData(e)}parsePreSignatureData(e){const t=function(e){const t=function(e,t){if(!e||!e.trim())return;if(!t||!t.trim())throw new P(d,"attributeName");const r=new RegExp(`${t}=['"](\\d+)['"]`,"i").exec(e);return!r||r.length<2?void 0:r[1]}(e,Zt);if(!t||!t.trim())return;const r=Number(t);return!r&&0!==r||isNaN(r)?void 0:r}(e);if(c().ULS.traceTag(595723668,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`clipboardDataManager.parsePreSignatureData: dataTimeStamp=${t}`),t){if(this.blockMismatchDataVersion)throw c().ULS.traceTag(595899270,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,"clipboardDataManager.parsePreSignatureData: block mismatch version. block pre signature data"),new A("ClipboardDataManagerImpl.extractSignatureData",NaN,3,this.blockMismatchDataVersion);const e={ccp_infra_version:3,ccp_infra_timestamp:t,ccp_infra_user_hash:0};return c().ULS.traceTag(595723669,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"clipboardDataManager.parsePreSignatureData"),e}}validateTTL(e){if(e&&this.ttlInMs){const t=Date.now()-e.ccp_infra_timestamp;if(t>this.ttlInMs)throw c().ULS.traceTag(595899858,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`Time elapsed (${t} ms) from setting Clipboard (${e.ccp_infra_timestamp}) is greater then TTL (${this.ttlInMs} ms) - return error`),new M("clipboardDataManager.validateTTL validation failed",t,this.ttlInMs)}}validateUserHash(e){if(e&&e.ccp_infra_user_hash!==this.userHash)throw c().ULS.traceTag(595723670,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,"clipboardDataManager.validateUserHash: user hash mismatch detected. throw error"),new x("clipboardDataManager.validateUserHash validation failed",e?e.ccp_infra_user_hash:0,this.userHash)}setMetaDataVersionItem(e){if(0===ue(e))return;e.setItem(ne,JSON.stringify({ccp_infra_version:3}))}validateMetaDataVersionItem(e){if(e&&ue(e)>0){const t=fe(e.getData(),ne);let r;try{r=JSON.parse(t)}catch(e){if(!this.blockMismatchDataVersion)return;throw c().ULS.traceTag(595899272,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`clipboardDataManager.validateMetaDataVersionItem: failed parse SignatureMetaData. error = ${e}`),new k(`ClipboardDataManagerImpl.validateMetaDataVersionItem: failed parse SignatureMetaData. SignatureMetaData text = ${t}`)}if(this.blockMismatchDataVersion&&3!==r.ccp_infra_version)throw c().ULS.traceTag(595899203,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`clipboardDataManager.validateMetaDataVersionItem: block mismatch version. dataVer = ${r.ccp_infra_version}, CCPInfraVersion = 3`),new A("ClipboardDataManagerImpl.validateMetaDataVersionItem",r.ccp_infra_version,3,this.blockMismatchDataVersion)}}createClipboardDataProcessor(e){return c().ULS.traceTag(595723671,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`clipboardDataManager.createClipboardDataProcessor: get called. validateUserHash=${e}`),{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:(t=>{if(c().ULS.traceTag(595723672,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`clipboardDataManager.createClipboardDataProcessor.postGet: get called. validateUserHash=${e}`),t){const r=this.extractSignatureData(t.getData());c().ULS.traceTag(595723673,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`clipboardDataManager.createClipboardDataProcessor.postGet: clipboardItems not empty. validateUserHash=${e}`),r&&t.setItem(se,r.ccp_infra_copy_id),this.validateTTL(r),e&&(c().ULS.traceTag(595723674,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`clipboardDataManager.createClipboardDataProcessor.postGet: going to validate user hash. validateUserHash=${e}`),this.validateUserHash(r))}}).bind(this)}}createDualClipboardDataProcessor(e){return c().ULS.traceTag(595723675,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"clipboardDataManager.createDualClipboardDataProcessor: get called."),{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:(e=>{c().ULS.traceTag(595723676,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"clipboardDataManager.createDualClipboardDataProcessor.postGet: get called."),e&&e.clipboardItemsData&&(e.signatureData=this.extractSignatureData(e.clipboardItemsData),e.signatureData&&(e.clipboardItemsData.items[se]=e.signatureData.ccp_infra_copy_id),this.validateTTL(e.signatureData))}).bind(this),validateUserHash:e?this.validateUserHash.bind(this):()=>{}}}createClipboardMetaDataProcessor(){return{preSetProcess:this.setMetaDataVersionItem.bind(this),postGetProcess:this.validateMetaDataVersionItem.bind(this)}}getRegExStringValue(e,t){const r=new RegExp(t,"g").exec(e);if(r&&r.length&&r.length>1)return r[1]}getRegExIntValue(e,t){const r=this.getRegExStringValue(e,t);if(r){const e=Number(r);return isNaN(e)?void 0:e}}constructor(e,t,r){this.ttlInMs=t,this.blockMismatchDataVersion=r,e?this.userHash=n.Wp.calcHashCode(e):(this.userHash=1565411791,c().ULS.traceTag(595903939,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,"userId not exist!. Use default ID"))}}class Cr extends yt{init(e){var t,r;return this.deferredResultMessagePromiseCache=new mt,this.sender=(t=this.serializer,new wt(t,this)),this.receiver=(r=this.deserializer,new Et(r,this,this)),this.postInitMessage(e).catch((e=>(c().ULS.traceTag(596129250,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Init failure or timeout. Error: ${n.Wp.getStringifiedError(e)}`),b(e,h.IframeInitializationTimeout)?Promise.reject(e):Promise.reject(new R(h.IframeInitialization,"failed to init the Shared Clipboard",e)))))}registerPushMessageListener(e,t){this.pushMessageListeners[e]=t}postInitMessage(e){const t=et(ft,"init",tt.initIframe);if(!this.deferredResultMessagePromiseCache){const e="RPC Client - postInitMessage: this.deferredResultMessagePromiseCache should be defined";return c().ULS.shipAssertTag(596121487,n.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new I(e))}const r=this.postMessage(t),o=this.deferredResultMessagePromiseCache.getDeferredPromise(t.id),a=Date.now();return setTimeout((()=>{if(o&&!o.fulfilled()){const e=Date.now(),t=`initialization started on ${new Date(a)} and timed out on ${new Date(e)} after ${e-a} ms`;c().ULS.traceTag(596129251,n.nh.msoulscat_ES_EWAJS,n.kp.Info,t),o.reject(new R(h.IframeInitializationTimeout,t))}}),e),r}postMessage(e){try{if(!e)throw new P(d,"outgoingMessage");if(c().ULS.shipAssertTag(596452175,n.nh.msoulscat_ES_EWAJS,!!e.id,"postMessage: outgoingMessage.id must be defined"),super.postMessage(e),!this.deferredResultMessagePromiseCache){const e="RPC Client - postMessage: this.deferredResultMessagePromiseCache should be defined";throw c().ULS.shipAssertTag(596121488,n.nh.msoulscat_ES_EWAJS,!1,e),new I(e)}return this.deferredResultMessagePromiseCache.addNewPromise(e.id).promise}catch(t){return Promise.reject(new I(`Unable to post message for operation '${e?e.operationCode:void 0}'`,t))}}handleMessage(e){c().ULS.traceTag(596452376,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`RPC Client - handleMessage: incomingMessage.id='${e&&e.id}'; incomingMessage.operationCode='${e&&e.operationCode}'; incomingMessage.failed='${e&&e.failed}'; incomingMessage.error='${e&&e.error}'; incomingMessage.clipboardItems.length=${pe(e&&e.clipboardItemsData)}`);const t=this.pushMessageListeners[e.operationCode];if(t)return t(e.clipboardItemsData),Promise.resolve();if(!this.deferredResultMessagePromiseCache){const e="RPC Client - handleMessage: this.deferredResultMessagePromiseCache should be defined";return c().ULS.shipAssertTag(596121489,n.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new I(e))}const r="initresult"===e.operationCode?ft:e.id,o=this.deferredResultMessagePromiseCache.getDeferredPromise(r);return o?(this.deferredResultMessagePromiseCache.delete(r),e.failed?o.reject(e.error):o.resolve(e),Promise.resolve()):(c().ULS.traceTag(596452377,n.nh.msoulscat_ES_EWAJS,n.kp.Info,r===e.id?`RPC Client - handleMessage: no deferred promise with id '${e.id}'; dropping this result.`:`RPC Client - handleMessage: no deferred promise with id '${r}' for message id '${e.id}'; dropping this result.`),Promise.resolve())}handleDeserializationError(e){return!e||"NoValidKeyError"!==e.errorName||this.deferredResultMessagePromiseCache&&0!==this.deferredResultMessagePromiseCache.getLength()?(c().ULS.traceTag(596452379,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`RPC Client - handleDeserializationError. There are ${this.deferredResultMessagePromiseCache?this.deferredResultMessagePromiseCache.getLength():0} deferred promise(s) in the cache. Error: ${n.Wp.getStringifiedError(e)}`),Promise.resolve()):(c().ULS.traceTag(542687372,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`RPC Client - handleDeserializationError. Error: ${n.Wp.getStringifiedError(e)}`),Promise.resolve())}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(F([()=>{this.deferredResultMessagePromiseCache&&this.deferredResultMessagePromiseCache.clear()}]),super.dispose())}constructor(e,t,r){super(e,t,r,"WindowRPCClientInternal"),this.pushMessageListeners={}}}const Er=[],wr="load",_r="clipboard",vr="clipboard/shared.aspx",Pr="corrid",Tr={initialized:!1,origin:d,src:d,deferredPromise:void 0};let Ir,Ar;function Mr(){return Tr}function xr(){if(Ir){try{Ir()}catch{}Ir=void 0}}function kr(e){return Ar||(Ar=Mr()),Ar.initialized||(Ar.origin=function(e){Ze();const t=Be(e);let r=t.split(Oe);if(!r||2!==r.length||!r[0]||!r[1])throw new T("Invalid origin","parentOrigin",e);const o=Le();let a=d;if(o.whitelistOriginComponents){const t=r[0]+Oe;if(r=r[1].split(Fe),!r||r.length<2||!r[0])throw new T("Invalid origin","parentOrigin",e);r.splice(0,1,o.sharedClipboardHostingApp),a=t+r.join(Fe)}else a=t;return c().ULS.traceTag(596452424,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`getSharedClipboardValidatedOrigin: app's origin = '${e}'; Shared Clipboard iframe origin = '${a}' components=${JSON.stringify(r)}`),a}(e),Ar.src=function(e){const t=Mr().origin;let r=t;"/"!==t.charAt(t.length-1)&&(r+="/"),r+=vr,e&&(r+=`?${encodeURIComponent(ht)}=${encodeURIComponent(e)}`);const o=[];Er.forEach((e=>{(0,rr.isChangeGateEnabled)(e)||o.push({key:e,value:"1"})}));const a=function(){if(!or)throw new I("ClipboardPlatformSettings is not ready. Call ClipboardPlatformEnvironment.init(...).");return or}();a&&(a.sessionId&&o.push({key:Pe,value:a.sessionId}),a.bulsEndpointUrl&&o.push({key:ve,value:a.bulsEndpointUrl}));const[i,s]=(0,n.kA)();return c().ULS.traceTag(595722560,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`getValidatedIframeSrc.getValidatedIframeSrc: Generate correlation if for loading the shared clipboard frame. CorrelationId: ${i} newGuidLogging: ${s}`),o.push({key:Pr,value:i}),o.push({key:"NoAuth",value:"true"}),o.length>0&&o.forEach((e=>{r+=r.indexOf("?")>=0?"&":"?",r+=`${encodeURIComponent(e.key)}=${encodeURIComponent(e.value)}`})),r}(e),Ar.initialized=!0),Ar.origin}function Lr(){if(!Ar)return Promise.reject("state in undefined, please make sure to call initialize first");let e=function(){if(!Mr().initialized)throw new I("getIframe: the initialize function should be called beforehand");const e=document.getElementsByTagName("iframe");if(e&&0!==e.length){c().ULS.traceTag(595952723,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`getIframe: found ${e.length} iframes`);for(let t=0;t<e.length;t+=1){const r=e[t];if(r&&r.id&&r.id===_r)return r}c().ULS.traceTag(595952724,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"getIframe: the CCP iframe does not exist")}else c().ULS.traceTag(595952722,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"getIframe: found no iframes")}();e&&(c().ULS.traceTag(596448770,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`ensureIframeWindow: The CCP iframe exists. Removing the iframe and re-adding it. iframe.src ${void 0!==e.src&&void 0!==Ar.src&&e.src.toLowerCase()===Ar.src.toLowerCase()?"===":"!=="} src; deferredPromise ${void 0===Ar.deferredPromise?"does not exist":"exists"}; The iframe's content window ${void 0===e.contentWindow?"does not exist":"exists"}.`),function(e){if(!e)throw new P(d,"iframe");c().ULS.traceTag(595952725,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,"removeIframe: removing the CCP iframe"),xr(),e.parentNode&&e.parentNode.removeChild(e)}(e),e=void 0);let t=Ar.deferredPromise,r=t?t.id:d;if(t){xr(),Ar.deferredPromise=void 0;const e=`ensureIframeWindow: the CCP iframe does not exist and the deferred promise of its content window should not exist as well. Rejecting deferred promise id '${r}' and creating a new one`;c().ULS.shipAssertTag(596453587,n.nh.msoulscat_ES_EWAJS,!1,e),t.reject(new I(e)),t=void 0}Ar.deferredPromise=ct(Xe()),t=Ar.deferredPromise,r=t.id;try{e=function(){const e=document.createElement("iframe");return e.style.display="none",e.id=_r,c().ULS.shipAssertTag(595952726,n.nh.msoulscat_ES_EWAJS,!Ir,"createIframe: the last shared clipboard iframe's onload event listener should have been removed. Removing it and registering a new event listener."),xr(),Ir=ee(e,wr,(e=>function(e){c().ULS.traceTag(595952727,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"CCP iframe onload event: Entering"),xr();const t=Mr().deferredPromise;if(!t)return void c().ULS.shipAssertTag(595952728,n.nh.msoulscat_ES_EWAJS,!1,"CCP iframe onload event: the CCP iframe does not have a matching deferred promise to notify subscribers when the iframe loaded");const r=t.id;try{Mr().deferredPromise=void 0;const o=e.target;if(!o){const e=`CCP iframe onload event: the CCP iframe should exist when its onload event is called. Rejecting deferred promise id '${r}'`;return c().ULS.shipAssertTag(595952729,n.nh.msoulscat_ES_EWAJS,!1,e),void t.reject(new I(e))}if(!o.contentWindow){const e=`CCP iframe onload event: the contentWindow of the CCP iframe does not exist. Rejecting deferred promise id '${r}'`;return c().ULS.shipAssertTag(595952730,n.nh.msoulscat_ES_EWAJS,!1,e),void t.reject(new I(e))}c().ULS.traceTag(595952732,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CCP iframe onload event: resolving deferred promise id '${r}' with the iframe`),t.resolve(o)}catch(e){const o=`iframeOnLoad: an error has occurred: [${n.Wp.getStringifiedError(e)}]. Rejecting deferred promise id '${r}'`;c().ULS.traceTag(595952733,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,o),t.reject(new I(o,e))}}(e))),e.src=Mr().src,e}(),document.getElementsByTagName("body")[0].appendChild(e)}catch(e){const t=`ensureIframeWindow: unable to create and/or add a CCP iframe. Dropping tentative deferred promise id '${r}'`;return c().ULS.traceTag(596453588,n.nh.msoulscat_ES_EWAJS,n.kp.Error,t),Ar.deferredPromise=void 0,xr(),Promise.reject(new I(t,e))}return t&&!t.fulfilled()?t.promise:(xr(),e.contentWindow?(Ar.deferredPromise=void 0,Promise.resolve(e)):(c().ULS.shipAssertTag(596453589,n.nh.msoulscat_ES_EWAJS,!1,`ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '${r}'`),Promise.reject(new I(`ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '${r}'`))))}let Dr,Wr;function Or(){if(Wr)return Wr.promise;Wr=ct(Xe());try{const e=kr(We().origin);Dr=function(e,t){return new Cr(function(e){if(!e)throw new P(d,"validator");return{serialize:t=>function(e,t){if(!e)throw new P(d,"outgoingMessage");if(!t)throw new P(d,"validator");return t(e),function(e){let t;try{t=JSON.stringify(e)}catch(t){throw new T("Serialization failed","outgoingMessage",`${Object.keys(e).length} properties`,t)}return c().ULS.traceTag(596452375,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`The length of the serialized message is ${t.length}`),t}(e)}(t,e)}}(rt),function(e){if(!e)throw new P(d,"validator");return{deserialize:t=>function(e,t){if(!e)throw new P(d,"incomingMessage");if(!t)throw new P(d,"validator");if(0===e.length)throw new T("An empty message is invalid","incomingMessage");const r=e.trim();if(0===r.length)throw new T("A message cannot contain only spaces","incomingMessage");let o;try{o=JSON.parse(r)}catch(t){throw new T("Deserialization failed","incomingMessage",`Contains ${e.length.toString()} characters`,t)}if(!o)throw new T("Deserialization returned nothing","incomingMessage");return t(o),o}(t,e)}}(at),{window:void 0,windowOrigin:e})}(e),n.Wp.retry(((e,t)=>function(e,t){if(!Dr){const e="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";return c().ULS.shipAssertTag(595947544,n.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new I(e))}const r=n.TZ.start(`Iframe_initialize_${e}`);n.TZ.mark(r,"start"),Dr.remoteWindow.window=void 0;const o=o=>{const a=b(o,h.IframeInitializationTimeout)?` due to a timeout of approx. ${t} ms`:d;n.TZ.mark(r,"finish_error"),n.TZ.failure(r,(e=>c().ULS.traceTag(596452419,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,e)),`Attempt #${e} failed to initialize an iframe ${a}. ${e<3?"Retrying...":"No more retries!"}. Error: ${n.Wp.getStringifiedError(o)}`)},a=ct();return Lr().then((a=>{if(n.TZ.mark(r,"iframe_loaded"),n.TZ.mark(r,"iframe_waiting_for_idb_init"),!Dr){const e="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";c().ULS.shipAssertTag(595947545,n.nh.msoulscat_ES_EWAJS,!1,e);const t=new I(e);return o(t),Promise.reject(t)}if(!a.contentWindow){const e="clipboardIframeLoader::initializeIframe - remoteWindow.contentWindow should be defined";c().ULS.shipAssertTag(595903557,n.nh.msoulscat_ES_EWAJS,!1,e);const t=new I(e);return o(t),Promise.reject(t)}return Dr.remoteWindow.window=a.contentWindow,Dr.init(t).then((()=>(n.TZ.mark(r,"iframe_idb_init_complete"),n.TZ.mark(r,"finish"),n.TZ.success(r,(e=>c().ULS.traceTag(596452418,n.nh.msoulscat_ES_EWAJS,n.kp.Info,e)),`Attempt #${e} initialized iframe`),Promise.resolve())))})).then((()=>{a.resolve()}),(e=>{o(e),a.reject(e)})),a.promise}(e,2e4+(b(t,h.IframeInitializationTimeout)?5e3:0)*(e-1))),3).then((()=>{Wr.resolve(Dr)}),(e=>{Wr.reject(e)}))}catch(e){Wr.reject(e)}return Wr.promise}class $r{innerInitialize(){return Or().then((e=>(this.initialized=!0,this.windowRPCClient=e,this)))}registerPushMessageListener(e,t){this.windowRPCClient&&this.windowRPCClient.registerPushMessageListener(e,t)}postMessage(e,t){if(!this.initialized)return Promise.reject(new R(h.IframeInitialization));const r=n.TZ.start(`BaseIframeProxy_${t}`);n.TZ.mark(r,"start");const o=e=>(n.TZ.mark(r,"finish_error"),n.TZ.failure(r,(e=>c().ULS.traceTag(596452188,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,e)),`Failed in BaseIframeProxy.postMessage. Error: ${n.Wp.getStringifiedError(e)}`),Promise.reject(new R(h.IframeProxyGeneralError,"Failed in BaseIframeProxy.postMessage",e)));if(!this.windowRPCClient){const e="BaseIframeProxy.postMessage - this.windowRPCClient should be defined";return c().ULS.shipAssertTag(595944461,n.nh.msoulscat_ES_EWAJS,!1,e),o(new I(e))}return this.windowRPCClient.postMessage(e).then((e=>(c().ULS.shipAssertTag(595944462,n.nh.msoulscat_ES_EWAJS,!!e,"BaseIframeProxy.postMessage: postMessage must have returned a result message"),e?e.failed?Promise.reject(new R(h.IframeProxyGeneralError,`BaseIframeProxy.postMessage: the operation failed. Error: ${e.error}`)):(n.TZ.mark(r,"finish"),n.TZ.success(r,(e=>c().ULS.traceTag(596452187,n.nh.msoulscat_ES_EWAJS,n.kp.Info,e))),Promise.resolve(e)):Promise.reject(new R(h.IframeProxyEmptyResultMessage,"BaseIframeProxy.postMessage: postMessage succeeded but returned nothing"))))).catch((e=>o(e)))}constructor(){this.initialized=!1}}class Rr{initialize(e){return new Wt(this.localStorageKey,e,(e=>{this._onMetadataChangedListener&&this._onMetadataChangedListener(e)})),Promise.resolve()}setOnMetadataChangedListener(e){c().ULS.traceTag(595716297,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),c().ULS.shipAssertTag(595716298,n.nh.msoulscat_ES_EWAJS,!!e,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=e}constructor(e){this.localStorageKey=e}}class Fr extends $r{initialize(e){return super.innerInitialize().then((()=>{this.registerPushMessageListener("getMetadata_longPollingresult",(e=>{this._onMetadataChangedListener&&this._onMetadataChangedListener(me(e))}))}))}setOnMetadataChangedListener(e){c().ULS.traceTag(595730647,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"LongPollingMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),c().ULS.shipAssertTag(595944466,n.nh.msoulscat_ES_EWAJS,!!e,"LongPollingMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=e}}class Ur extends nt{constructor(e){super(m.SystemClipboard,{browserStorage:!1,systemClipboard:!0,inMemory:!1},e)}}let jr=!0;function Nr(){return jr}function zr(){jr=!1}let Hr=!0;function Jr(){return Hr}function Br(){Hr=!1}function Vr(){let e;try{e=window.clipboardData}catch(e){c().ULS.traceTag(595985225,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`ieSystemClipboard.getDataTransfer: An error occurred when attempting to access window.clipboardData. Error: ${n.Wp.getStringifiedError(e)}`)}return e}function Gr(){if(c().ULS.shipAssertTag(596455701,n.nh.msoulscat_ES_EWAJS,V(),"The browser must be IE"),!V())throw new I("The browser must be IE")}function Kr(e){return!!e}function Zr(e){if(!e)return void c().ULS.traceTag(596456320,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"A clipboard event parameter is missing");let t;try{t=e.clipboardData}catch(e){throw c().ULS.traceTag(595985224,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`systemClipboard.getDataTransfer: An error occurred when attempting to access rawEvent.clipboardData. Error: ${n.Wp.getStringifiedError(e)}`),e}return t}function qr(e,t,r,o){let a=!1;try{const o=Zr(r);if(!o||!Kr(o))return c().ULS.traceTag(596456264,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`setData - programmatic ${Z} and ${q} is broken. There is no valid data transfer object. clipboardDataFormat = '${e}'`),!1;a=o.setData(e,t),!1===a&&c().ULS.traceTag(596456265,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`setData returned false for '${e}'.`)}catch(t){c().ULS.traceTag(596456266,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`setData with '${e}' threw an exception: ${n.Wp.getStringifiedError(t)}`)}return void 0===a&&(a=!0),a}function Xr(e,t,r,o){if(Gr(),!o&&!Nr()&&!Jr())return c().ULS.traceTag(596456269,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`setData - programmatic ${Z} and ${q} clipboard access is not supported. rawEvent is empty = ${!!r}`),!1;const a=Vr();if(!a||!Kr(a))return c().ULS.traceTag(596456270,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`setData - ${Z} and ${q} is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '${e}'`),o||(c().ULS.shipAssertTag(596456271,n.nh.msoulscat_ES_EWAJS,Nr()&&Jr(),`setData - programmatic ${Z} and ${q} is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '${Nr()}'. isProgrammaticAccessSupported = '${Jr()}'. clipboardDataFormat = '${e}'`),zr(),Br()),!1;let i,s=e;s===te&&(s=re);try{i=a.setData(s,t),!1===i&&c().ULS.traceTag(596456272,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`setData returned false for '${s}'.`)}catch(e){c().ULS.traceTag(596456273,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`setData with '${s}' threw an exception: ${e.message}`)}return!o&&Nr()&&(zr(),!1===i&&Br()),void 0===i&&(i=!0),i}function Yr(){return Nr()&&Xr(te,d,void 0,!1),!!Jr()||(c().ULS.traceTag(596456274,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`document.execCommand - programmatic clipboard access is not allowed for '${Z}' and '${q}'.`),!1)}const Qr={execCommandCopy:function(){let e;try{e=document.execCommand(Z,!1,null)}catch(e){c().ULS.traceTag(596456262,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`document.execCommand('${Z}') threw an exception. This is a browser bug. Ignoring. Exception: ${e.message}`)}return void 0===e&&(e=!0),e},execCommandCut:function(){let e;try{e=document.execCommand(q,!1,null)}catch(e){c().ULS.traceTag(596456263,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`document.execCommand('${q}') threw an exception. This is a browser bug. Ignoring. Exception: ${e.message}`)}return void 0===e&&(e=!0),e},setData:qr,defaultClipboardDataFormat:te},eo={execCommandCopy:function(){if(Gr(),!Yr())return!1;try{document.execCommand(Z,!1,null)}catch(e){c().ULS.traceTag(596456267,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`document.execCommand('${Z}') threw an exception. This is a browser bug. Ignoring. Exception: ${e.message}`)}return!0},execCommandCut:function(){if(Gr(),!Yr())return!1;try{document.execCommand(q,!1,null)}catch(e){c().ULS.traceTag(596456268,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`document.execCommand('${q}') threw an exception. This is a browser bug. Ignoring. Exception: ${e.message}`)}return!0},setData:Xr,defaultClipboardDataFormat:re};let to;function ro(e,t,r,o){return oo().setData(e,t,r,o)}function oo(){return void 0===to&&(to=Qr),to}V()&&(to=eo);const ao="command",io="getClipboardData",no="getAvailableCommands";let so;const co={};function lo(){if(void 0===so&&(so=!1,"chrome"in window)){const e=window.chrome;e&&("runtime"in e&&e.runtime?"sendMessage"in e.runtime&&e.runtime.sendMessage?so=!0:c().ULS.traceTag(596455703,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,"chrome.runtime.sendMessage is not available"):c().ULS.traceTag(596455704,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"chrome.runtime is not available"))}return so}function po(e){if(!e||!e.items)return Promise.reject(new O(y.ClipboardIsInaccessible,`getImageDataUrlFromClipboardData: clipboardData is undefined=${!e} clipboardData.items is undefined=${!e.items}`));for(let t=0;t<e.items.length;t+=1){const r=e.items[t].type&&e.items[t].type.startsWith("image");if(r||c().ULS.traceTag(528859143,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"Non-image type read from System Clipboard. File Type is "+e.items[t].type),"file"===e.items[t].kind&&r)return uo(e.items[t].getAsFile())}return Promise.resolve(d)}function uo(e){const t=n.TZ.start("ImageFile_Read_From_Clipboard"),r=e?e.size:-1,o=ct(),a=new FileReader;return a.onload=()=>{a.result?(n.TZ.success(t,(e=>c().ULS.traceTag(595911452,n.nh.msoulscat_ES_EWAJS,n.kp.Info,mo(e,r)))),o.resolve(a.result.toString())):(n.TZ.failure(t,(e=>c().ULS.traceTag(595911453,n.nh.msoulscat_ES_EWAJS,n.kp.Info,mo(e,r)))),o.reject(new O(y.FileReaderResultIsEmpty,"getImageDataUrlFromClipboardData: FileReader result is null or undefined")))},a.onerror=()=>{n.TZ.failure(t,(e=>c().ULS.traceTag(595911454,n.nh.msoulscat_ES_EWAJS,n.kp.Info,mo(e,r)))),o.reject(new O(y.FileReaderFailed,"getImageDataUrlFromClipboardData: FileReader failed"))},n.TZ.mark(t,"Starting_readAsDataURL"),a.readAsDataURL(e),o.promise}function mo(e,t){const r=JSON.parse(e);return r.filesize=t,JSON.stringify(r)}function fo(e,t,r){if(Gr(),!r&&!Nr()&&!Jr())return c().ULS.traceTag(596456327,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`getData - programmatic ${X} clipboard access is not supported. rawEvent is empty = ${!!t}`),Promise.resolve(d);const o=Vr();if(!o||!Kr(o))return c().ULS.traceTag(596456328,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`getData - ${X} is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '${e}'`),r||(c().ULS.shipAssertTag(596456329,n.nh.msoulscat_ES_EWAJS,Nr()&&Jr(),`getData - programmatic ${X} is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '${Nr()}'. isProgrammaticAccessSupported = '${Jr()}'. clipboardDataFormat = '${e}'`),zr(),Br()),Promise.resolve(d);let a=e;a===te&&(a=re);let i=d;try{i=o.getData(a),i||(i=d),c().ULS.traceTag(596456330,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`getData('${a}') returned ${i.length} characters`)}catch(e){c().ULS.traceTag(596456331,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`getData with '${a}' threw an exception. This is a browser bug. Ignoring. Exception: ${e.message}`)}if(!r&&Nr()&&(zr(),i===d)){if(qr(e," ",void 0))return fo(e,void 0,!1).then((t=>(t===d?Br():qr(e,d,void 0),Promise.resolve(i))));Br()}return Promise.resolve(i)}const ho={init:function(){},execCommandPaste:function(){let e;try{e=document.execCommand(X,!1,null)}catch(e){c().ULS.traceTag(596456322,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`document.execCommand('${X}') threw an exception. This is a browser bug. Ignoring. Exception: ${e.message}`)}return void 0===e&&(e=!0),e},getData:function(e,t,r){let o=d;try{const r=Zr(t);if(!r||!Kr(r))return Promise.resolve(o);if(e===ae)return po(r);o=r.getData(e),o||(o=d),c().ULS.traceTag(596456323,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`getData('${e}') returned ${o.length} characters`)}catch(t){c().ULS.traceTag(596456324,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`getData with '${e}' threw an exception. This is a browser bug. Ignoring. Exception:: ${n.Wp.getStringifiedError(t)}`)}return Promise.resolve(o)},browserExtensionPaste:function(){return Promise.reject(new R(h.NoBrowserExtensionsInConfiguration))}},go={init:function(){},execCommandPaste:function(){if(Gr(),Nr()&&fo(te,void 0,!1),!Jr())return c().ULS.traceTag(596456325,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`document.execCommand - programmatic clipboard '${X}' access is not allowed in this session.`),!1;try{document.execCommand(X,!1,null)}catch(e){c().ULS.traceTag(596456326,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`document.execCommand('${X}') threw an exception. This is a browser bug. Ignoring. Exception: ${e.message}`)}return!0},getData:fo,browserExtensionPaste:function(){return Promise.reject(new R(h.NoBrowserExtensionsInConfiguration))}},yo={init:function(){!function(){const e=ta().getChromeExtensionIds();if(0===e.length)return;const t={};t[ao]=no,e.forEach((e=>{window.chrome.runtime.sendMessage(e,t,void 0,(t=>{const r=window.chrome.runtime.lastError;if(t&&Array.isArray(t)&&0!==t.length&&!r)co[e]=t;else{let t=d;r&&"message"in r&&"string"==typeof r.message&&(t=r.message),c().ULS.traceTag(589947074,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`chromeSystemClipboard - '${no}': browser extension '${e}' is not available. Error: ${t}`)}}))}))}()},execCommandPaste:function(){let e=!1;try{e=document.execCommand(X,!1,null),void 0===e&&(e=!0)}catch(e){c().ULS.traceTag(596455698,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Chrome: document.execCommand('${X}') threw an exception. This is a browser bug. Ignoring. Exception: ${e.message}`)}return e},getData:function(e,t,r){let o=d;try{const r=Zr(t);if(!r||!Kr(r))return Promise.resolve(o);if(e===ae)return po(r);o=r.getData(e),o||(o=d),c().ULS.traceTag(596455699,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Chrome: getData('${e}') returned ${o.length} characters`)}catch(t){c().ULS.traceTag(596455700,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`Chrome: getData with '${e}' threw an exception. This is a browser bug. Ignoring. Exception:: ${n.Wp.getStringifiedError(t)}`)}return Promise.resolve(o)},browserExtensionPaste:function(){return function(){if(!lo())return Promise.reject(new R(h.MissingBrowserExtensionCapability));const e=function(){for(const e in co)if(co[e].includes(io))return e;return null}();if(!e)return Promise.reject(new R(h.NoBrowserExtensionWithGetClipboardDataCommand));const t={};return t[ao]="getClipboardData",function(e,t){return new Promise(((r,o)=>{let a=!0;window.chrome.runtime.sendMessage(e,t,void 0,(t=>{const i=window.chrome.runtime.lastError;if(!t||"object"!=typeof t||Array.isArray(t)||i){a=!1;let t=d;i&&"message"in i&&"string"==typeof i.message&&(t=i.message),o(new R(h.UnavailableBrowserExtension,`chromeSystemClipboard - '${io}': browser extension '${e}' is not available. Error: ${t}`))}else{a=!1;const e=t,o=e.html,i=e.img,n=e.text,s=function(e,t,r){const o=!!e,a=!!t,i=!!r,n=e.includes("<img src=");return a&&!i||a&&o&&n}(o,i,n);r({text:n,html:s?i:o})}})),setTimeout((()=>{a&&(c().ULS.traceTag(589947076,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`chromeSystemClipboard - getPasteWithExtensionPromise reject the promise after timeout. chromeExtenstionsInfo: '${co}'`),o(new R(h.UnavailableBrowserExtension,`chromeSystemClipboard - '${io}': browser extension '${e}' is not available. Timeout after : 2000 ms`)))}),2e3)}))}(e,t).then((t=>{if(!t)return Promise.reject(new R(h.NoAvailableBrowserExtensions));c().ULS.traceTag(589947075,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`chromeSystemClipboard - paste by browser extension '${e}'`);const r=me();return r.setItem(te,t.text),r.setItem(oe,t.html),r.setItem("metadata/chrome-extension-id",e),r}))}()}};let So;function bo(){return void 0===So&&(So=lo()?yo:ho),So}V()&&(So=go);var Co=r(3498);const Eo=(e,t)=>{if(_o(e))e.replaceChildren(t);else{for(;e.firstChild;)e.removeChild(e.firstChild);wo(e,t)}},wo=(e,t)=>{if(vo(e))e.append(t);else if("string"==typeof t){const r=document.createTextNode(t);e.appendChild(r)}else e.appendChild(t)},_o=e=>!!e.replaceChildren,vo=e=>!!e.append,Po="ccpContentEditable";function To(){const e=document.getSelection();if(e&&e.getRangeAt&&"function"==typeof e.getRangeAt&&!(e.rangeCount<1))return e.getRangeAt(0)}function Io(e,t,r=void 0){c().ULS.shipAssertTag(596444114,n.nh.msoulscat_ES_EWAJS,!1===t&&!r||!0===t&&(!!r||r===d),`enableClipboardEvents: useTextHtmlContentCandidate = '${t}', textHtmlContentCandidate is ${r||r===d?d:"not "}provided`);let o=document.activeElement&&document.activeElement.id;o||c().ULS.traceTag(595719625,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,"hiddenContentEditableDiv.enableClipboardEvents: activeElementIdToRestore must to be define");const a=function(e,t){let r=xo();if(r&&r.tagName&&"div"!==r.tagName.toLowerCase()&&(r.parentElement&&r.parentElement.removeChild(r),r=void 0),r||(r=function(){const e=document.createElement("div");return function(e){e.id=Po,e.contentEditable="true",Do()&&(e.contentEditable="false"),e.spellcheck=!1,e.setAttribute("autocomplete","off"),e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("aria-hidden","true"),e.tabIndex=-1,e.style.display="inline-block",e.style.position="absolute",e.style.fontSize="10",e.style.height="0px",e.style.width="0px",e.style.top="0px",e.style.left="0px",e.style.zIndex="-100",e.style.overflow="hidden",e.onmousemove=()=>{e.onmousemove=null,c().ULS.assertTag(595957699,n.nh.msoulscat_ES_EWAJS,!1,`contentEditableElement.onmousemove: Mouse move event is not expected on element '${Po}'. it should be covered by other elements`)}}(e),document.body.appendChild(e),e}()),V()){let o=t;e?o||(o=d):o=Lo().outerHTML,r.innerHTML=Co.sanitize(o)}else Eo(r,e?t??d:Lo());return r}(t,r);o&&o===a.id&&(o=void 0),a.focus();const i=document.getSelection();if(i){i.removeAllRanges();const e=document.createRange();e.selectNodeContents(a),i.addRange(e)}return e&&Ao(!0),o}function Ao(e){if(!Do())return;const t=xo();t&&(t.contentEditable=e?"true":"false")}function Mo(){const e=xo();if(!e)return!1;try{const t=e.clientLeft+e.scrollWidth/2,r=e.clientTop+e.scrollTop/2,o=document.elementFromPoint(t,r);return!!o&&(o.id===e.id||!!o.parentElement&&o.parentElement.id===e.id)}catch(e){return c().ULS.traceTag(595957534,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`isContentEditableElementVisibleToUser: hit test failed with error: ${n.Wp.getStringifiedError(e)}`),!1}}function xo(){return document.getElementById(Po)}function ko(){const e=xo();e&&(V()?e.innerHTML=Co.sanitize(Lo().outerHTML):Eo(e,Lo()))}function Lo(){const e=document.createElement("span");return e.innerText=p,e}function Do(){return!V()}class Wo{get(e){if(this.disposableImplementationExtension.throwIfDisposed("get"),c().ULS.traceTag(596449096,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`SystemClipboardStorage.get: isKeyboardEvent = '${e.isKeyboardEvent}'`),e.skipSystemClipboardAccess){c().ULS.traceTag(596124883,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"SystemClipboardStorage.get: Skipping system clipboard access");const e=ee(document,Q,(t=>this.skipSystemClipboardPasteHandler(t,e)),!this.isFixTagSpike99teiEnabled||{capture:!0,once:!0});return this.removeLastPasteEventListenerCallback=e,Promise.resolve(de())}if(this.lastDeferredPastePromise&&!this.lastDeferredPastePromise.fulfilled()){const e=this.lastDeferredPastePromise,t=`There exists a pending deferred promise with id '${e.id}', representing an active ${X} event. Scheduling a rejection to execute after the current operation.`;c().ULS.traceTag(596455680,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,t),window.setTimeout((()=>{e.reject(new R(h.RejectingPendingPastePromiseDueToNewPasteOperation,t))}),0)}this.clearPasteCallbackConfiguration(this.lastDeferredPastePromise,!0,!1);const t=ct();this.lastDeferredPastePromise=t;const r=t.id,o=ee(document,Q,(r=>this.pasteHandler(r,t,e.isKeyboardEvent,o)),!this.isFixTagSpike99teiEnabled||{capture:!0,once:!0});this.removeLastPasteEventListenerCallback=o,this.selectedRangeToRestore=To(),this.activeElementIdToRestore=Io(!0,!1);try{let o=!1;if(e.isKeyboardEvent||(o=bo().execCommandPaste()),e.isKeyboardEvent);else if(!o)return this.clearPasteCallbackConfiguration(t,!0,!0),e.isAsyncSystemClipboardEnabled?Promise.reject(new R(h.ClipboardIsInaccessible,`Reject the Promise if not keyboard event in SystemClipboardStorage.get. Deferred promise id = '${r}'`)):bo().browserExtensionPaste().then((t=>(e.isChromiumExtension=!0,e.clearSystemClipboard&&this.clearSystemClipboard(),t)),(t=>(!e.isAsyncSystemClipboardEnabled&&e.clearSystemClipboard&&this.clearSystemClipboard(),Promise.reject(new R(h.ClipboardIsInaccessible,`document.execCommand(${X}) failed in SystemClipboard.get. Deferred promise id = '${r}'`,t)))))}catch(e){return this.clearPasteCallbackConfiguration(t,!0,!1),Promise.reject(new R(h.GetClipboardItems,`Failed in SystemClipboard.get. Deferred promise id = '${r}'`,e))}return t.promise.then((t=>(e.clearSystemClipboard&&this.clearSystemClipboard(),t)),(t=>(e.clearSystemClipboard&&this.clearSystemClipboard(),b(t,h.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(t):Promise.reject(new R(h.GetClipboardItems,`Failed in SystemClipboard.get. Deferred promise id = '${r}'`,t)))))}set(e,t){if(this.disposableImplementationExtension.throwIfDisposed("set"),c().ULS.traceTag(596449097,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`SystemClipboardStorage.set: isKeyboardEvent = '${t.isKeyboardEvent}'; cutCopyPasteFlags = '${t.commandType}'`),c().ULS.shipAssertTag(595932513,n.nh.msoulscat_ES_EWAJS,!t.skipSystemClipboardAccess,"SystemClipboardStorage.set: skipSystemClipboardAccess shouldn't be used using set of SystemClipboardStorage as we have to set the timestamp metadata in the html in order to support last copy item scenario. "),V()&&!t.isKeyboardEvent){if(t.silentClipboardAccessFailures&&Nr())return c().ULS.traceTag(596455681,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"Aborting attempt to store content in the clipboard since silentClipboardAccessFailures is on and the user did not select Allow access in IE's clipboard access dialog"),Promise.resolve();if(!Nr()&&!Jr())return c().ULS.traceTag(596455682,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection."),Promise.resolve()}if(this.lastDeferredCutCopyPromise&&!this.lastDeferredCutCopyPromise.fulfilled()){const e=this.lastDeferredCutCopyPromise,r=`There exists a pending deferred promise with id '${e.id}', representing an active ${q}/${Z} event. Scheduling a rejection to execute after the current operation.`;c().ULS.traceTag(596455683,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,r),window.setTimeout((()=>{e.reject(new R(t.isKeyboardEvent?h.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation:h.RejectingBlockedSyncCutCopyPromise,r))}),0)}this.clearCutCopyCallbackConfiguration(this.lastDeferredCutCopyPromise,!0,!1);const r=ct();this.lastDeferredCutCopyPromise=r;const o=r.id;try{const a=Se(e),i=Wo.getClipboardCutCopyEventType(t.commandType),s=ee(document,i,(e=>{t.isTimestampStoredInSystemClipboard=!0,this.cutCopyHandler(e,r,a,t.isKeyboardEvent,t.commandType,s)}),this.isFixTagSpike99teiEnabled&&{capture:!1,once:!0});this.removeLastCutCopyEventListenerCallback=s;let l=d;V()&&(l=ge(a,oe)),this.selectedRangeToRestore=To(),this.activeElementIdToRestore=Io(!1,!!l,l);let p=!1;if(V()&&t.isKeyboardEvent||(p=t.commandType===we.Cut?oo().execCommandCut():oo().execCommandCopy()),t.isKeyboardEvent);else if(!p)return this.clearCutCopyCallbackConfiguration(r,!0,!0),!V()||Nr()||Jr()||(c().ULS.traceTag(596455684,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection. Deferred promise id = '${o}'`),r.resolve()),Promise.resolve()}catch(e){return this.clearCutCopyCallbackConfiguration(r,!0,!1),Promise.reject(new R(h.SetClipboardItems,`Failed in SystemClipboard.set. Deferred promise id = '${o}'`,e))}return r.promise.catch((e=>e&&C(e,[h.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,h.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.reject(new R(h.SetClipboardItems,`Failed in SystemClipboard.set. Deferred promise id = '${o}'`,e))))}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[te,oe,ae]}cutCopyHandler(e,t,r,o,a,i){try{if(c().ULS.traceTag(596449098,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '${o}'; cutCopyPasteFlags = '${a}'; bubbles = '${e.bubbles}'; eventPhase = '${e.eventPhase}'`),i(),this.removeLastCutCopyEventListenerCallback===i&&(this.removeLastCutCopyEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("cutCopyHandler"))return;if(c().ULS.shipAssertTag(596455686,n.nh.msoulscat_ES_EWAJS,!!t,`SystemClipboardStorage.cutCopyHandler: the deferred promise parameter is missing. isKeyboardEvent = '${o}'; cutCopyPasteFlags = '${a}'`),!t)return;if(c().ULS.traceTag(596455687,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '${o}'; cutCopyPasteFlags = '${a}'; deferred promise id = '${t.id}'`),c().ULS.shipAssertTag(596455688,n.nh.msoulscat_ES_EWAJS,!t.fulfilled(),`SystemClipboardStorage.cutCopyHandler: deferred promise '${t.id}' is already fulfilled. isKeyboardEvent = '${o}'; cutCopyPasteFlags = '${a}'`),t.fulfilled())return;const s=()=>{t.resolve(),this.clearCutCopyCallbackConfiguration(t,!1,!1)},l=ge(r,oe);if(l&&V())window.setTimeout(s,0);else{l&&ro(oe,l,e,o);const t=ye(r);ro(oo().defaultClipboardDataFormat,t,e,o),e.preventDefault(),s()}}catch(e){this.clearCutCopyCallbackConfiguration(t,!1,!1),c().ULS.traceTag(596455689,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`SystemClipboardStorage.cutCopyHandler callback with deferred promise id '${t?t.id:d}' (fulfilled = '${t?t.fulfilled():d}') failed with this exception: ${e&&e.message?e.message:"NA"}. Call stack: ${e.stack?e.stack:"NA"}`),t&&t.reject(new R(h.SetClipboardItems,`Failed in SystemClipboard.set > cutCopyHandler callback. Deferred promise id = '${t.id}'. Error: ${e&&e.message?e.message:"NA"}`,e))}}pasteHandler(e,t,r,o){let a=!0;try{if(c().ULS.traceTag(596449099,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`SystemClipboardStorage.pasteHandler: isKeyboardEvent = '${r}'; eventPhase='${e.eventPhase}'`),e.preventDefault(),o(),this.removeLastPasteEventListenerCallback===o&&(this.removeLastPasteEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("pasteHandler"))return;if(c().ULS.shipAssertTag(596455690,n.nh.msoulscat_ES_EWAJS,!!t,`SystemClipboardStorage.pasteHandler: the deferred promise parameter is missing. isKeyboardEvent = '${r}'`),!t)return;if(c().ULS.traceTag(596455691,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`SystemClipboardStorage.pasteHandler: isKeyboardEvent = '${r}'; deferred promise id = '${t.id}'`),c().ULS.shipAssertTag(596455692,n.nh.msoulscat_ES_EWAJS,!t.fulfilled(),`SystemClipboardStorage.pasteHandler: deferred promise '${t.id}' is already fulfilled. isKeyboardEvent = '${r}'`),t.fulfilled())return;const i=me(),s=this.getSupportedDataFormats(),l=this.readDataFormats(s,e,r,i);Promise.all(l).then((()=>{e.stopPropagation(),a=!1,V()?window.setTimeout((()=>{const e=document.getElementById(Po);if(e&&e.firstChild&&"IMG"===e.firstChild.nodeName){const t=e.firstChild;t&&t.src&&t.src.indexOf("base64")>-1?i.setItem(ae,t.src):c().ULS.traceTag(595907107,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"SystemClipboardStorage.pasteHandler: IE has provided the IMG HTML rather than the image blob, which is unsupported.")}else i.setItem(oe,function(){const e=xo();return c().ULS.shipAssertTag(596444113,n.nh.msoulscat_ES_EWAJS,!!e,"getTextHtmlContent: the content editable element does not exist"),e?Co.sanitize(e.innerHTML):d}()),(r=e)&&r.firstChild&&r.firstElementChild&&r.firstElementChild.getAttribute(Zt)&&i.setItem(te,function(e){const t=[],r=e.getElementsByTagName("tr");if(r.length>0){const e=Qt(r[0]);t.push(e);for(let e=1;e<r.length;e+=1){t.push(Rt),t.push($t);const o=Qt(r[e]);t.push(o)}}return t.join("")}(e));var r;ko(),t.resolve(i),this.clearPasteCallbackConfiguration(t,!1,!1)}),0):(ko(),t.resolve(i),this.clearPasteCallbackConfiguration(t,!1,!1))}))}catch(r){ko();try{a&&e.stopPropagation()}catch(e){c().ULS.traceTag(595985030,n.nh.msoulscat_ES_EWAJS,n.kp.Error,`SystemClipboardStorage.pasteHandler: failed when performing stopPropagation/preventDefault on the raw event. Failed with an exception: ${n.Wp.getStringifiedError(e)}`)}this.clearPasteCallbackConfiguration(t,!1,!1),c().ULS.traceTag(596455693,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`SystemClipboardStorage.pasteHandler callback with deferred promise id '${t?t.id:d}' (fulfilled = '${t?t.fulfilled():d}') failed with an exception: ${r&&r.message?r.message:"NA"}. Call stack: ${r.stack?r.stack:"NA"}`),t&&t.reject(new R(h.GetClipboardItems,`Failed in SystemClipboard.get > pasteHandler callback. Deferred promise id = '${t.id}'. Error: ${r&&r.message?r.message:"NA"}`,r))}}isFileFormat(e){return e===ae}isPlainTextEmpty(e){const t=e.getItem("text/plain");return!t||0===t.length}readDataFormats(e,t,r,o){if(!this.skipFilesIfPlainTextExists||!r&&function(){const e=U();let t=!1;if(e&&e.userAgent){const r=e.userAgent();r&&r.indexOf("Edg/")>=0&&(t=!0)}return t}())return this.readDataFormatsInternal(e,t,r,o);const a=e.filter((e=>this.isFileFormat(e)));if(0===a.length)return this.readDataFormatsInternal(e,t,r,o);const i=e.filter((e=>!this.isFileFormat(e))),s=this.readDataFormatsInternal(i,t,r,o);return[Promise.all(s).then((()=>{if(!this.isPlainTextEmpty(o))return c().ULS.traceTag(595653317,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"SystemClipboardStorage.readDataFormats: skip files loading because clipboard contains plain text"),Promise.resolve();const e=this.readDataFormatsInternal(a,t,r,o);return Promise.all(e)}))]}readDataFormatsInternal(e,t,r,o){const a=[];return e.forEach((e=>{a.push(function(e,t,r){return bo().getData(e,t,r)}(e,t,r).then((t=>{c().ULS.traceTag(541646989,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"SystemClipboardStorage.readDataFormatsInternal: Read "+e+" from clipboard"),o.setItem(e,t)})).catch((t=>{c().ULS.traceTag(595653318,n.nh.msoulscat_ES_EWAJS,n.kp.Error,`SystemClipboardStorage.readDataFormatsInternal: Failed to get data of type [${e}]. Error [${n.Wp.getStringifiedError(t)}]`)})))})),a}skipSystemClipboardPasteHandler(e,t){try{t(),e.stopPropagation(),e.preventDefault()}catch(e){c().ULS.traceTag(595993058,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`SystemClipboardStorage.skipSystemClipboardPasteHandler: failed with an exception: ${e&&e.message?e.message:"NA"}. Call stack: ${e.stack?e.stack:"NA"}`)}this.removeLastPasteEventListenerCallback===t&&(this.removeLastPasteEventListenerCallback=void 0)}hasPlainText(e){return!!e&&Object.keys(e.getData().items).indexOf(te)>-1}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(F([()=>{this.lastDeferredCutCopyPromise&&!this.lastDeferredCutCopyPromise.fulfilled()&&(this.lastDeferredCutCopyPromise.reject(),this.lastDeferredCutCopyPromise=void 0,this.removeLastCutCopyEventListenerCallback&&(this.removeLastCutCopyEventListenerCallback(),this.removeLastCutCopyEventListenerCallback=void 0))},()=>{this.lastDeferredPastePromise&&!this.lastDeferredPastePromise.fulfilled()&&(this.lastDeferredPastePromise.reject(),this.lastDeferredPastePromise=void 0,this.removeLastPasteEventListenerCallback&&(this.removeLastPasteEventListenerCallback(),this.removeLastPasteEventListenerCallback=void 0))}]),this.disposableImplementationExtension.dispose())}static getClipboardCutCopyEventType(e){if(!e)return Y;if(e===we.Copy)return Y;if(e===we.Cut)return"cut";throw new T(d,"cutCopyPasteFlags",e.toString())}restoreFocusToPreviouslyActiveElement(){if(!this.activeElementIdToRestore)return;const e=document.getElementById(this.activeElementIdToRestore);e&&e.focus(),this.activeElementIdToRestore=void 0}restoreSelection(){this.selectedRangeToRestore&&(function(e){if(!e)return;const t=document.getSelection();t&&t.removeAllRanges&&"function"==typeof t.removeAllRanges&&t.addRange&&"function"==typeof t.addRange&&(t.removeAllRanges(),t.addRange(e))}(this.selectedRangeToRestore),this.selectedRangeToRestore=void 0)}clearCutCopyCallbackConfiguration(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),c().ULS.shipAssertTag(595957697,n.nh.msoulscat_ES_EWAJS,!Mo(),"SystemClipboardStorage.set: ccpContentEditable is visible to the user during a copy/cut operation, but it should not be visible."),(e===this.lastDeferredCutCopyPromise||e&&this.lastDeferredCutCopyPromise&&e.id===this.lastDeferredCutCopyPromise.id)&&(this.lastDeferredCutCopyPromise=void 0),t&&this.removeLastCutCopyEventListenerCallback&&(r||c().ULS.traceTag(596449290,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`SystemClipboardStorage.set: the ${q}/${Z} event listener was not called. Calling removeLastCutCopyEventListenerCallback()`),this.removeLastCutCopyEventListenerCallback(),this.removeLastCutCopyEventListenerCallback=void 0)}clearPasteCallbackConfiguration(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),Ao(!1),c().ULS.shipAssertTag(595957698,n.nh.msoulscat_ES_EWAJS,!Mo(),"SystemClipboardStorage.clearPasteCallbackConfiguration: ccpContentEditable is visible to the user during a paste operation, but it should not be visible"),(e===this.lastDeferredPastePromise||e&&this.lastDeferredPastePromise&&e.id===this.lastDeferredPastePromise.id)&&(this.lastDeferredPastePromise=void 0),t&&this.removeLastPasteEventListenerCallback&&(r||c().ULS.traceTag(596449291,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`SystemClipboardStorage.get: the ${X} event listener was not called. Calling removeLastPasteEventListenerCallback()`),this.removeLastPasteEventListenerCallback(),this.removeLastPasteEventListenerCallback=void 0)}clearSystemClipboard(){const e=de(),t={isKeyboardEvent:!1,commandType:we.Copy};this.set(e,t).then((()=>{c().ULS.traceTag(595935906,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard succeed")}),(()=>{c().ULS.traceTag(595935907,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard failed")}))}constructor(e){this.lastDeferredCutCopyPromise=void 0,this.removeLastCutCopyEventListenerCallback=void 0,this.lastDeferredPastePromise=void 0,this.selectedRangeToRestore=void 0,this.removeLastPasteEventListenerCallback=void 0,this.activeElementIdToRestore=void 0,this.skipFilesIfPlainTextExists=e,this.clipboardStorageType=Ce.SystemClipboard,this.disposableImplementationExtension=it("SystemClipboardStorage"),bo().init(),this.isFixTagSpike99teiEnabled=i(0,!1)}}class Oo extends nt{constructor(e){super(m.InMemory,{browserStorage:!1,systemClipboard:!1,inMemory:!0},e)}}class $o{dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.inMemoryClipboardItems=void 0,this.disposableImplementationExtension.dispose())}get(e){return this.disposableImplementationExtension.throwIfDisposed("get"),this.inMemoryClipboardItems?Promise.resolve(this.inMemoryClipboardItems):Promise.resolve(de())}set(e,t){return this.disposableImplementationExtension.throwIfDisposed("set"),this.inMemoryClipboardItems=e,Promise.resolve()}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[te,oe,"data/shadow-workbook"]}constructor(){this.clipboardStorageType=Ce.InMemory,this.disposableImplementationExtension=it("InMemoryClipboardStorage")}}class Ro extends nt{constructor(e){super(m.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},e)}}class Fo{initialize(e,t){return this.initialized=!1,this.systemClipboardStrategy=void 0,this.fullAccessClipboardStrategy=void 0,e.then((e=>(this.systemClipboardStrategy=e,t.then((e=>(this.fullAccessClipboardStrategy=e,this.initialized=!0,Promise.resolve(this)))))))}set(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new R(h.ClipboardStrategyNotInitialized));const r={systemClipboardOperationResult:ot(p,"setresult",!1),fullAccessClipboardOperationResult:ot(p,"setresult",!1)};return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.preSetProcess(e),this.systemClipboardStrategy.set(e,t).then((()=>Promise.resolve(r)),(e=>(r.systemClipboardOperationResult.failed=!0,r.systemClipboardOperationResult.clipboardOperationResultError=e,C(e,[h.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,h.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.resolve(r)))).then((r=>this.fullAccessClipboardStrategy?this.fullAccessClipboardStrategy.set(e,t).then((()=>Promise.resolve(r)),(e=>(c().ULS.traceTag(595933078,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`Failed to save to fullAccessClipboardStrategy. clipboardStrategyType: '${this.fullAccessClipboardStrategy&&this.fullAccessClipboardStrategy.clipboardStrategyType}', Command Id: '${t.id?t.id:d}', Error: ${n.Wp.getStringifiedError(e)}`),r.fullAccessClipboardOperationResult.failed=!0,r.fullAccessClipboardOperationResult.clipboardOperationResultError=e,Promise.resolve(r)))):(r.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(r)))).then((e=>{if(e.systemClipboardOperationResult.failed&&e.fullAccessClipboardOperationResult.failed){let t=e.systemClipboardOperationResult.clipboardOperationResultError;return t||(t=e.fullAccessClipboardOperationResult.clipboardOperationResultError),t?Promise.reject(t):Promise.reject(new R(h.SetClipboardItems,d))}return Promise.resolve()}))}catch(e){return Promise.reject(new R(h.SetClipboardItems,"Failed in system clipboard.set",e))}}get(e){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new R(h.ClipboardStrategyNotInitialized));const t={systemClipboardOperationResult:ot(p,"getresult",!1,void 0,{items:{}}),fullAccessClipboardOperationResult:ot(p,"getresult",!1,void 0,{items:{}})};return this.systemClipboardStrategy.get(e).then((e=>(t.systemClipboardOperationResult.clipboardItemsData=e.getData(),this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.postGetProcess(t.systemClipboardOperationResult),Promise.resolve(t)))).catch((r=>(c().ULS.traceTag(507904974,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Failed to get data from systemClipboardStrategy. clipboardStrategyType: '${this.systemClipboardStrategy&&this.systemClipboardStrategy.clipboardStrategyType}', Command Id: '${e.id?e.id:d}', Error: ${n.Wp.getStringifiedError(r)}`),t.systemClipboardOperationResult.failed=!0,t.systemClipboardOperationResult.clipboardOperationResultError=r,b(r,h.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(r):Promise.resolve(t)))).then((t=>this.fullAccessClipboardStrategy?this.fullAccessClipboardStrategy.get(e).then((e=>(t.fullAccessClipboardOperationResult.clipboardItemsData=e.getData(),this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.postGetProcess(t.fullAccessClipboardOperationResult),Promise.resolve(t)))).catch((r=>(c().ULS.traceTag(595933079,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`Failed to get from fullAccessClipboardStrategy. clipboardStrategyType: '${this.fullAccessClipboardStrategy&&this.fullAccessClipboardStrategy.clipboardStrategyType}', Command Id: '${e.id?e.id:d}', Error: ${n.Wp.getStringifiedError(r)}`),t.fullAccessClipboardOperationResult.failed=!0,t.fullAccessClipboardOperationResult.clipboardOperationResultError=r,Promise.resolve(t)))):(t.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(t)))).then((t=>{if(t.systemClipboardOperationResult.failed||e.skipSystemClipboardAccess){if(t.fullAccessClipboardOperationResult.failed){let e=t.systemClipboardOperationResult.clipboardOperationResultError;return e||(e=t.fullAccessClipboardOperationResult.clipboardOperationResultError),e?Promise.reject(e):Promise.reject(new R(h.GetClipboardItems,d))}return 0===pe(t.fullAccessClipboardOperationResult.clipboardItemsData)?Promise.reject(t.systemClipboardOperationResult.clipboardOperationResultError):this.validateAndReturnFullAccessData(t)}return t.fullAccessClipboardOperationResult.failed?Promise.resolve(me(t.systemClipboardOperationResult.clipboardItemsData)):!G()||G()&&N.isEdgeWithTextHtmlClipboardSupportProperty?this.pasteSourceReconciliation(t,e):this.pasteSourceReconciliationBasedOnlyOnTextPlain(t)}))}catch(e){return Promise.reject(new R(h.GetClipboardItems,"Failed in system clipboard.get",e))}}onSystemClipboardChangedExternally(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.initialized?this.fullAccessClipboardStrategy?this.fullAccessClipboardStrategy.onSystemClipboardChangedExternally(e):(c().ULS.shipAssertTag(595882509,n.nh.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.fullAccessClipboardStrategy should be defined"),Promise.reject(new R(h.ClipboardStrategyNotInitialized))):Promise.reject(new R(h.ClipboardStrategyNotInitialized))}catch(e){return Promise.reject(new R(h.ClearClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).onSystemClipboardChangedExternally`,e))}}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(F([()=>{this.systemClipboardStrategy&&this.systemClipboardStrategy.dispose()},()=>{this.fullAccessClipboardStrategy&&this.fullAccessClipboardStrategy.dispose()}]),this.disposableImplementationExtension.dispose())}pasteSourceReconciliation(e,t){let r,o,a;return e.systemClipboardOperationResult.signatureData&&(r=e.systemClipboardOperationResult.signatureData.ccp_infra_timestamp),e.fullAccessClipboardOperationResult.signatureData&&(o=e.fullAccessClipboardOperationResult.signatureData.ccp_infra_timestamp),c().ULS.traceTag(595719624,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`systemClipboardAndFullAccessClipboardStrategy.pasteSourceReconciliation: ccpTimestampInSystemClipboard=${r} ccpTimestampInFullAccessClipboard=${o}`),r?(a=o||0,r>a?(Uo(e.systemClipboardOperationResult.clipboardItemsData,!0),Promise.resolve(me(e.systemClipboardOperationResult.clipboardItemsData))):Promise.resolve(me(e.fullAccessClipboardOperationResult.clipboardItemsData))):t.isTimestampStoredInSystemClipboard&&jo(e)?Promise.resolve(me(e.fullAccessClipboardOperationResult.clipboardItemsData)):No(e)?this.validateAndReturnFullAccessData(e):(Uo(e.systemClipboardOperationResult.clipboardItemsData,!1),Promise.resolve(me(e.systemClipboardOperationResult.clipboardItemsData)))}validateAndReturnFullAccessData(e){return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.validateUserHash(e.fullAccessClipboardOperationResult.signatureData),Promise.resolve(me(e.fullAccessClipboardOperationResult.clipboardItemsData))}pasteSourceReconciliationBasedOnlyOnTextPlain(e){return 0===pe(e.systemClipboardOperationResult.clipboardItemsData)||0===pe(e.fullAccessClipboardOperationResult.clipboardItemsData)?Promise.resolve(me(e.systemClipboardOperationResult.clipboardItemsData)):jo(e)?Promise.resolve(me(e.fullAccessClipboardOperationResult.clipboardItemsData)):No(e)?this.validateAndReturnFullAccessData(e):(e.systemClipboardOperationResult.clipboardItemsData.items[ie]=u,Promise.resolve(me(e.systemClipboardOperationResult.clipboardItemsData)))}constructor(e,t,r,o){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this._fullAccessClipboardStrategyType=r,this.dualClipboardDataProcessor=o,this.initialized=!1,this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.disposableImplementationExtension=it(`${e}`)}}function Uo(e,t){e.items[ie]=u,t&&(e.items["metadata/is-last-copy-was-external-XLO-source"]="1")}function jo(e){const t=qt(Xt(e.systemClipboardOperationResult.clipboardItemsData.items[te])),r=e.fullAccessClipboardOperationResult.clipboardItemsData.items[te];return!!r&&t===qt(Xt(r))}function No(e){return qt(Xt(e.systemClipboardOperationResult.clipboardItemsData.items[te]))===ta().getCopyToClipboardLatencyMessage()}class zo extends Fo{constructor(e){super(m.SystemClipboardAndLocalStorage,{browserStorage:!0,systemClipboard:!0,inMemory:!1},m.LocalStorage,e)}}class Ho extends Fo{constructor(e){super(m.SystemClipboardAndInMemory,{browserStorage:!1,systemClipboard:!0,inMemory:!0},m.InMemory,e)}}class Jo extends $r{initialize(){return this.innerInitialize().then((()=>this))}get(e){this.disposableImplementationExtension.throwIfDisposed("get"),c().ULS.traceTag(595947538,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`ClipboardStorageIframeProxy.get: isKeyboardEvent = ${e.isKeyboardEvent}; silentClipboardAccessFailures = ${e.silentClipboardAccessFailures||!1}`);const t=et(Xe(),"get",this.messageDestination,e.userHash);return this.postMessage(t,"get").then((e=>e.clipboardItemsData?Promise.resolve(me(e.clipboardItemsData)):Promise.resolve(de())))}set(e,t){let r;return this.disposableImplementationExtension.throwIfDisposed("set"),c().ULS.traceTag(595947541,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`ClipboardStorageIframeProxy.set: isKeyboardEvent = ${t.isKeyboardEvent}; silentClipboardAccessFailures = ${t.silentClipboardAccessFailures||!1}`),r=ue(e)>0?et(Xe(),"set",this.messageDestination,t.userHash,e.getData()):et(Xe(),"set",this.messageDestination),this.postMessage(r,"set").then((()=>{}))}clearClipboardNecessary(e,t){return function(e,t){return null==e||1===e||null==t||e!==t}(e,t)}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[te,oe,"data/shadow-workbook"]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e,t){if(super(),this.messageDestination=t,!t)throw new P(d,"messageDestination");this.clipboardStorageType=e,this.disposableImplementationExtension=it(t)}}class Bo extends Jo{constructor(e){super(Ce.LocalStorage,e)}}class Vo extends nt{constructor(e){super(m.AsyncSystemClipboard,{browserStorage:!1,systemClipboard:!0,inMemory:!1},e)}}class Go{async get(e){if(this.disposableImplementationExtension.throwIfDisposed("get"),e.isAsyncClipboardAPI=!0,e.skipSystemClipboardAccess)return Promise.resolve(de());const t={name:"clipboard-read",allowWithoutGesture:!1};try{const r=await(navigator.permissions?.query(t));e.asyncClipboardReadPermissionState=r?.state,c().ULS.traceTag(507626376,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.get - Clipboard read permission state: ${r?.state}. Command id: ${e.id}`),this.initialClipboardPermissionState=r?.state,"prompt"===r?.state&&(this.isActionPerformedOnPermissionPrompt=!1,r.onchange=()=>{e.asyncClipboardReadPermissionUpdatedState=r?.state,this.isActionPerformedOnPermissionPrompt=!0,"denied"===r?.state?c().ULS.traceTag(507626375,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.get - Clipboard read permission is denied from prompt. Command id: ${e.id}`):"granted"===r?.state&&c().ULS.traceTag(507626374,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.get - Clipboard read permission is granted from prompt. Command id: ${e.id}`)})}catch(t){e.asyncClipboardReadPermissionState=`Failed to query "clipboard-read" permission. Error: ${n.Wp.getStringifiedError(t)}`,c().ULS.traceTag(508651269,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.get: Failed to query "clipboard-read" permission. Command id: ${e.id}, Error: ${n.Wp.getStringifiedError(t)}`)}return await this.readFromSystemClipboard(e)}async set(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),t.isAsyncClipboardAPI=!0;const r=this.getSupportedDataFormats();try{const o={name:"clipboard-write",allowWithoutGesture:!0};try{const e=await(navigator.permissions?.query(o));t.asyncClipboardWritePermissionState=e?.state,c().ULS.traceTag(507626372,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.set - Clipboard write permission state: ${e?.state}. Command id: ${t.id}`),this.initialClipboardPermissionState=e?.state,"prompt"===e?.state&&(this.isActionPerformedOnPermissionPrompt=!1,e.onchange=()=>{t.asyncClipboardWritePermissionUpdatedState=e?.state,this.isActionPerformedOnPermissionPrompt=!0,"denied"===e?.state?c().ULS.traceTag(507626371,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.set - Clipboard write permission is denied from prompt. Command id: ${t.id}`):"granted"===e?.state&&c().ULS.traceTag(507626370,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.set - Clipboard write permission is granted from prompt. Command id: ${t.id}`)})}catch(e){t.asyncClipboardWritePermissionState=`Failed to query "clipboard-write" permission. Error: ${n.Wp.getStringifiedError(e)}`,c().ULS.traceTag(508651268,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.set: Failed to query "clipboard-write" permission. Command id: ${t.id}, Error: ${n.Wp.getStringifiedError(e)}`)}const a=Se(e);if(!a||a.length<1)return;const i={};for(const e of a){if(!r.includes(e.clipboardDataFormat))continue;let t;t=e.deferred?e.data:new Blob([e.data],{type:e.clipboardDataFormat});const o=r.includes(`${this.webCustomFormatPrefix}${e.clipboardDataFormat}`);o&&this.isAsyncClipboardEnhancementsEnabled?i[`${this.webCustomFormatPrefix}${e.clipboardDataFormat}`]=t:o||(i[e.clipboardDataFormat]=t)}const s=new ClipboardItem(i,{unsanitized:[oe]});t.timeElapsedBeforeAsyncClipboardWrite=t.stopwatch?.getElapsedTime?.(),t.isDocumentFocusedBeforeAsyncClipboardWrite=document.hasFocus?.(),t.isTransientUserActiveBeforeAsyncClipboardWrite=navigator?.userActivation?.isActive,await navigator.clipboard.write([s]);const l=t.stopwatch?.getElapsedTime?.();t.asyncClipboardWriteDuration=l-t.timeElapsedBeforeAsyncClipboardWrite,t.isAsyncClipboardWriteSucceeded=!0,c().ULS.traceTag(508703872,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.set: Write successful. Command id: ${t.id}, TimeElapsedBeforeClipboardWrite: ${t.timeElapsedBeforeAsyncClipboardWrite}ms, ClipboardWriteDurationInMs: ${t.asyncClipboardWriteDuration}ms, IsDocumentFocused: ${t.isDocumentFocusedBeforeAsyncClipboardWrite}, IsTransientUserActive: ${t.isTransientUserActiveBeforeAsyncClipboardWrite}`),t.isTimestampStoredInSystemClipboard=!0}catch(e){if(!t.id&&t.silentClipboardAccessFailures)return void c().ULS.traceTag(506009493,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.set: Failed to write data formats to system clipboard in Non-Copy flow. Error: ${n.Wp.getStringifiedError(e)}`);throw t.isAsyncClipboardWriteSucceeded=!1,t.asyncClipboardWriteErrorMessage=n.Wp.getStringifiedError(e),"prompt"!==this.initialClipboardPermissionState||this.isActionPerformedOnPermissionPrompt||c().ULS.traceTag(507626369,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.set - Clipboard write permission prompt is closed without any action. Command id: ${t.id}`),c().ULS.traceTag(508843076,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.set: Failed to write data formats to system clipboard. Command id: ${t.id}, Error: ${n.Wp.getStringifiedError(e)}, TimeElapsedBeforeClipboardWrite: ${t.timeElapsedBeforeAsyncClipboardWrite}ms, IsDocumentFocused: ${t.isDocumentFocusedBeforeAsyncClipboardWrite}, IsTransientUserActive: ${t.isTransientUserActiveBeforeAsyncClipboardWrite}`),this.isAsyncClipboardEnhancementsEnabled?e?.message?.includes(this.clipboardWritePermissionDeniedErrorMessage)?new R(h.ClipboardIsInaccessible,`AsyncSystemClipboardStorage.set - Clipboard permission is denied. Command id: ${t.id}`,e):new R(h.AsyncClipboardWriteFailure,`AsyncSystemClipboardStorage.set - Failed to write clipboard items. Command id: ${t.id}`,e):new R(h.ClipboardIsInaccessible,`AsyncSystemClipboardStorage.set - Clipboard permission is denied or failed to write. Command id: ${t.id}`,e)}}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[te,oe,ae,"data/shadow-workbook","web data/shadow-workbook",ce,"web metadata/copy-context"]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}async readFromSystemClipboard(e){const t=me();try{e.timeElapsedBeforeAsyncClipboardRead=e.stopwatch?.getElapsedTime?.(),e.isDocumentFocusedBeforeAsyncClipboardRead=document.hasFocus?.(),e.isTransientUserActiveBeforeAsyncClipboardRead=navigator?.userActivation?.isActive;const o=await navigator.clipboard.read({unsanitized:[oe]}),a=e.stopwatch?.getElapsedTime?.();e.isAsyncClipboardReadSucceeded=!0,e.asyncClipboardReadDuration=a-e.timeElapsedBeforeAsyncClipboardRead,c().ULS.traceTag(506017227,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.readFromSystemClipboard: Read successful, Command id: ${e.id}, isKeyboardEvent: ${e.isKeyboardEvent}, TimeElapsedBeforeClipboardRead: ${e.timeElapsedBeforeAsyncClipboardRead}ms, ClipboardReadDurationInMs: ${e.asyncClipboardReadDuration}ms, IsDocumentFocused: ${e.isDocumentFocusedBeforeAsyncClipboardRead}, IsTransientUserActive: ${e.isTransientUserActiveBeforeAsyncClipboardRead}`);const i=this.getSupportedDataFormats();if(!o||o.length<1)return t;for(const a of o)for(const o of a.types){if(!i.includes(o))continue;const s=await a.getType(o);if(!s){c().ULS.traceTag(506840981,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.readFromSystemClipboard: Failed to read blob for '${o}' type, Command id: ${e.id}, isKeyboardEvent: ${e.isKeyboardEvent}`);continue}let l;l=o===ae?await(r=s,uo(r)):await s.text();const d=o.startsWith(this.webCustomFormatPrefix);d&&this.isAsyncClipboardEnhancementsEnabled?t.setItem(o.replace(this.webCustomFormatPrefix,""),l):d||t.setItem(o,l)}}catch(r){if(e.isAsyncClipboardReadSucceeded=!1,e.asyncClipboardReadErrorMessage=n.Wp.getStringifiedError(r),"prompt"!==this.initialClipboardPermissionState||this.isActionPerformedOnPermissionPrompt||e.isKeyboardEvent||c().ULS.traceTag(507626373,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.readFromSystemClipboard - Clipboard read permission prompt is closed without any action. Command id: ${e.id}`),r.name===this.emptyClipboardReadErrorName&&r.message===this.emptyClipboardReadErrorMessage)return c().ULS.traceTag(508352130,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.readFromSystemClipboard: System clipboard is empty. Command id: ${e.id}, Error: ${n.Wp.getStringifiedError(r)}`),t;if(c().ULS.traceTag(508843077,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`AsyncSystemClipboardStorage.readFromSystemClipboard: Failed to read data formats from system clipboard. Command id: ${e.id}, IsKeyboardEvent: ${e.isKeyboardEvent}, Error: ${n.Wp.getStringifiedError(r)}, TimeElapsedBeforeClipboardRead: ${e.timeElapsedBeforeAsyncClipboardRead}ms, IsDocumentFocused: ${e.isDocumentFocusedBeforeAsyncClipboardRead}, IsTransientUserActive: ${e.isTransientUserActiveBeforeAsyncClipboardRead}`),this.isAsyncClipboardEnhancementsEnabled)throw r?.message?.includes(this.clipboardReadPermissionDeniedErrorMessage)?new R(h.ClipboardIsInaccessible,`AsyncSystemClipboardStorage.readFromSystemClipboard - Clipboard read permission is denied. Command id: ${e.id}`,r):new R(h.AsyncClipboardReadFailure,`AsyncSystemClipboardStorage.readFromSystemClipboard - Failed to read clipboard items. Command id: ${e.id}`,r);throw new R(h.ClipboardIsInaccessible,`AsyncSystemClipboardStorage.readFromSystemClipboard - Clipboard permission is denied or failed to read. Command id: ${e.id}`,r)}finally{e.clearSystemClipboard&&this.clearSystemClipboard()}var r;return t}async clearSystemClipboard(){try{await navigator.clipboard.writeText(""),c().ULS.traceTag(508703843,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"AsyncSystemClipboardStorage.clearSystemClipboard: Clipboard cleared")}catch(e){c().ULS.traceTag(508703842,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"AsyncSystemClipboardStorage.clearSystemClipboard: Failed to clear system clipboard.")}}constructor(){this.initialClipboardPermissionState=null,this.isActionPerformedOnPermissionPrompt=!1,this.webCustomFormatPrefix="web ",this.emptyClipboardReadErrorName="DataError",this.clipboardReadPermissionDeniedErrorMessage="Read permission denied",this.clipboardWritePermissionDeniedErrorMessage="Write permission denied",this.emptyClipboardReadErrorMessage="No valid data on clipboard.",this.clipboardPermissionDeniedErrorMessage="AsyncSystemClipboardStorage - Clipboard permission is denied",this.clipboardIsInaccessibleError=new R(h.ClipboardIsInaccessible,this.clipboardPermissionDeniedErrorMessage),this.isAsyncClipboardEnhancementsEnabled=!1,this.clipboardStorageType=Ce.AsyncSystemClipboard,this.disposableImplementationExtension=it("AsyncSystemClipboardStorage"),this.isAsyncClipboardEnhancementsEnabled=i(0,!1)}}class Ko extends Fo{constructor(e){super(m.AsyncSystemClipboardAndLocalStorage,{browserStorage:!0,systemClipboard:!0,inMemory:!1},m.LocalStorage,e)}}class Zo{async initialize(e,t){this.initialized=!1;const[r,o]=await Promise.all([e,t]);return this.systemClipboardStorage=r,this.asyncSystemClipboardStorage=o,this.initialized=!0,this}async get(e){this.disposableImplementationExtension.throwIfDisposed("get");const t=window.performance.now();if(!this.initialized||!this.asyncSystemClipboardStorage||!this.systemClipboardStorage)throw new R(h.ClipboardStrategyNotInitialized);try{return await this.systemClipboardStorage.get(e)}catch(t){c().ULS.traceTag(508154642,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CombinedSystemClipboardStorage.get - systemClipboardStorage get failed. Command id: ${e.id}, Error: ${n.Wp.getStringifiedError(t)}`);try{return await this.asyncSystemClipboardStorage.get(e)}catch(t){throw c().ULS.traceTag(507904976,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CombinedSystemClipboardStorage.get - asyncSystemClipboardStorage get failed. Command id: ${e.id}, Error: ${n.Wp.getStringifiedError(t)}`),new R(h.ClipboardIsInaccessible,"CombinedSystemClipboardStorage.get - Clipboard permission is denied or failed to read",t)}}finally{c().ULS.traceTag(508154640,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CombinedSystemClipboardStorage.get | System clipboard total read time: ${window.performance.now()-t} ms, Command id: ${e.id}`)}}async set(e,t){this.disposableImplementationExtension.throwIfDisposed("set");const r=window.performance.now();if(!this.initialized||!this.asyncSystemClipboardStorage||!this.systemClipboardStorage)throw new R(h.ClipboardStrategyNotInitialized);try{return void await this.systemClipboardStorage.set(e,t)}catch(r){c().ULS.traceTag(508154638,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CombinedSystemClipboardStorage.set - systemClipboardStorage set failed. Command id: ${t.id}, Error: ${n.Wp.getStringifiedError(r)}`);try{return void await this.asyncSystemClipboardStorage.set(e,t)}catch(e){throw c().ULS.traceTag(507904975,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CombinedSystemClipboardStorage.set - asyncSystemClipboardStorage set failed. Command id: ${t.id}, Error: ${n.Wp.getStringifiedError(e)}`),new R(h.ClipboardIsInaccessible,"CombinedSystemClipboardStorage.set - Clipboard permission is denied or failed to write",e)}}finally{c().ULS.traceTag(508154637,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CombinedSystemClipboardStorage.set - System clipboard total write time: ${window.performance.now()-r} ms, Command id: ${t.id}`)}}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[...this.systemClipboardStorage?.getSupportedDataFormats()??[],...this.asyncSystemClipboardStorage?.getSupportedDataFormats()??[]].reduce(((e,t)=>(-1===e.indexOf(t)&&e.push(t),e)),[])}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(){this.initialized=!1,this.clipboardStorageType=Ce.AsyncSystemClipboard,this.disposableImplementationExtension=it("CombinedSystemClipboardStorage")}}class qo extends Fo{constructor(e){super(m.AsyncSystemClipboardAndInMemory,{browserStorage:!1,systemClipboard:!0,inMemory:!0},m.InMemory,e)}}class Xo{async initialize(e,t,r){const[o,a]=await Promise.all([e,t]);return this.primarySystemClipboardStrategy=o,this.secondarySystemClipboardStrategy=a,this.currentSystemClipboardStrategy=o,this.initialized=!0,this.isAsyncClipboardRoamingSettingsEnabled&&r&&queueMicrotask((()=>{this.switchToSecondaryStrategyIfClipboardPermissionDenied(r)})),this}async set(e,t){if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.initialized)throw new R(h.ClipboardStrategyNotInitialized);try{return void await this.currentSystemClipboardStrategy.set(e,t)}catch(e){throw this.handleClipboardStrategyFailure(t,e),e}}async get(e){if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.initialized)throw new R(h.ClipboardStrategyNotInitialized);try{return await this.currentSystemClipboardStrategy.get(e)}catch(t){throw this.handleClipboardStrategyFailure(e,t),t}}onSystemClipboardChangedExternally(e){if(this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),!this.initialized)throw new R(h.ClipboardStrategyNotInitialized);return this.currentSystemClipboardStrategy.onSystemClipboardChangedExternally(e)}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.primarySystemClipboardStrategy?.dispose(),this.secondarySystemClipboardStrategy?.dispose(),this.initialized=!1,this.primarySystemClipboardStrategy=null,this.secondarySystemClipboardStrategy=null,this.currentSystemClipboardStrategy=null,this.disposableImplementationExtension.dispose())}async switchToSecondaryStrategyIfClipboardPermissionDenied(e){try{await e&&this.currentSystemClipboardStrategy===this.primarySystemClipboardStrategy&&this.switchToSecondaryStrategy(void 0,!0)}catch(e){c().ULS.traceTag(504739846,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`CircuitBreakerSystemClipboardStrategy.switchToSecondaryStrategyIfClipboardPermissionDenied: Error while switching clipboard strategy: ${e}`)}}handleClipboardStrategyFailure(e,t){const r=t;this.currentSystemClipboardStrategy===this.primarySystemClipboardStrategy&&r.reason===h.ClipboardIsInaccessible&&(this.errorCount++,this.errorCount>=this.circuitBreakerThreshold&&this.switchToSecondaryStrategy(e))}switchToSecondaryStrategy(e,t){this.currentSystemClipboardStrategy=this.secondarySystemClipboardStrategy,e&&(e.dataClipboardStrategyType=this.secondarySystemClipboardStrategy?.clipboardStrategyType),c().ULS.traceTag(505520142,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`Switched to secondary system clipboard strategy. isAppBootPhase: ${!!t}`)}constructor(){this.initialized=!1,this.primarySystemClipboardStrategy=null,this.secondarySystemClipboardStrategy=null,this.currentSystemClipboardStrategy=null,this.circuitBreakerThreshold=1,this.errorCount=0,this.clipboardStrategyType=m.AsyncSystemClipboard,this.clipboardCapabilities={browserStorage:!0,systemClipboard:!0,inMemory:!1},this.disposableImplementationExtension=it("CircuitBreakerSystemClipboardStrategy"),this.isAsyncClipboardRoamingSettingsEnabled=i(0,!1)}}function Yo(e){return new Wo(e)}function Qo(){return new Go}function ea(e,t,r,o,a,s,l){const p=function(e,t,r){return new br(e,t,r)}(r,o,a);return function(e,t,r,o,a){let s=_e.NoError;return n.Wp.chainFallbackPromises(e,(e=>function(e,t,r,o,a){c().ULS.traceTag(595716231,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Attempting to create clipboard strategy type '${e.clipboardStrategyType}'`);const s=()=>(()=>{switch(e.clipboardStrategyType){case m.SystemClipboard:case m.SystemClipboardAndInMemory:case m.AsyncSystemClipboard:case m.AsyncSystemClipboardAndInMemory:return e;case m.SystemClipboardAndLocalStorage:case m.AsyncSystemClipboardAndLocalStorage:return e.systemClipboardStrategyParameters;default:throw new k(`createClipboardEnvironmentComponentsByType: getSystemClipboardParameters couldn't be used for ${e.clipboardStrategyType}`)}})().skipFilesIfPlainTextExists,l=()=>{switch(e.clipboardStrategyType){case m.LocalStorage:return e;case m.AsyncSystemClipboard:case m.AsyncSystemClipboardAndInMemory:case m.SystemClipboardAndLocalStorage:case m.AsyncSystemClipboardAndLocalStorage:return e.localStorageStrategyParameters;default:throw new k(`createClipboardEnvironmentComponentsByType: getLocalStorageParameters couldn't be used for ${e.clipboardStrategyType}`)}},p=e=>r.createClipboardDataProcessor(e),u=()=>r.createClipboardMetaDataProcessor(),f=e=>r.createDualClipboardDataProcessor(e),g=()=>{const e=l();return e.useSharedClipboardIframe?new Fr:function(e){return new Rr(e)}(It(e.sharedClipboardSchemaVersion)+Tt)},y=(e,r)=>(r?r.initialize(e):Promise.resolve(void 0)).then((()=>function(e,t,r){return c().ULS.shipAssertTag(595945246,n.nh.msoulscat_ES_EWAJS,!!e,"MetadataManager.createMetadataManager: expected clipboardStrategy to be defined."),c().ULS.shipAssertTag(595945247,n.nh.msoulscat_ES_EWAJS,!!e,"MetadataManager.createMetadataManager: expected metadataSerializationHelper to be defined."),nr=e,sr=function(e){return ar=e,ir}(t),cr=r,cr&&cr.setOnMetadataChangedListener(mr),ur}(e,t,r))),S=e=>{let t;return t=i(0,!1)?Promise.resolve(Qo()):Promise.resolve((new Zo).initialize(Promise.resolve(Yo(s())),Promise.resolve(Qo()))),function(e){return new Vo(e)}(e).initialize(t)},b=()=>(new Ur).initialize(Promise.resolve(Yo(s()))),C=e=>function(e){return new Oo(e)}(e).initialize(Promise.resolve(new $o)),E=e=>{const t={};e.wacCluster&&(t.wacCluster=e.wacCluster.trim()),e.sessionId&&(t.sessionId=e.sessionId),o&&(t.bulsEndpointUrl=o);const r=e.sharedClipboardOverrideOrigin?1:0;var a;a={sharedClipboardHostingApp:e.sharedClipboardHostingApp,sharedClipboardHostingApps:e.sharedClipboardHostingApps,sharedClipboardHostingEnvironments:e.sharedClipboardHostingEnvironments,sharedClipboardSchemaVersion:e.sharedClipboardSchemaVersion,sharedClipboardExpirationInMinutes:e.sharedClipboardExpirationInMinutes,clipboardPromiseTimeoutInMinutes:e.sharedClipboardExpirationInMinutes,whitelistOriginComponents:r},ke=!1,function(e){if(!e)throw new P(d,"sharedClipboardSettingsCandidate");const t=De();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return xe=t,void(ke=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return c().ULS.traceTag(596124181,n.nh.msoulscat_ES_EWAJS,n.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),xe=t,void(ke=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();let r=t.sharedClipboardHostingApp;const o=r.indexOf(Te);o>=0&&(r=r.substr(o+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch{c().ULS.traceTag(579737680,n.nh.msoulscat_ES_EWAJS,n.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((e=>!e||!e.trim())))return c().ULS.traceTag(596124182,n.nh.msoulscat_ES_EWAJS,n.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp=d,t.sharedClipboardHostingApps=[],xe=t,void(ke=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch{c().ULS.traceTag(579737681,n.nh.msoulscat_ES_EWAJS,n.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((e=>!e||!e.trim())))return c().ULS.traceTag(596124183,n.nh.msoulscat_ES_EWAJS,n.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp=d,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],xe=t,void(ke=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return c().ULS.traceTag(596124184,n.nh.msoulscat_ES_EWAJS,n.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=d,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],xe=t,void(ke=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return c().ULS.traceTag(596124185,n.nh.msoulscat_ES_EWAJS,n.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' or '${r}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=d,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],xe=t,void(ke=!0)}t.whitelistOriginComponents=!0,xe=t,ke=!0}(a),function(e){c().ULS.shipAssertTag(595944468,n.nh.msoulscat_ES_EWAJS,!!e,"ClipboardPlatformSettings.setClipboardPlatformSettings: expect clipboardPlatformSettings to be defined."),or=e}(t)},w=(e,t)=>{const r=l();return r.useSharedClipboardIframe?(E(r),function(e){return new Ro(e)}(t).initialize((o=e?tt.localStorageMetadata:tt.localStorageData,new Bo(o)).initialize())):function(e){return new Dt(e)}(t).initialize(Promise.resolve((a=e?It(r.sharedClipboardSchemaVersion):(i=r.sharedClipboardSchemaVersion,Pt+i),new Lt(a))));var o,a,i},_=()=>{return(e=f(!0),new zo(e)).initialize(b(),w(!1));var e},v=(e,t,r)=>Promise.all([e,t]).then((([e,t])=>y(t,r).then((t=>({dataClipboardStrategy:e,metadataManager:t})))));try{switch(e.clipboardStrategyType){case m.AsyncSystemClipboard:return v((e=>{const t=p(!1);return(new Xo).initialize(S(t),_(),e)})(a),w(!0,u()),g());case m.SystemClipboard:return v(b(),C(u()));case m.InMemory:return v(C(p(!1)),C(u()));case m.LocalStorage:return v(w(!1,p(!0)),w(!0,u()),g());case m.AsyncSystemClipboardAndLocalStorage:return v((T=f(!0),new Ko(T)).initialize(S(),w(!1)),w(!0,u()),g());case m.AsyncSystemClipboardAndInMemory:return v((()=>{return(e=f(!1),new qo(e)).initialize(S(),C());var e})(),w(!0,u()),g());case m.SystemClipboardAndLocalStorage:return v(_(),w(!0,u()),g());case m.SystemClipboardAndInMemory:return v((()=>{return(e=f(!1),new Ho(e)).initialize(b(),C());var e})(),C(u()))}return Promise.reject(new R(h.UnsupportedClipboardStrategyType,`Clipboard strategy type '${e.clipboardStrategyType}' is not supported`))}catch(t){return Promise.reject(new R(h.UnsupportedClipboardStrategyType,`failed to create clipboardStrategyType: '${e.clipboardStrategyType}' with error: ${n.Wp.getStringifiedError(t)}`))}var T}(e,t,r,o,a).then((t=>(c().ULS.traceTag(595716294,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Clipboard strategy type '${e.clipboardStrategyType}' was created.`),t.infraInitializationError=s,t))).catch((t=>{let r=!1;r=E(t),r&&(s=_e.LocalStorageInaccessible);const o=`clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: selectClipboardStrategy: failed to create clipboard strategy type '${e.clipboardStrategyType}'. Error: ${n.Wp.getStringifiedError(t)}`;return c().ULS.traceTag(595716230,n.nh.msoulscat_ES_EWAJS,r?n.kp.Info:n.kp.Error,o),Promise.reject(new R(h.SelectClipboardStrategy,o,t))}))))}(e,t,p,s,l).then((e=>({dataClipboardStrategy:e.dataClipboardStrategy,clipboardDataManager:p,metadataManager:e.metadataManager,infraInitializationError:e.infraInitializationError})))}function ta(){return aa}var ra;!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.StateReady=1]="StateReady",e[e.InitializationSucceed=2]="InitializationSucceed"}(ra||(ra={}));const oa={initializationStatus:ra.NotInitialized,stateInitialized:!1,clipboardStrategy:void 0,chromeExtensionIds:[],clipboardPromiseTimeoutInMinutes:Me,copyToClipboardLatencyMessage:"Retrieving data. Wait a few seconds and try to cut or copy again.",metadataManager:void 0,clipboardDataManager:void 0,initializationError:_e.NoError},aa={init:function(e,t,r,o,a,i,s,p,u,m,f,h,g,y,S,b,C,E,w){return oa.lastClipboardPlatformEnvironmentInitializationInfo?Promise.resolve(oa.lastClipboardPlatformEnvironmentInitializationInfo):(l(e),t&&Array.isArray(t)?(c().ULS.traceTag(596455702,n.nh.msoulscat_ES_EWAJS,n.kp.Info,`ClipboardPlatformEnvironment.init: chromeExtensionIds = '${JSON.stringify(t)}'`),oa.chromeExtensionIds=function(e){const t=[];if(!e)return t;for(const r of e)r&&"string"==typeof r&&r.trim().length>0&&t.push(r);return t}(t),m&&(oa.copyToClipboardLatencyMessage=m),"number"!=typeof u||isNaN(u)||(oa.clipboardPromiseTimeoutInMinutes=u),oa.initializationStatus=ra.StateReady,ea(g,h,y,S,b,E,w).then((e=>(oa.clipboardDataManager=e.clipboardDataManager,oa.metadataManager=e.metadataManager,oa.clipboardStrategy=e.dataClipboardStrategy,oa.initializationError=e.infraInitializationError,oa.initializationStatus=ra.InitializationSucceed,oa.lastClipboardPlatformEnvironmentInitializationInfo={clipboardStrategiesToInitialize:g,dataClipboardCapabilities:oa.clipboardStrategy&&oa.clipboardStrategy.clipboardCapabilities,dataClipboardStrategyType:oa.clipboardStrategy&&oa.clipboardStrategy.clipboardStrategyType,infraInitializationError:oa.initializationError},oa.lastClipboardPlatformEnvironmentInitializationInfo)))):Promise.reject(new P(d,"chromeExtensionIds")))},getClipboardStrategy:function(){if(ia(),!oa.clipboardStrategy)throw new I("A clipboard strategy has not been selected. Call selectClipboardStrategy.");return oa.clipboardStrategy},getChromeExtensionIds:function(){return na(),oa.chromeExtensionIds},getClipboardPromiseTimeoutInMinutes:function(){return na(),oa.clipboardPromiseTimeoutInMinutes},getCopyToClipboardLatencyMessage:function(){return na(),oa.copyToClipboardLatencyMessage},getMetadataManager:function(){return ia(),oa.metadataManager},getClipboardDataManager:function(){return ia(),oa.clipboardDataManager},getInitializationError:function(){return ia(),oa.initializationError}};function ia(){if(oa.initializationStatus!==ra.InitializationSucceed)throw new I("ClipboardPlatformEnvironment is not initialized. Call init(...).")}function na(){if(oa.initializationStatus<ra.StateReady)throw new I("ClipboardPlatformEnvironment state is not ready. Call init(...).")}var sa,ca,la,da,pa;!function(e){e.Text="Text",e.TextPlain="text/plain",e.TextJSON="text/json",e.TextHtml="text/html",e.Metadata="metadata",e.ImagePNG="image/png"}(sa||(sa={})),function(e){e[e.ExpectedError=0]="ExpectedError",e[e.ClipboardIsInaccessible=1]="ClipboardIsInaccessible",e[e.UnknownError=2]="UnknownError",e[e.UnsupportedClipboardFormat=3]="UnsupportedClipboardFormat",e[e.ClipboardIsEmpty=4]="ClipboardIsEmpty"}(ca||(ca={})),function(e){e[e.ExpectedError=0]="ExpectedError",e[e.ClipboardIsInaccessible=1]="ClipboardIsInaccessible",e[e.UnknownError=2]="UnknownError"}(la||(la={})),function(e){e[e.SameSession=0]="SameSession",e[e.CrossSession=1]="CrossSession",e[e.ExternalImage=2]="ExternalImage"}(da||(da={})),function(e){e[e.DefaultPasteFlow=0]="DefaultPasteFlow",e[e.TextPasteFlow=1]="TextPasteFlow"}(pa||(pa={}));const ua=["ndjpnladcallmjemlbaebfadecfhkepb","ifbmcpbgkhlpfcodhjhdbllhiaomkdej"],ma=["png","jpeg","tiff","gif","jpg"];var fa=r(7182);class ha{serializeSourceItem(e){return JSON.stringify(e)}serializeCommandParameters(e){return e?JSON.stringify(e):""}deserializeSourceItem(e){return JSON.parse(e)}deserializeCommandParameters(e){return JSON.parse(e)}}class ga{getSourceItem(e){return this._visioController.getClipboardData()}beforeSerialize(e){}serialize(e){const t=e.sourceItem,r=me();let o={asynchronousResult:null,synchronousResult:null};if(t.svgData){const e=(new XMLSerializer).serializeToString(t.svgData.svgNode);r.setItem(sa.TextHtml,e),o={asynchronousResult:this.generateBase64Async(t.CCPID?t.CCPID:"",t.CCPLogID?t.CCPLogID:"",e,t.svgData.height,t.svgData.width),synchronousResult:r}}return o}generateBase64Async(e,t,r,o,a){return new Promise(((i,s)=>{try{const c=document.createElement("canvas");c.height=o,c.width=a;const l=c.getContext("2d");let d;d=this._visioController.isSafariBrowser()?new Blob([r],{type:"image/svg+xml"}):new Blob([r],{type:"image/svg+xml;charset=utf-8"});const p=URL.createObjectURL(d),u=document.createElement("img");u.onload=()=>{try{l.drawImage(u,0,0,c.width,c.height),URL.revokeObjectURL(u.src);const r=c.toDataURL("image/png"),o=me(),a=document.createElement("img");a.setAttribute("src",r),a.setAttribute("class","Visio"),a.setAttribute("Visio-sessionId",this._visioController.getUserSessionID()),a.setAttribute("data-clipservice-ccpid",e),a.setAttribute("data-clipservice-ccplogid",t),a.setAttribute("data-clipservice-dc",this._visioController.getWACDatacenter()),o.setItem(sa.TextHtml,a.outerHTML),this._visioController.getCCPLogger().traceTag(561860804,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"SVG to base64 converted successfully"),i(o)}catch(e){return this._visioController.getCCPLogger().traceTag(561860805,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`SVG to base64 conversion failed during image load with error:'${e}'`),s(e)}},u.src=p}catch(e){return this._visioController.getCCPLogger().traceTag(561860806,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,`SVG to base64 conversion failed with error:'${e}'`),s(e)}}))}constructor(e){this._visioController=e}}class ya{}class Sa{}class ba{}class Ca{}class Ea{beforePaste(e){}deserialize(e){try{const t=e.clipboardItems,r=new ya;let o;if(e.isClipboardInaccessible)throw new O(y.ClipboardIsInaccessible,"clipboard is not accessible");if(!t)throw new O(y.ReadFromClipboardReturnNullOrUndefined,"clipboardItems is null!");const a=t.getItem(sa.ImagePNG);if(a)o=a,r.isSameSession=!1,r.pasteSessionType=da.ExternalImage;else{const e=t.getItem(sa.TextHtml);if(!e)throw new O(y.ClipboardIsEmpty,"Html Data is not present in clipboard!");const a=(new DOMParser).parseFromString(e,"text/html");if(o=a.images.length>0?a.images[0].src:null,!o)throw new O(y.ClipboardIsEmpty,"No Image source is present in the Html data!");const i=a.images[0].getAttribute("Visio-sessionId");if(i)if(i===this._visioController.getUserSessionID())r.pasteSessionType=da.SameSession,r.isSameSession=!0;else{r.pasteSessionType=da.CrossSession;const t="\\s+ccp_infra_timestamp=['|\"](\\d+)['|\"]",o=this.getRegExStringValue(e,t);if(""!==o)try{const e=Number(o);r.timeStamp=isNaN(e)?0:e}catch(e){r.timeStamp=0}r.wacDataCenter=a.images[0].getAttribute("data-clipservice-dc"),r.CCPID=a.images[0].getAttribute("data-clipservice-ccpid"),r.CCPLogID=a.images[0].getAttribute("data-clipservice-ccplogid"),r.isSameSession=!1}else r.pasteSessionType=da.ExternalImage,r.isSameSession=!1}if(!this.isBase64Image(o))throw new O(y.ClipboardIsEmpty,"Image src is not Base64!");const i=new ba;return this.getImageDimensions(o).then((e=>(i.imageDimension=e,i.imageExtension=this.getImageExtension(o),i.base64ImageData=o.substring(o.indexOf(",")+1),r.base64Image=i,this._visioController.setClipboardData(r),this._visioController.getCCPLogger().traceTag(561860803,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"image details retrieved successfully"),Promise.resolve())),(e=>{throw e})).catch((e=>Promise.reject(e)))}catch(e){return Promise.reject(e)}}shouldWaitForCopyToComplete(e){return!1}onDeferredPasteStarted(e){}onDeferredPasteCompleted(e){}isBase64Image(e){return/^data:image\/[a-z]+(;[a-z\-]+\=[a-z0-9\-]+)?;base64,\s*[a-z0-9+\/]+={0,2}$/i.test(e)}getImageExtension(e){const t=e.match(/[^:\/]\w+(?=;)/i);if(!t||1!==t.length||!this.isSupportedExtension(t[0]))throw new O(y.ClipboardIsEmpty,"Image extension not valid!");return t[0]}getImageDimensions(e){return new Promise((function(t,r){const o=new Image,a=new Ca;o.onload=function(){a.width=o.width,a.height=o.height,t(a)},o.onerror=function(){r(new O(y.UnknownPasteError,"failed to load the base64 image!"))},o.src=e}))}isSupportedExtension(e){return ma.indexOf(e)>=0}getRegExStringValue(e,t){const r=new RegExp(t,"g").exec(e);return r&&r.length&&r.length>1?r[1]:""}constructor(e){this._visioController=e}}function wa(e){return""===e}function _a(e){return null==e}class va{beforePaste(e){}deserialize(e){try{const t=e.clipboardItems,r=new ya;if(e.isClipboardInaccessible)throw new O(y.ClipboardIsInaccessible,"clipboard is not accessible");if(!t)throw new O(y.ReadFromClipboardReturnNullOrUndefined,"clipboardItems is null!");const o=t.getItem(sa.TextHtml),a=t.getItem(sa.TextPlain);if(!o&&!a)throw new O(y.ClipboardIsEmpty,"Html/Text Data is not present in clipboard!");return r.HtmlData=_a(o)||wa(o)?void 0:o,r.PlainText=_a(a)||wa(a)?void 0:a,this._visioController.setClipboardData(r),Promise.resolve()}catch(e){return Promise.reject(e)}}shouldWaitForCopyToComplete(e){return!1}onDeferredPasteStarted(e){}onDeferredPasteCompleted(e){}constructor(e){this._visioController=e}}class Pa{getCopyFlowHandler(e){return new ga(this._visioController)}getPasteFlowHandler(e){return function(e,t){let r=a("VisioWebEditTextContextMenuEnabled","false");return r=r.toLowerCase(),"true"===r}()&&this._visioController.getSupportedPasteFlow()===pa.TextPasteFlow?new va(this._visioController):new Ea(this._visioController)}initializePasteContext(e){}getSessionId(){return this._visioController.getUserSessionID()}constructor(e){this._visioController=e}}class Ta{isChangeGateEnabled(e){return!0}getCopyToClipboardLatencyMessage(){return this._copyToClipboardLatencyMessage}setClipboardData(e){if(this._clipboardData)throw new R(h.SetClipboardItems,"setClipboardData() called before last operation was complete!");this._clipboardData=e}setSupportedPasteFlow(e){this._supportedPasteFlow=e}getClipboardData(){if(!this._clipboardData)throw new R(h.GetClipboardItems,"GetClipboardData() called with null value of visioController.clipboardData!");const e=this._clipboardData;return this.clearClipboardData(),e}getUserSessionID(){return this._userSessionID}getWACDatacenter(){return this._wacDataCenter}getCCPLogger(){return this._ccpLogger}clearClipboardData(){this._clipboardData=void 0}isSafariBrowser(){return this._isSafari}getSupportedPasteFlow(){return this._supportedPasteFlow}constructor(e,t,r,o){this._copyToClipboardLatencyMessage=t,this._userSessionID=e,this._ccpLogger=r,this._wacDataCenter=o,this._isSafari=function(){if(window&&window.navigator){const e=window.navigator.userAgent.toLowerCase();return e.indexOf("safari")>=0&&e.indexOf("chrome")<0&&e.indexOf("edge")<0}return!1}(),this._supportedPasteFlow=pa.DefaultPasteFlow}}class Ia{getCopyPasteFlowManager(){return this._copyPasteFlowManager?Promise.resolve(this._copyPasteFlowManager):this.initCCPEnvironment()}getMetadataManager(){return this._metadataManager}getApplicationHost(){return this._applicationHost}internalCopy(e){return e.id=fa.A.generate(),this.getCopyPasteFlowManager().then((t=>t.onCopy(e)),(e=>Promise.reject(e)))}internalPaste(e){return e.id=fa.A.generate(),this.getCopyPasteFlowManager().then((t=>t.onPaste(e)),(e=>Promise.reject(e)))}async initCCPEnvironment(){return this.configureClipBoardEnvironment().then((e=>(this._metadataManager=e.getMetadataManager(),this._metadataManager.addMetadataChangeListener(this._metadataChangeListenerId,this.onMetadataChanged),this._copyPasteFlowManager=function(e,t,r){return new tr(e,t,r)}(e,this._applicationHost,this._ccpLogger),this._ccpLogger.traceTag(555872907,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"initCCPEnvironment() completed successfully"),Promise.resolve(this._copyPasteFlowManager))),(e=>Promise.reject(e)))}configureClipBoardEnvironment(){this._clipboardPlatformEnvironment=ta();const e=new ha,t={clipboardStrategyType:m.LocalStorage,useSharedClipboardIframe:!1,sharedClipboardSchemaVersion:1.1},r={clipboardStrategyType:m.SystemClipboard,skipFilesIfPlainTextExists:!1},o=[{clipboardStrategyType:m.SystemClipboardAndLocalStorage,localStorageStrategyParameters:t,systemClipboardStrategyParameters:r},{clipboardStrategyType:m.SystemClipboardAndInMemory}];return this._clipboardPlatformEnvironment.init(this._ccpLogger,ua,"","","",!1,1,3600,2,this._visioController.getCopyToClipboardLatencyMessage(),"DC2",e,o,void 0,void 0,void 0,void 0,this._bulsEndpointUrl).then((()=>this._clipboardPlatformEnvironment),(e=>{throw new R(h.UnsupportedOperationCode,`Clipboard Init failed! with error:'${e.name}' message: '${e.message}'`)}))}copy(e,t,r,o,a){const i={id:this._visioController.getUserSessionID(),pKey:"",clipServiceDataType:"Unknown",objectCount:-1,clipServiceDataCenter:"Unknown",uploadToClipService:!1,userHash:this._userHash,commandType:t?we.Cut:we.Copy,isKeyboardEvent:e,silentClipboardAccessFailures:!1,ribbonCommandInfo:null,stopwatch:null};try{this._visioController.setClipboardData(r)}catch(e){return void a(la.UnknownError)}this.internalCopy(i).then((e=>{e instanceof At&&!0===e.succeededPopulatingSystemClipboardSync?(this._ccpLogger.traceTag(555872908,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"Internal copy was successful , ready to call copySuccessCallback "),o()):(this._ccpLogger.traceTag(555872909,n.nh.msoulscat_ES_EWAJS,n.kp.Warning,"failed to populate System Clipboard in Sync manner"),a(la.UnknownError))}),(e=>{a(this.getPackageCopyError(e))}))}paste(e,t,r){const o={id:this._visioController.getUserSessionID(),userHash:this._userHash,isKeyboardEvent:e,commandType:we.Paste,silentClipboardAccessFailures:!1,ribbonCommandInfo:null,stopwatch:null,skipClipboardAccess:!1,clearStateOnFinish:!1,clearSystemClipboard:!1,originalDestination:null,expandDestination:null};this.internalPaste(o).then((e=>{this._ccpLogger.traceTag(555872910,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"InnerPaste() completed successfully");const r=this._visioController.getClipboardData();t(r)}),(e=>{throw e})).catch((e=>{r(this.getPackagePasteError(e))}))}pasteWithSpecificHandler(e,t,r,o){const a={id:this._visioController.getUserSessionID(),userHash:this._userHash,isKeyboardEvent:t,commandType:we.Paste,silentClipboardAccessFailures:!1,ribbonCommandInfo:null,stopwatch:null,skipClipboardAccess:!1,clearStateOnFinish:!1,clearSystemClipboard:!1,originalDestination:null,expandDestination:null};this._visioController.setSupportedPasteFlow(e),this.internalPaste(a).then((e=>{this._ccpLogger.traceTag(512349838,n.nh.msoulscat_ES_EWAJS,n.kp.Info,"InnerPaste() completed successfully in pasteWithSpecificHandler");const t=this._visioController.getClipboardData();r(t)}),(e=>{throw e})).catch((e=>{o(this.getPackagePasteError(e))}))}initializeAppSettings(r){!function(r){e=r;try{t=JSON.parse(a("DisabledChangeGates","{}"))}catch{t={}}}(r)}getPackagePasteError(e){let t=ca.UnknownError;switch(e.reason){case y.MissingArgumentError:case y.PasteFlowHandlerNotFound:case y.FetchPasteFlowHandlerFailed:case y.UnknownPasteError:t=ca.UnknownError;break;case y.FailedToReadFromClipboard:case y.InspectClipboardFailed:case y.SuccessivePasteOverridingPendingPaste:case y.FileReaderResultIsEmpty:case y.FileReaderFailed:case y.DeferredPasteRejectedBecauseOtherCopyCompleted:case y.DeferredPasteRejectedBecauseOtherCopyStarted:case y.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext:t=ca.ExpectedError;break;case y.DeserializeOperationFailed:e.innerError.reason===y.ClipboardIsInaccessible?t=ca.ClipboardIsInaccessible:e.innerError.reason===y.ClipboardIsEmpty?t=ca.UnsupportedClipboardFormat:e.innerError.reason===y.ReadFromClipboardReturnNullOrUndefined?t=ca.ClipboardIsEmpty:(e.innerError.reason===y.UnknownPasteError||e.innerError.reason===h.SetClipboardItems)&&(t=ca.UnknownError);break;case y.ClipboardIsEmpty:case y.ReadFromClipboardReturnNullOrUndefined:t=ca.ClipboardIsEmpty;break;case y.ClipboardIsInaccessible:t=ca.ClipboardIsInaccessible;break;case h.GetClipboardItems:case h.UnsupportedOperationCode:t=ca.UnknownError}return t}getPackageCopyError(e){let t=la.UnknownError;switch(e.reason){case g.MissingArgumentError:case g.CopyFlowHandlerNotFound:case g.FetchCopyFlowHandlerFailed:case g.FetchSourceItemFailed:case g.BeforeSerializeFailed:case g.SerializeFailed:case g.SerializeResultNotValid:case g.UnknownCopyErrorType:t=la.UnknownError;break;case g.AsyncSerializeFailed:case g.InspectClipboardFailed:case g.SaveToTheClipboardFailed:case g.SuccessiveCutCopyOverridingPendingCutCopy:case g.BlockedSynchronousCutCopy:case g.CopyOperationCancelled:t=la.ExpectedError;break;case g.ClipboardIsInaccessible:t=la.ClipboardIsInaccessible;break;case h.UnsupportedOperationCode:t=la.UnknownError}return t}constructor(e,t,r,o,a,i="",n=""){this._metadataChangeListenerId="VisioMetadataChangeListenerId",this.onMetadataChanged=e=>{this._metadataChangeListener&&this._metadataChangeListener(e)},this._ccpLogger=t,this._visioController=new Ta(e,r,t,i),this._applicationHost=new Pa(this._visioController),this._metadataChangeListener=a,this._userHash=o,this._bulsEndpointUrl=n,this.initCCPEnvironment()}}function Aa(){console.log("on copy Success!")}function Ma(e){console.log(e),alert("copy failed!!")}function xa(e){console.log(e.base64Image)}function ka(e){console.log(e),alert("Paste Failed!")}const La=new class{shipAssertTag(e,t,r,o){}assertTag(e,t,r,o){}traceTag(e,t,r,o){}dnmTraceTag(e,t,r,o){}debugTraceTag(e,t,r,o){}},Da=new Ia("123456",La,"Wait copy is in Progress!!",123456,(function(e){console.log(e)}));function Wa(){const e=new ya;Da.copy(!1,!1,e,Aa,Ma)}function Oa(){Da.paste(!1,xa,ka)}}(),visioClipboard=o}();
//# sourceMappingURL=visioClipboard.min.js.map